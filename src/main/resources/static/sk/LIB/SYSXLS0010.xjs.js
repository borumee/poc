(function(){return function(_a){var _b;this.addIncludeScript(_a,"LIB::SYSUTL0010.xjs");this.registerScript(_a,function(){this.executeIncludeScript("LIB::SYSUTL0010.xjs");this.sysv_escCnt=0;this.sysv_addHead=false;this.sysv_headRow="";this.sysf_PopupExcelExport=function(_c,_d){if(this.m2n_isNull(_c)==true||this.m2n_isValidObject(this.m2n_getObject(_c))!=1){this.sysf_alert("XSYSW0102");return;}var _e=this.m2n_getBindDataset(this.m2n_getObject(_c));if(this.m2n_isNull(_d)!=true||this.m2n_length(this.m2n_trim(_d))>2){var _f=this._sysf_HiddenValCheck(_d);if(!_f){this.sysf_alert("XSYSW0104");return;}}var _g="CM_MAN";var _h="MAN70U0200";var _i=this;var _j;if(this.id=="dvBody"){_i=this.m2n_getObject(this.parent.id);var _k=parseInt(_i.getOffsetHeight()/2-60);var _l=parseInt(_i.getOffsetWidth()/2-220);if(_k<0){_k=0;}if(_l<0){_l=0;}_j=_i.titletext;_i=_i.dvBody;}else{_j=_i.titletext;}this.m2n_lookupPath("Arg")="";this.m2n_lookupPath("Arg")+="pv_GridName="+nexacro.wrapQuote(_c);this.m2n_lookupPath("Arg")+=" pv_DataSet="+nexacro.wrapQuote(_e);this.m2n_lookupPath("Arg")+=" pv_strHidden="+nexacro.wrapQuote(_d);this.m2n_lookupPath("Arg")+=" defaultFileName="+nexacro.wrapQuote(_j);var _m=this.sysf_openDialog(_g,_h,this.m2n_lookupPath("Arg"),410,164,true,-1,-1);return _m;};this._sysf_HiddenValCheck=function(_c){var _d=true;var _e=this.m2n_split(_c,"|");var _f=this.m2n_length(_e);for(i=0;i<nexacro.toNumber(_f);i++ ){if(this.m2n_length(this.m2n_split(_e[i],","))!=3){_d=false;break;}}return _d;};this.sysf_PopupExcelImport=function(_c,_d,_e){var _f="CM_MAN";var _g="MAN70U0100";var _h;if(this.m2n_isNull(_c)==true||this.m2n_isValidObject(this.m2n_getObject(_c))!=1){this.sysf_alert("XSYSW0102");return;}if(this.m2n_isNull(_e)!=true||this.m2n_length(this.m2n_trim(_e))>2){var _i=this._sysf_HiddenValCheck(_e);if(!_i){this.sysf_alert("XSYSW0104");return;}}this.m2n_getObject(_c).hscrollbar.pos=0;_h="";_h+="pv_objID="+nexacro.wrapQuote(_c);_h+=" pv_chkCol="+nexacro.wrapQuote(_d);_h+=" pv_strHidden="+nexacro.wrapQuote(_e);var _j=this.sysf_openDialog(_f,_g,_h,680,495,true,-1,-1);if(_j=="Cancel"){this.m2n_lookupPath("strRtn")=null;}else{this.m2n_lookupPath("strRtn")=_j;}};this.sysf_setGridContents=function(_c,_d,_e,_f,_g){var _h='<contents>\n<columns>\n';var _i='</columns>\n<head>\n';var _j='</head>\n<body>\n';var _k='';var _l='';var _m=this.m2n_getObject(_c).getColCount();var _n=this.m2n_getObject(_c).getCellCount("head");var _o=this.m2n_getObject(_c).getCellCount("body");var _p=this.m2n_getObject(_c).getCellCount("summ");var _q;var _r=this.m2n_getObject(_c).getCellProperty("head",0,"colspan");var _s=this.m2n_getObject(_c).getCellProperty("head",0,"rowspan");var _t=1;var _u=0;var _v=0;var _w=0;var _x;var _y=false;if(this.m2n_getObject(_c).getCellProperty("body",0,"celltype")!="head"){_y=true;}for(i=0;i<_r;i++ ){if(this.m2n_getObject(_c).getCellProperty("body",i,"celltype")=="head"){this.sysv_escCnt++ ;}if(this.m2n_getObject(_c).getCellProperty("body",i,"displaytype")=="checkbox"){this.sysv_escCnt++ ;}if(i!=nexacro.toNumber(_r)-1){if((this.m2n_getObject(_c).getCellProperty("body",i,"celltype")!="head")&&(this.m2n_getObject(_c).getCellProperty("body",i,"displaytype")!="checkbox")){_w=1;}}}this.sysv_addHead=false;if(_r>1){this.sysv_addHead=this._sysf_addHeadItem(_c,_r);}if((_r<3)||(_w>0)){_u=this.sysv_escCnt;}else{_u=_r;}_q=nexacro.toNumber(_o)-nexacro.toNumber(this.sysv_escCnt);if((this.sysv_escCnt>1)&&(nexacro.toNumber(_q)>=nexacro.toNumber(_n))){_v=1;}for(i=0;i<_m;i++ ){if(i>=nexacro.toNumber(_u)){_h+='<col width="'+this.m2n_getObject(_c).getFormatColProperty(i,"size")+'"/>\n';}}var _z=0;var _aa;if(this.sysv_addHead){_r-- ;}this.m2n_getObject(_f).deleteAll();for(i=_v;i<_n;i++ ){_k='';_x=this.m2n_getObject(_f).addRow();this.m2n_getObject(_f).setColumn(_x,"col",this.m2n_getObject(_c).getCellProperty("head",i,"col"));this.m2n_getObject(_f).setColumn(_x,"row",this.m2n_getObject(_c).getCellProperty("head",i,"row"));if(nexacro.toNumber(_n)<=nexacro.toNumber(_q)){if(i==_v){if(this.sysv_addHead>0){_k+='<cell col="'+nexacro.toNumber(this.m2n_getObject(_c).getCellProperty("head",i,"col"))+'" ';}else if(this.sysv_escCnt>1){_k+='<cell col="'+(nexacro.toNumber(this.m2n_getObject(_c).getCellProperty("head",i,"col"))-_r)+'" ';}else if((this.sysv_escCnt<1)||(_y==true)){_k+='<cell col="'+this.m2n_getObject(_c).getCellProperty("head",i,"col")+'" ';}else{_k+='<cell col="'+(nexacro.toNumber(this.m2n_getObject(_c).getCellProperty("head",i,"col"))-_r+this.sysv_escCnt)+'" ';}if(((this.m2n_getObject(_c).getCellProperty("head",i,"colspan")>1)&&(this.sysv_escCnt>1))||(_w>0)){_k+='colspan="'+(this.m2n_getObject(_c).getCellProperty("head",i,"colspan")-_w)+'" ';}_k+='display="text" rowspan="'+this.m2n_getObject(_c).getCellProperty("head",i,"rowspan")+'" ';_k+='row="'+this.m2n_getObject(_c).getCellProperty("head",i,"row")+'" ';_k+='text="'+this.m2n_getObject(_c).getCellProperty("head",i,"text")+'"/>\n';}else{if(this.sysv_escCnt>1){_k+='<cell col="'+(nexacro.toNumber(this.m2n_getObject(_c).getCellProperty("head",i,"col"))-_r)+'" ';}else{_k+='<cell col="'+(nexacro.toNumber(this.m2n_getObject(_c).getCellProperty("head",i,"col"))-this.sysv_escCnt)+'" ';}_k+='colspan="'+this.m2n_getObject(_c).getCellProperty("head",i,"colspan")+'" ';_k+='display="text" rowspan="'+this.m2n_getObject(_c).getCellProperty("head",i,"rowspan")+'" ';_k+='row="'+this.m2n_getObject(_c).getCellProperty("head",i,"row")+'" ';_k+='text="'+this.m2n_getObject(_c).getCellProperty("head",i,"text")+'"/>\n';}}else{if(this.m2n_getObject(_c).getCellProperty("head",i,"col")==0){if(this.sysv_addHead){_k+='<cell col="'+nexacro.toNumber(this.m2n_getObject(_c).getCellProperty("head",i,"col"))+'" ';_k+='display="text" rowspan="'+this.m2n_getObject(_c).getCellProperty("head",i,"rowspan")+'" ';_k+='row="'+this.m2n_getObject(_c).getCellProperty("head",i,"row")+'" ';if(((this.m2n_getObject(_c).getCellProperty("head",i,"colspan")>1)&&(this.sysv_escCnt>1))||(_w>0)){_k+='colspan="'+(this.m2n_getObject(_c).getCellProperty("head",i,"colspan")-_w)+'" ';}_k+='text="'+this.m2n_getObject(_c).getCellProperty("head",i,"text")+'"/>\n';}}if(this.m2n_getObject(_c).getCellProperty("head",i,"col")!=0){if(_w>0){_k+='<cell col="'+(nexacro.toNumber(this.m2n_getObject(_c).getCellProperty("head",i,"col"))-nexacro.toNumber(_w))+'" ';_k+='colspan="'+this.m2n_getObject(_c).getCellProperty("head",i,"colspan")+'" ';}else{_k+='<cell col="'+(nexacro.toNumber(this.m2n_getObject(_c).getCellProperty("head",i,"col"))-nexacro.toNumber(_r))+'" ';_k+='colspan="'+this.m2n_getObject(_c).getCellProperty("head",i,"colspan")+'" ';}_k+='display="text" rowspan="'+this.m2n_getObject(_c).getCellProperty("head",i,"rowspan")+'" ';_k+='row="'+this.m2n_getObject(_c).getCellProperty("head",i,"row")+'" ';_k+='text="'+this.m2n_getObject(_c).getCellProperty("head",i,"text")+'"/>\n';}}this.m2n_getObject(_f).setColumn(_x,"contents",_k);}this.m2n_sort(this.m2n_getObject(_f),"row:A,col:A");for(i=0;i<this.m2n_getObject(_f).getRowCount();i++ ){_i+=this.m2n_getObject(_f).getColumn(i,"contents");}var _ab="";var _ac=0;this.m2n_getObject(_g).deleteAll();for(i=0;i<_o;i++ ){if(i>=this.sysv_escCnt){_k='';_ac=this.m2n_getObject(_c).getCellProperty("body",i,"col");_x=this.m2n_getObject(_g).addRow();_k+='<cell col="'+(_ac-_u)+'" ';this.m2n_getObject(_g).setColumn(_x,"col",_ac-_u);this.m2n_getObject(_g).setColumn(_x,"row",this.m2n_getObject(_c).getCellProperty("body",i,"row"));_k+='colid="'+this.m2n_getColidProperty(this.m2n_getObject(_c).getCellProperty("body",i,"text"))+'" ';_k+='rowspan="'+this.m2n_getObject(_c).getCellProperty("body",i,"rowspan")+'" ';_k+='wordwrap="'+this.m2n_getObject(_c).getCellProperty("body",i,"wordwrap")+'" ';_k+='row="'+this.m2n_getObject(_c).getCellProperty("body",i,"row")+'" ';_k+='suppress="'+this.m2n_getObject(_c).getCellProperty("body",i,"suppress")+'" ';_k+='align="'+this._sysf_getChrReplace(this.m2n_getObject(_c).getCellProperty("body",i,"textAlign"))+'" ';if(this.m2n_getObject(_c).getCellProperty("body",i,"displaytype")=="checkbox"){_k+='display="text" ';}else{_k+='display="'+this._sysf_getChrReplace(this.m2n_getObject(_c).getCellProperty("body",i,"displaytype"))+'" ';}if(this.m2n_length(this.m2n_getObject(_c).getCellProperty("body",i,"expr"))>0){_ab=this._sysf_getChrReplace(this.m2n_getObject(_c).getCellProperty("body",i,"expr"));_k+=' expr="'+_ab+'" ';}if(this.m2n_length(this.m2n_getObject(_c).getCellProperty("body",i,"maskeditformat"))>0){_k+=' mask="'+this._sysf_getChrReplace(this.m2n_getObject(_c).getCellProperty("body",i,"maskeditformat"))+'" ';}if(this.m2n_getObject(_c).getCellProperty("body",i,"displaytype")=="combo"){_k+=' comboDataset="'+this.m2n_getObject(_c).getCellProperty("body",i,"combodataset")+'" ';_k+=' combocol="'+this.m2n_getObject(_c).getCellProperty("body",i,"combocodecol")+'" ';_k+=' combotext="'+this.m2n_getObject(_c).getCellProperty("body",i,"combodatacol")+'" ';}_k+=' />\n';this.m2n_getObject(_g).setColumn(_x,"contents",_k);_z++ ;}}this.m2n_sort(this.m2n_getObject(_g),"row:A,col:A");for(i=0;i<this.m2n_getObject(_g).getRowCount();i++ ){_j+=this.m2n_getObject(_g).getColumn(i,"contents");}this.sysf_getHeadRowCount(_c);if(this.m2n_getObject(_d).getRowCount()>0){for(i=0;i<this.m2n_getObject(_d).getRowCount();i++ ){_h+='<col width="'+this.m2n_getObject(_d).getColumn(i,"width")+'"/>\n';_i+='<cell col="'+nexacro.toNumber(_z)+'" display="text" rowspan="'+(nexacro.toNumber(this.sysv_headRow)+1)+'" ';_i+='text="'+this.m2n_getObject(_d).getColumn(i,"text")+'" BKColor="silver" />\n';_j+='<cell col="'+nexacro.toNumber(_z)+'" BKColor="silver" ';_j+='colid="'+this.m2n_getObject(_d).getColumn(i,"col")+'" display="text"/>\n';_z++ ;}}var _ad=this._sysf_getSummRowCount(_c);var _ae;if(_p>0){_l+='\n<summary>\n';var _af;for(i=0;i<_p;i++ ){_ae=this.m2n_getObject(_c).getCellProperty("summary",i,"col");_r=this.m2n_getObject(_c).getCellProperty("summary",i,"colspan");_af=this.m2n_getObject(_c).getCellProperty("summary",i,"expr");_af=this._sysf_getChrReplace(_af);if(_ae==0){_l+='<cell col="0" ';_l+='colspan="'+(_r-nexacro.toNumber(_u))+'" ';}else{_l+='<cell col="'+(nexacro.toNumber(this.m2n_getObject(_c).getCellProperty("summary",i,"col"))-nexacro.toNumber(_u))+'" ';_l+='colspan="'+_r+'" ';}_l+='rowspan="'+this.m2n_getObject(_c).getCellProperty("summary",i,"rowspan")+'" ';_l+='align="'+this._sysf_getChrReplace(this.m2n_getObject(_c).getCellProperty("summary",i,"textAlign"))+'" ';_l+='display="'+this._sysf_getChrReplace(this.m2n_getObject(_c).getCellProperty("summary",i,"displaytype"))+'" ';_l+='font="'+this._sysf_getChrReplace(this.m2n_getObject(_c).getCellProperty("summary",i,"font"))+'" ';_l+='color="'+this._sysf_getChrReplace(this.m2n_getObject(_c).getCellProperty("summary",i,"color"))+'" ';_l+='bkcolor="'+this._sysf_getChrReplace(this.m2n_getObject(_c).getCellProperty("summary",i,"background"))+'" ';_l+='row="'+this.m2n_getObject(_c).getCellProperty("summary",i,"row")+'" ';if(this.m2n_length(_af)>0){_l+='expr="'+_af+'" ';}_l+='text="'+this.m2n_getObject(_c).getCellProperty("summary",i,"text")+'"/>\n';}_l+='</summary>\n';}this.m2n_setBindDataset(this.m2n_getObject(_e),this.m2n_getObject(this.m2n_lookupPath("pv_DataSet")).id);this.m2n_setContents(this.m2n_getObject(_e),_h+_i+_j+'</body>'+_l+'</contents>');};this._sysf_getChrReplace=function(_c){var _d=_c;_d=this.m2n_replace(_d,"&","&amp;");_d=this.m2n_replace(_d,"<","&lt;");_d=this.m2n_replace(_d,">","&gt;");_d=this.m2n_replace(_d,"\"","&quot;");_d=this.m2n_replace(_d,"'","&apos;");return _d;};this.sysf_getHeadRowCount=function(_c){var _d=this.m2n_getObject(_c).getCellCount("head");this.sysv_headRow=0;for(i=0;i<_d;i++ ){if(this.m2n_getObject(_c).getCellProperty("head",i,"row")>this.sysv_headRow){this.sysv_headRow=this.m2n_getObject(_c).getCellProperty("head",i,"row");}}};this._sysf_getSummRowCount=function(_c){var _d=this.m2n_getObject(_c).getCellCount("summ");this.m2n_lookupPath("rtnCnt")=0;for(i=0;i<_d;i++ ){if(this.m2n_getObject(_c).getCellProperty("summ",i,"row")>this.m2n_lookupPath("rtnCnt")){this.m2n_lookupPath("rtnCnt")=this.m2n_getObject(_c).getCellProperty("summ",i,"row");}}return this.m2n_lookupPath("rtnCnt");};this._sysf_addHeadItem=function(_c,_d){var _e=false;var _f=this.m2n_getObject(_c).getCellCount("body");for(i=0;i<_f;i++ ){if(this.m2n_length(this.m2n_getColidProperty(this.m2n_getObject(_c).getCellProperty("body",i,"text")))>0&&this.m2n_getObject(_c).getCellProperty("body",i,"displaytype")!="checkbox"&&this.m2n_getObject(_c).getCellProperty("body",i,"col")<nexacro.toNumber(_d)){_e=true;break;}}return _e;};this.sysf_Dataset_SaveCsv=function(_c,_d,_e,_f,_g){var _h=",";var _i=this.m2n_chr(10);return this._sysf_Dataset_SaveWithDelimeter(_c,_h,_i,_d,_e,_f,_g);};this._sysf_Dataset_SaveWithDelimeter=function(_c,_d,_e,_f,_g,_h,_i){var _j,_k,_l;var _m=this.m2n_getObject(_f).getCellCount("head");var _n=this.m2n_getObject(_f).getCellCount("body");var _o=this.m2n_getObject(_f).getCellCount("summ");var _p;var _q="";var _r="";var _s="";var _t;var _u;var _v;var _w;var _x;var _y;this.m2n_getObject(_g).deleteAll();for(_j=0;_j<=this.sysv_headRow;_j++ ){for(_k=0;_k<_m;_k++ ){if(this.m2n_getObject(_f).getCellProperty("head",_k,"row")==_j){_u=this.m2n_getObject(_f).getCellProperty("head",_k,"colspan");_v=this.m2n_getObject(_f).getCellProperty("head",_k,"rowspan");_w=this.m2n_getObject(_f).getCellProperty("head",_k,"col");_x=this.m2n_getObject(_g).addRow();this.m2n_getObject(_g).setColumn(_x,"row",_j);this.m2n_getObject(_g).setColumn(_x,"col",_w);this.m2n_getObject(_g).setColumn(_x,"text",this.m2n_getObject(_f).getCellProperty("head",_k,"text"));if(nexacro.toNumber(_u)>1){for(_l=1;_l<_u;_l++ ){_x=this.m2n_getObject(_g).addRow();this.m2n_getObject(_g).setColumn(_x,"row",_j);this.m2n_getObject(_g).setColumn(_x,"col",_w+_l);this.m2n_getObject(_g).setColumn(_x,"text","");}}if(nexacro.toNumber(_v)>1){for(_l=1;_l<_v;_l++ ){_x=this.m2n_getObject(_g).addRow();this.m2n_getObject(_g).setColumn(_x,"row",_j+_l);this.m2n_getObject(_g).setColumn(_x,"col",_w);this.m2n_getObject(_g).setColumn(_x,"text",this.m2n_getObject(_f).getCellProperty("head",_k,"text"));}}}}}this.m2n_sort(this.m2n_getObject(_g),"row:A,col:A");var _z;for(_j=0;_j<=this.m2n_getObject(_g).getRowCount();_j++ ){_q=this.m2n_getObject(_g).getColumn(_j,"text");if(_j==0){_s='"'+_q+'"';_z=this.m2n_getObject(_g).getColumn(_j,"row");}else{if(_z==this.m2n_getObject(_g).getColumn(_j,"row")){if(_j==(nexacro.toNumber(this.m2n_getObject(_g).getRowCount())-1)){_s=_s+_d+'"'+_q+'"'+_e;}else{if(_z!=this.m2n_getObject(_g).getColumn((_j+1),"row")){_s=_s+_d+'"'+_q+'"'+_e;}else{_s=_s+_d+'"'+_q+'"';}}}else{if(this.m2n_isNull(_q)!=true){_z=this.m2n_getObject(_g).getColumn(_j,"row");_s=_s+'"'+_q+'"';}}}}for(_j=0;_j<_c.getRowCount();_j++ ){for(_k=0;_k<_n;_k++ ){_t=this.m2n_getObject(_f).getCellText(_j,_k);_t=this.m2n_replace(_t,"\"","\"\"");if(_k==0){_s=_s+'"'+_t+'"';}else{_s=_s+_d+'"'+_t+'"';}}_s=_s+_e;}this.m2n_getObject(_i).deleteAll();_y=1;for(_j=0;_j<_o;_j++ ){_u=this.m2n_getObject(_f).getCellProperty("summ",_j,"colspan");_v=this.m2n_getObject(_f).getCellProperty("summ",_j,"rowspan");_w=this.m2n_getObject(_f).getCellProperty("summ",_j,"col");if(_y!=this.m2n_getObject(_f).getCellProperty("summ",_j,"row")){_y=this.m2n_getObject(_f).getCellProperty("summ",_j,"row");}_x=this.m2n_getObject(_i).addRow();this.m2n_getObject(_i).setColumn(_x,"row",_y);this.m2n_getObject(_i).setColumn(_x,"col",_w);this.m2n_getObject(_i).setColumn(_x,"text",this.m2n_getObject(_f).getCellText(0,_j));if(nexacro.toNumber(_u)>1&&nexacro.toNumber(_v)>1){for(_l=0;_l<_v;_l++ ){for(_k=0;_k<_u;_k++ ){if(_l==0&&_k==0){continue;}_x=this.m2n_getObject(_i).addRow();this.m2n_getObject(_i).setColumn(_x,"row",_y+_l);this.m2n_getObject(_i).setColumn(_x,"col",_w+_k);this.m2n_getObject(_i).setColumn(_x,"text","");}}}else{if(nexacro.toNumber(_u)>1){for(_l=1;_l<_u;_l++ ){_x=this.m2n_getObject(_i).addRow();this.m2n_getObject(_i).setColumn(_x,"row",_y);this.m2n_getObject(_i).setColumn(_x,"col",_w+_l);this.m2n_getObject(_i).setColumn(_x,"text","");}}if(nexacro.toNumber(_v)>1){for(_l=1;_l<_v;_l++ ){_x=this.m2n_getObject(_i).addRow();this.m2n_getObject(_i).setColumn(_x,"row",_y+_l);this.m2n_getObject(_i).setColumn(_x,"col",_w);this.m2n_getObject(_i).setColumn(_x,"text","");}}}}this.m2n_sort(this.m2n_getObject(_i),"row:A,col:A");_y="";for(_j=0;_j<this.m2n_getObject(_i).getRowCount();_j++ ){_t=this.m2n_getObject(_i).getColumn(_j,"text");_t=this.m2n_replace(_t,"\"","\"\"");if(this.m2n_getObject(_i).getColumn(_j,"row")!=_y){if(_j!=0){_s=_s+_e;}_s=_s+'"'+_t+'"';_y=this.m2n_getObject(_i).getColumn(_j,"row");}else{_s=_s+_d+'"'+_t+'"';}}return _s;};});this.loadIncludeScript(_a);_b=null;};})();
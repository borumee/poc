(function(){return function(_a){var _b;this.registerScript(_a,function(){this.CONST_ASC_MARK="▲";this.CONST_DESC_MARK="▼";this.sys_grid_ObjGrid="";this.sysv_RtnDFlag="";this.sysv_ObjBindDs="";this.sysv_GrdRow="";this.sysv_GrdColId="";this.sysv_OpenChkCal=false;this.sysv_RtnDate="";this.sysv_CreateChkDS=false;this.sysv_MCnt="";this.sysv_GCnt="";this.sysv_SortCol="";this.sysv_GridReFindProc=0;this.sysf_invokPDCalendar_Grid=function(_c,_d,_e,_f){var _g;_g=nexacro.getApplication().Language;this.m2n_lookupPath("sysv_ObjGrid")=_c;if(_f){this.sysv_RtnDFlag=true;}else{this.sysv_RtnDFlag=false;}var _h=this.m2n_getBindDataset(this.m2n_lookupPath("sysv_ObjGrid"));this.sysv_ObjBindDs=this.m2n_getObject(_h).id;this.sysv_GrdRow=_d;this.sysv_GrdColId=this.m2n_getColidProperty(this.m2n_lookupPath("sysv_ObjGrid").getCellProperty("Body",_e,"text"));var _i=this.m2n_getObject(this.sysv_ObjBindDs).getColumn(_d,this.sysv_GrdColId);var _j=this.m2n_getCellRect(this.m2n_lookupPath("sysv_ObjGrid"),_d,_e);var _k=system.clientToScreenX(_c,_j[0]);var _l=system.clientToScreenY(_c,_j[1]);var _m=_j[2]-_j[0];var _n=_j[3]-_j[1];if(this.sysv_OpenChkCal==false){_g=this.gf_GetGlobalValue("g_SysLang");if(_g=="ko"||_g=="1042"){this.m2n_create(this,"PopDiv","PopDiv_Calendar",'width="155" height="160"');}else if(_g=="en"||_g=="1033"){this.m2n_create(this,"PopDiv","PopDiv_Calendar",'width="231" height="160"');}else{this.m2n_create(this,"PopDiv","PopDiv_Calendar",'width="155" height="160"');}this.sysv_OpenChkCal=true;}this.m2n_setContents(this.m2n_lookupPath("PopDiv_Calendar"),this._sysf_makePDCalendar_Grid(_i));this.m2n_lookupPath("PopDiv_Calendar").trackPopup(_k,_l,_m,_n);return this.sysv_RtnDate;};this._sysf_makePDCalendar_Grid=function(_c){var _d;_d+='<Contents>'+this.m2n_chr(10);_d+='<Calendar BackColorColumn="holiday_bkcolor" DateColumn="holiday" DayFont="Default,-1" DayStyle="cal_Day" DrawWeekSeparator="FALSE" HeaderBorder="SUNKEN" '+this.m2n_chr(10);_d+='HeaderFont="Default,-1" HeadStyle="cal_Head" Height="159" Id="CAL_PopupDiv" Left="0" LeftMargin="2" MonthPopupBorder="RAISED" NullValue="&#32;" RightMargin="2" SaturdayTextColor="user13" '+this.m2n_chr(10);_d+='InnerDataset="GDS_HOLIDAY" TextColorColumn="holiday_color" SelDayStyle="cal_SelDay" SelectedDayFont="Default,-1" Style="cal_Mandatory" SundayTextColor="user14" MonthOnly="TRUE" '+this.m2n_chr(10);_d+='Value="'+_c+'" DaySpacingHeight="4" DaySpacingWidth="4" '+this.m2n_chr(10);_d+='OnDayClick="_syse_Calendar_OnDayClick_Grid" TabOrder="11" TodayColor="user15" Top="0" WeeksFont="Default,-1" WeekStyle="cal_Week" Width="231"></Calendar>'+this.m2n_chr(10);_d+='</Contents>';return _d;};this._syse_Calendar_OnDayClick_Grid=function(_b,_c){if(this.sysv_RtnDFlag){this.sysv_RtnDate=_c;}else{this.m2n_getObject(this.sysv_ObjBindDs).setColumn(this.sysv_GrdRow,this.sysv_GrdColId,_c);}this.m2n_lookupPath("PopDiv_Calendar").closePopup();};this.sysf_insertDSRow=function(_c,_d){if(_c.getRowCount()<1){_c.addRow();return 0;}var _e=0;var _f;for(var _g=0;_g<_c.getRowCount();_g++ ){if(_c.getColumn(_g,_d)==true){_e++ ;if(_e==1){_f=_g;}}}if(_e==1){_c.insertRow(_f+1);return _f+1;}else{_c.addRow();return _c.getRowCount()-1;}};this.sysf_deleteDSRow=function(_c,_d){if(_c.getRowCount()<1){this.sysf_alert("XSYSW0105");return;}for(var _e=_c.getRowCount()-1;_e>=0;_e-- ){if(_c.getColumn(_e,_d)==true&&this.m2n_getRowType(_c,_e)=="insert"){_c.deleteRow(_e);}}};this.sysf_copyDSRow=function(_c,_d){if(_c.getRowCount()<1){this.m2n_lookupPath("gf_alert")("XSYSW0105");return;}for(var _e=0;_e<_c.getRowCount();_e++ ){if(_c.getColumn(_e,_d)==true){_c.insertRow(_e+1);_c.copyRow(_e+1,_c,_e);_c.setColumn(_e+1,_d,"1");_e++ ;}}};this.sysf_makeGridSort=function(_c,_d,_e){var _f=this.m2n_getBindDataset(_c);this.sysv_MCnt=_c.getCellProperty("head",0,"colspan");this.sysv_GCnt=0;this.sysv_SortCol=_e;if(_c.getSubCellCount("head",0)>0){this.sysv_GCnt=_c.getSubCellCount("head",0)-1;}if(getKeyState("shift")){if(this.sysv_CreateChkDS==false){this.m2n_create(this,"Dataset","ds_grdsort","");this.m2n_lookupPath("ds_grdsort").addColumn("Col","String",255);this.m2n_lookupPath("ds_grdsort").addColumn("Sort","String",255);this.sysv_CreateChkDS=true;}if(this.m2n_lookupPath("ds_grdsort").getRowCount()<1){this.sysf_clearHeaderSortMarkAll(_c);}this._sysf_procGridMultiSort(_c,_f,_d);}else{if(this.sysv_CreateChkDS){this.m2n_lookupPath("ds_grdsort").deleteAll();}this._sysf_procGridSort(_c,_f,_d);}};this._sysf_procGridSort=function(_c,_d,_e){var _f,_g;var _h;var _i;var _j;var _k="";var _l;if(this.m2n_right(_c.getCellProperty("head",_e,"text"),1)==this.CONST_ASC_MARK){if(_c.getCellProperty("head",_e,"colspan")>1){_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_j=_c.getCellProperty("head",_e,"colspan");for(var _q=_i;_q<nexacro.toNumber(_i)+nexacro.toNumber(_j);_q++ ){if((this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text")))!=true)&&(this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text")))!=true)){_k+=this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text"))+",";}}}else{_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_k=this.m2n_getColidProperty(_c.getCellProperty("Body",_i,"text"))+",";}_f=_c.getCellProperty("head",_e,"text");_f=this.m2n_replace(_f,this.CONST_ASC_MARK,"");_f=_f+this.CONST_DESC_MARK;_l=this.sysf_getSortColumn(_c);_k=_k+_l;this.m2n_sort(this.m2n_getObject(_d),_k,false);}else if(this.m2n_right(_c.getCellProperty("head",_e,"text"),1)==this.CONST_DESC_MARK){var _m=_c.getCellCount("Body");var _n=0;if(this.m2n_length(this.sysv_SortCol)>2){_k+=this.m2n_lookupPath("sysf_defaultSortCols")();}else{for(var _q=0;_q<_m;_q++ ){if(this.m2n_length(this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text")))>1){if((this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text")))!=true)&&(this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text")))!=true)&&(_c.getCellProperty("body",_q,"displaytype")!="checkbox")){_k+=this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text"))+",";_n++ ;}}if(_n==5){break;}}}_f=_c.getCellProperty("head",_e,"text");_f=this.m2n_replace(_f,this.CONST_DESC_MARK,"");this.m2n_sort(this.m2n_getObject(_d),_k,true);}else{if(_e==0&&this.sysv_GCnt>0){return;}if(_c.getCellProperty("head",_e,"colspan")>1){_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_j=_c.getCellProperty("head",_e,"colspan");for(var _q=_i;_q<nexacro.toNumber(_i)+nexacro.toNumber(_j);_q++ ){if((this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text")))!=true)&&(this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text")))!=true)){_k+=this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text"))+",";}}}else{_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_k=this.m2n_getColidProperty(_c.getCellProperty("Body",_i,"text"))+",";}_f=_c.getCellProperty("head",_e,"text");_f=_f+this.CONST_ASC_MARK;_l=this.sysf_getSortColumn(_c);_k=_k+_l;this.m2n_sort(this.m2n_getObject(_d),_k,true);}_c.setCellProperty("head",_e,"text",_f);var _o=_c.getCellCount("head");var _p;for(_q=this.sysv_GCnt;_q<_o;_q++ ){if(_e!=_q){_p=this.m2n_replace(_c.getCellProperty("head",_q,"text"),this.CONST_ASC_MARK,"");_p=this.m2n_replace(_p,this.CONST_DESC_MARK,"");_c.setCellProperty("head",_q,"text",_p);}}};this.sysf_getSortColumn=function(_c){var _d=_c.getCellCount("body");var _e=0;var _f="";for(var _g=0;_g<_d;_g++ ){if((_c.getCellProperty("body",_g,"celltype")!="head")&&(_c.getCellProperty("body",_g,"displaytype")!="checkbox")&&(this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("body",_g,"text")))!=true)){if((_e<2)&&(_g!=(_d -1))){_f+=this.m2n_getColidProperty(_c.getCellProperty("body",_g,"text"))+":A,";_e++ ;}if(_e==2){break;}}}return _f;};this._sysf_procGridMultiSort=function(_c,_d,_e){var _f,_g;var _h;var _i;var _j;var _k="";var _l;var _m;if(this.m2n_right(_c.getCellProperty("head",_e,"text"),1)==this.CONST_ASC_MARK){if(_c.getCellProperty("head",_e,"colspan")>1){_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_j=_c.getCellProperty("head",_e,"colspan");_l=_c.getCellProperty("head",_e,"row");for(var _s=_i;_s<nexacro.toNumber(_i)+nexacro.toNumber(_j);_s++ ){_k+=this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text"))+",";}_m=nexacro.toNumber(_i)+nexacro.toNumber(_j);this.sysf_clearHeaderSortMark(_c,_i,_m,_l);}else{_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_k=this.m2n_getColidProperty(_c.getCellProperty("Body",_i,"text"));}_f=_c.getCellProperty("head",_e,"text");_f=this.m2n_replace(_f,this.CONST_ASC_MARK,"");_f=_f+this.CONST_DESC_MARK;_g=this.CONST_DESC_MARK;}else if(this.m2n_right(_c.getCellProperty("head",_e,"text"),1)==this.CONST_DESC_MARK){if(_c.getCellProperty("head",_e,"colspan")>1){_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_j=_c.getCellProperty("head",_e,"colspan");_l=_c.getCellProperty("head",_e,"row");for(var _s=_i;_s<nexacro.toNumber(_i)+nexacro.toNumber(_j);_s++ ){_k+=this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text"))+",";}_m=nexacro.toNumber(_i)+nexacro.toNumber(_j);this.sysf_clearHeaderSortMark(_c,_i,_m,_l);}else{_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_k=this.m2n_getColidProperty(_c.getCellProperty("Body",_i,"text"));}_f=_c.getCellProperty("head",_e,"text");_f=this.m2n_replace(_f,this.CONST_DESC_MARK,"");_g="";}else{if(_e==0&&this.sysv_GCnt>0){return;}if(_c.getCellProperty("head",_e,"colspan")>1){_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_j=_c.getCellProperty("head",_e,"colspan");_l=_c.getCellProperty("head",_e,"row");for(var _s=_i;_s<nexacro.toNumber(_i)+nexacro.toNumber(_j);_s++ ){_k+=this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text"))+",";}_m=nexacro.toNumber(_i)+nexacro.toNumber(_j);this.sysf_clearHeaderSortMark(_c,_i,_m,_l);}else{_i=_c.getCellProperty("head",_e,"col");_i-=this.sysv_GCnt;_k=this.m2n_getColidProperty(_c.getCellProperty("Body",_i,"text"));}_f=_c.getCellProperty("head",_e,"text");_f=_f+this.CONST_ASC_MARK;_g=this.CONST_ASC_MARK;}var _n=this.m2n_split(_k,",");for(var _s=0;_s<this.m2n_length(_n);_s++ ){var _o=this.m2n_lookupPath("ds_grdsort").findRow("Col",_n[_s]);if(_o<0){this.m2n_lookupPath("ds_grdsort").addRow();this.m2n_lookupPath("ds_grdsort").setColumn(this.m2n_lookupPath("ds_grdsort").rowposition,"Col",_n[_s]);this.m2n_lookupPath("ds_grdsort").setColumn(this.m2n_lookupPath("ds_grdsort").rowposition,"Sort","A");if(this.m2n_isNull(_g)==true){this.m2n_lookupPath("ds_grdsort").deleteRow(_o);}}else{this.m2n_lookupPath("ds_grdsort").deleteRow(_o);if(this.m2n_isNull(_g)!=true){this.m2n_lookupPath("ds_grdsort").addRow();this.m2n_lookupPath("ds_grdsort").setColumn(this.m2n_lookupPath("ds_grdsort").rowposition,"Col",_n[_s]);if(_g==this.CONST_DESC_MARK){this.m2n_lookupPath("ds_grdsort").setColumn(this.m2n_lookupPath("ds_grdsort").rowposition,"Sort","D");}else{this.m2n_lookupPath("ds_grdsort").setColumn(this.m2n_lookupPath("ds_grdsort").rowposition,"Sort","A");}}}}var _p="";for(var _s=0;_s<this.m2n_lookupPath("ds_grdsort").getRowCount();_s++ ){if(this.m2n_length(this.m2n_lookupPath("ds_grdsort").getColumn(_s,"Col"))<1){continue;}if(_s==nexacro.toNumber(this.m2n_lookupPath("ds_grdsort").getRowCount())-1){_p+=this.m2n_lookupPath("ds_grdsort").getColumn(_s,"Col")+":"+this.m2n_lookupPath("ds_grdsort").getColumn(_s,"Sort");}else{_p+=this.m2n_lookupPath("ds_grdsort").getColumn(_s,"Col")+":"+this.m2n_lookupPath("ds_grdsort").getColumn(_s,"Sort")+",";}}if(this.m2n_lookupPath("ds_grdsort").getRowCount()<1){var _q=_c.getCellCount("Body");var _r=0;if(this.m2n_length(this.sysv_SortCol)>2){_p+=this.m2n_lookupPath("sysf_defaultSortCols")();}else{for(var _s=0;_s<_q;_s++ ){if(this.m2n_length(this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text")))>1){if((this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text")))!=true)&&(this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text")))!=true)&&(_c.getCellProperty("body",_s,"displaytype")!="checkbox")){_p+=this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text"))+",";_r++ ;}}if(_r==5){break;}}}}this.m2n_sort(this.m2n_getObject(_d),_p,true);_c.setCellProperty("head",_e,"text",_f);};this.sysf_clearHeaderSortMarkAll=function(_b){var _c=_b.getCellCount("head");var _d;for(var _e=this.sysv_GCnt;_e<_c;_e++ ){_d=this.m2n_replace(_b.getCellProperty("head",_e,"text"),this.CONST_ASC_MARK,"");_b.setCellProperty("head",_e,"text",_d);_d=this.m2n_replace(_b.getCellProperty("head",_e,"text"),this.CONST_DESC_MARK,"");_b.setCellProperty("head",_e,"text",_d);}};this.sysf_clearHeaderSortMark=function(_b,_c,_d,_e){var _f=_b.getCellCount("head");var _g;var _h;var _i;if(this.sysv_GCnt>0){_c+=nexacro.toNumber(this.sysv_GCnt);_d+=nexacro.toNumber(this.sysv_GCnt);}for(var _j=this.sysv_GCnt;_j<_f;_j++ ){_h=_b.getCellProperty("head",_j,"row");_i=_b.getCellProperty("head",_j,"col");if(_i>=_c&&_i<_d){if(_e<_h){_g=this.m2n_replace(_b.getCellProperty("head",_j,"text"),this.CONST_ASC_MARK,"");_b.setCellProperty("head",_j,"text",_g);_g=this.m2n_replace(_b.getCellProperty("head",_j,"text"),this.CONST_DESC_MARK,"");_b.setCellProperty("head",_j,"text",_g);}}}};this.sysf_appendGrdColumn=function(_c,_d,_e,_f,_g,_h){var _i=_c.getColCount();var _j=_c.Contents;_j=this.m2n_replace(_j,'</columns>','<col width="'+_f+'"/></columns>');_j=this.m2n_replace(_j,'</head>','<cell col="'+_i+'" color="white" display="text" text="'+_d+'" color="white"/></head>');_j=this.m2n_replace(_j,'</body>','<cell col="'+_i+'" colid="'+_e+'" display="'+_g+'" align="'+_h+'" bkcolor="white" bkcolor2="#eceef1"/></body>');this.m2n_setContents(_c,_j);};this.sysf_insertGrdColumn=function(_c,_d,_e,_f,_g,_h,_i){if(!this._sysf_isValidHeader(_c,_d)){return;}var _j;var _k='<contents>\n<columns>\n';var _l='</columns>\n<head>\n';var _m='</head>\n<body>\n';var _n='<cell color="white" display="text" ';var _o='<cell ';var _p=_c.getColCount();var _q=_c.getCellCount("head");var _r=_p-_q;var _s;var _t=0;var _u=_d;_u=nexacro.toNumber(_u)+nexacro.toNumber(_r);for(var _v=0;_v<_p;_v++ ){if(_v<_u){_k+='<col width="'+_c.getFormatColProperty(_v,"size")+'"/>\n';_s=_c.getCellProperty("head",_t,"col");if(_v==_s){_l+=_n+'col="'+_v+'" '+this.m2n_lookupPath("sysf_SetGridHead")(_c,_t);_t++ ;}_m+=_o+'col="'+_v+'" '+this.m2n_lookupPath("sysf_SetGridBody")(_c,_v);}else if(_v==_u){_k+='<col width="'+_g+'"/>\n';_k+='<col width="'+_c.getFormatColProperty(_v,"size")+'"/>\n';_l+=_n+'col="'+_v+'" text="'+_e+'" color="white"/>\n';_m+=_o+'col="'+_v+'" bkcolor="white" bkcolor2="#eceef1"';_m+=' colid="'+_f+'" display="'+_h+'"';_m+=' align="'+_i+'"/>\n';_l+=_n+'col="'+(_v+1)+'" '+this.m2n_lookupPath("sysf_SetGridHead")(_c,_v-_r);_m+=_o+'col="'+(_v+1)+'" '+this.m2n_lookupPath("sysf_SetGridBody")(_c,_v);_t++ ;}else{_k+='<col width="'+_c.getFormatColProperty(_v,"size")+'"/>\n';_l+=_n+'col="'+(_v+1)+'" '+this.m2n_lookupPath("sysf_SetGridHead")(_c,_v-_r);_m+=_o+'col="'+(_v+1)+'" '+this.m2n_lookupPath("sysf_SetGridBody")(_c,_v);_t++ ;}}_j=_k+_l+_m+'</body>\n</contents>';this.m2n_setContents(_c,_j);};this.sysf_deleteGrdColumn=function(_c,_d){if(!this._sysf_isValidHeader(_c,_d)){return;}var _e;var _f=_c.getColCount();var _g=_c.getCellCount("head");var _h='<contents>\n<columns>\n';var _i='</columns>\n<head>\n';var _j='</head>\n<body>\n';var _k='<cell color="white" display="text" ';var _l='<cell ';var _m=_f-_g;var _n;var _o=0;var _p=nexacro.toNumber(_d);for(var _q=0;_q<_f;_q++ ){if(_q<_p){_h+='<col width="'+_c.getFormatColProperty(_q,"size")+'"/>\n';_n=_c.getCellProperty("head",_o,"col");if(_q==_n){_i+=_k+'col="'+_q+'" '+this.m2n_lookupPath("sysf_SetGridHead")(_c,_o);_o++ ;}_j+=_l+'col="'+_q+'" '+this.m2n_lookupPath("sysf_SetGridBody")(_c,_q);}else if(_q>_p){_h+='<col width="'+_c.getFormatColProperty(_q,"size")+'"/>\n';_i+=_k+'col="'+(_q -1)+'" '+this.m2n_lookupPath("sysf_SetGridHead")(_c,_q-_m);_j+=_l+'col="'+(_q -1)+'" '+this.m2n_lookupPath("sysf_SetGridBody")(_c,_q);_o++ ;}}_e=_h+_i+_j+'</body>\n</contents>';this.m2n_setContents(_c,_e);};this._sysf_isValidHeader=function(_c,_d){var _e=true;var _f=_c.getCellCount("head");if(_f<=_d){this.m2n_lookupPath("gf_alert")("XSYSW0106");_e=false;return _e;}for(i=0;i<_f;i++ ){if(_c.getCellProperty("head",i,"row")>0){_e=false;this.m2n_lookupPath("gf_alert")("XSYSW0107");return _e;break;}}if(_c.getCellProperty("head",_d,"colspan")>1){this.m2n_lookupPath("gf_alert")("XSYSW0108");_e=false;}return _e;};this._sysf_setGrdBody=function(_c,_d){var _e;var _f;if(_c.getCellProperty("body",_d,"celltype")=="head"){_e+='align="center" bkcolor="#919cb1" celltype="head" color="white" font="돋움체,7" ';}else{_e+='bkcolor="white" bkcolor2="#eceef1" align="'+_c.getCellProperty("body",_d,"textAlign")+'" ';}if(_c.getCellProperty("body",_d,"edittype")=="none"){_e+='edti="'+_c.getCellProperty("body",_d,"edittype")+'" ';}_e+='display="'+_c.getCellProperty("body",_d,"displaytype")+'" ';if(this.m2n_length(_c.getCellProperty("body",_d,"expr"))>1){_f=_c.getCellProperty("body",_d,"expr");_f=this.m2n_replace(_f,'\"','&quot;');_e+='expr=\''+_f+'\' ';}_e+='colid="'+this.m2n_getColidProperty(_c.getCellProperty("body",_d,"text"))+'" />\n';return _e;};this._sysf_setHeader=function(_c,_d){var _e="";if(_c.getCellProperty("head",_d,"colspan")>1){_e+='colspan="'+_c.getCellProperty("head",_d,"colspan")+'" ';}_e+='text="'+_c.getCellProperty("head",_d,"text")+'"/>\n';return _e;};this.sysf_findGrdText=function(_c,_d,_e,_f,_g){if(!this.m2n_isValid(this.m2n_getObject(_c))){this.m2n_lookupPath("gf_alert")("XSYSW0109");return;}else{if(this.m2n_getType(this.m2n_getObject(_c))!="Grid"){this.m2n_lookupPath("gf_alert")("XSYSW0109");return;}}if(this.m2n_length(_e)>0){if(this.m2n_length(this.m2n_split(_d,","))!=this.m2n_length(this.m2n_split(_e,","))){this.m2n_lookupPath("gf_alert")("XSYSW0110");return;}}if(this.m2n_length(_f)>0){if(this.m2n_length(this.m2n_split(_e,",","webstyle"))!=this.m2n_length(this.m2n_split(_f,",","webstyle"))){this.m2n_lookupPath("gf_alert")("XSYSW0111");return;}}if(this.m2n_length(_g)<0){_g="N";}else{if(_g!="R"){_g="N";}}var _h="strGrd="+_c+" strTxt="+nexacro.wrapQuote(_d);_h+=" strCol="+nexacro.wrapQuote(_e)+" strTyp="+nexacro.wrapQuote(this.m2n_toLower(_f))+" strGbn="+nexacro.wrapQuote(this.m2n_toUpper(_g));var _i=this.m2n_lookupPath("sysf_openDialog")("CM_MAN","MAN10U0120P",_h,330,118,true,-1,-1);};this.sysf_uncheckDataset=function(_c,_d){_c.set_updatecontrol(false);_c.set_enableevent(false);for(var _e=0;_e<_c.getRowCount();_e++ ){if(_c.getColumn(_e,_d)==1){_c.setColumn(_e,_d,0);}}_c.set_enableevent(true);_c.set_updatecontrol(true);};this.sysf_savePosBeforeGrdRenew=function(_b){var _c=_b.vscrollbar.pos;this.sysv_GridReFindProc=_c;};this.sysf_restorePosAfterGrdRenew=function(_b,_c){var _d;var _e;if(this.m2n_length(this.m2n_trim(_c))==0){_e=this.sysv_GridReFindProc;}else{_e=_c;}_d=_e+_b.pagerowcount;var _f=this.m2n_getObject(this.m2n_getBindDataset(_b));if(_f.getRowCount()<=_d){_f.row=_f.getRowCount()-1;}else{_f.row=_d;}_f.row=_e;};this.sysf_truncUncheckedRow=function(_c,_d){_c.set_enableevent(false);for(var _e=_c.getRowCount()-1;_e>=0;_e-- ){if((this.m2n_getRowType(_c,_e)=="insert")&&(_c.getColumn(_e,_d)!=1)){_c.deleteRow(_e);}}_c.set_enableevent(true);};this.sysf_setStateFlag=function(_c,_d,_e){var _f=0;if(this.m2n_length(_e)>0){this.sysf_truncUncheckedRow(_d,_e);}_d.set_updatecontrol(false);for(var _g=0;_g<_d.rowcount;_g++ ){if(this.m2n_getRowType(_d,_g)=="normal"){_d.setColumn(_g,"state_flag","");continue;}if(_c=="SAVE"){if(this.m2n_getRowType(_d,_g)=="insert"){if(this.m2n_length(_e)==0){_d.setColumn(_g,"state_flag","I");_f++ ;}else if(_d.getColumn(_g,_e)==1){_d.setColumn(_g,"state_flag","I");_f++ ;}}else if(this.m2n_getRowType(_d,_g)=="update"){if(this.m2n_length(_e)==0){_d.setColumn(_g,"state_flag","U");_f++ ;}else if(_d.getColumn(_g,_e)==1){_d.setColumn(_g,"state_flag","U");_f++ ;}}}else if(_c=="DELETE"){if(this.m2n_length(_e)==0){_d.setColumn(_g,"state_flag","D");_f++ ;}else if(_d.getColumn(_g,_e)==1){_d.setColumn(_g,"state_flag","D");_f++ ;}}}_d.set_updatecontrol(true);return _f;};this.sysf_refreshDatasetCheck=function(_c,_d,_e,_f,_g,_h){if(_e==_h){if((_g==0)||(this.m2n_isNull(_g)==true)){if(this.m2n_getRowType(_c,_d)=="update"){_c.set_enableevent(false);for(i=0;i<=_c.getColCount()-1;i++ ){_c.setColumn(_d,i,_c.getOrgColumn(_d,i));}_c.set_enableevent(true);}}return;}if(this.m2n_getRowType(_c,_d)=="update"){if((_c.getColumn(_d,_h)==0)||(this.m2n_isNull(_c.getColumn(_d,_h))==true)||(this.m2n_isNull(_c.getColumn(_d,_h))==true)){_c.set_enableevent(false);_c.setColumn(_d,_h,1);_c.set_enableevent(true);}return;}if(((_c.getColumn(_d,_h)==0)&&(this.m2n_getRowType(_c,_d)=="insert"))||((this.m2n_isNull(_c.getColumn(_d,_h))==true)&&(this.m2n_getRowType(_c,_d)=="insert"))){_c.set_enableevent(false);_c.setColumn(_d,_h,1);_c.set_enableevent(true);return;}};this.sysf_deleteCheckedDataset=function(_c,_d){_c.set_updatecontrol(false);_c.set_enableevent(false);for(var _e=_c.getRowCount()-1;_e>=0;_e-- ){if(_c.getColumn(_e,_d)==1){_c.deleteRow(_e);}}_c.set_enableevent(true);_c.set_updatecontrol(true);};this.sysf_selectGridCheckBox=function(_c,_d){if(_c.Editable==false){return;}var _e=this.m2n_getBindDataset(_c);if(_c.getSubCellProperty("head",0,1,"text")==1){_c.setSubCellProperty("head",0,1,"text","0");this._sysf_setGrdChk(0,_e,_d);}else{_c.setSubCellProperty("head",0,1,"text","1");this._sysf_setGrdChk(1,_e,_d);}};this._sysf_setGrdChk=function(_c,_d,_e){for(var _f=0;_f<this.m2n_getObject(_d).getRowCount();_f++ ){this.m2n_getObject(_d).setColumn(_f,_e,_c);}};this.sysf_isGridChecked=function(_c,_d){var _e=false;for(var _f=0;_f<_c.getRowCount();_f++ ){if(_c.getColumn(_f,_d)==1){_e=true;break;}}return _e;};this.sysf_uncheckDatasetAfterMove=function(_c,_d){for(var _e=0;_e<_c.getRowCount();_e++ ){if(_c.getColumn(_e,_d)==1){_c.setColumn(_e,_d,0);}}};});this.loadIncludeScript(_a);_b=null;};})();
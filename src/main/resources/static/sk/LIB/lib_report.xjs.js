(function(){return function(_a){var _b;this.registerScript(_a,function(){this.fv_rptUrl="http://172.21.9.134:8120";this.gfn_viewReport=function(_b,_c,_d,_e,_f,_g){var _h="pTitle="+nexacro.wrapQuote(_c);_h+=" pReportUrl="+nexacro.wrapQuote(_d);_h+=" pReportMap="+nexacro.wrapQuote(_e);_h+=" pReportParam="+nexacro.wrapQuote(_f);_h+=" pReportOpt="+nexacro.wrapQuote(_g);this.gfn_openPopup("COMM::ReportViewer.xfdl",_h);};this.gfn_printReport=function(_b,_c,_d,_e,_f,_g){this.fv_showOpen=_f;var _h="_rexRpt";var _i=this.lookup(_h);if(this.m2n_isValid(_i)==false){this.m2n_create(this,"ClipSoft",_h,'Left="0" Top="0" Height="0" Visible="FALSE" Width="0"');}this.rptObj=this.m2n_getObject(_h);if(this.gfn_openReport(_b,_h,_c,_d,_e)){_b.setEventHandlerLookup("ontimer","gfn_OnTimer",this);_b.setTimer(-98,300);if(this.m2n_isNull(this.fv_showOpen)==true){this.fv_showOpen=false;}}};this.fv_StartPage=1;this.fv_EndPage=-1;this.fv_PageCnt=1;this.rptObj="";this.fv_showOpen="";this.fv_filePath="";this.gfn_exportReport=function(_b,_c,_d,_e,_f,_g){this.fv_filePath=_f;this.fv_showOpen=_g;var _h="_rexRpt";var _i=this.lookup(_h);if(this.m2n_isValid(_i)==false){this.m2n_create(this,"ClipSoft",_h,'Left="0" Top="0" Height="0" Visible="FALSE" Width="0"');}this.rptObj=this.m2n_getObject(_h);if(this.gfn_openReport(_b,_h,_c,_d,_e)){_b.setEventHandlerLookup("ontimer","gfn_OnTimer",this);_b.setTimer(-99,300);if(this.m2n_isNull(this.fv_showOpen)==true){this.fv_showOpen=false;}}};this.gfn_OnTimer=function(_b,_c){if(_c==-99){this.killTimer(-99);this.rptObj.Export(this.fv_showOpen,"xls",this.fv_filePath,this.fv_StartPage,this.fv_EndPage,this.fv_PageCnt);}else if(_c==-98){this.killTimer(-98);this.rptObj.Print(this.fv_showOpen,this.fv_StartPage,this.fv_EndPage,this.fv_PageCnt);}};this.gfn_openReport=function(_b,_c,_d,_e,_f){var _g=this.m2n_getObject(_c);if(this.m2n_isValidObject(_g)==false){this.alert("리포트 객체가 존재하지 않습니다.");return false;}var _h="";var _i=this.gfn_baseUrl(_b);var _j=_i+"REPORT/"+_d;if(this.m2n_length(_e)==0){var _k=this.m2n_split2(_b.url,"::","_");var _l=this.m2n_toLower(_k[0][0])+"DataSource";var _m=this.gfn_openReportBySql(_g,_j,_l,_f);_h+=_m;}else{_h+="<?xml version='1.0' encoding='utf-8'?>	\n";_h+="<oof version ='3.0'>	\n";_h+="	<document enable-thread='1'>	\n";_h+="		<file-list><file type='reb' path='"+_j+"'></file></file-list>	\n";_h+="		<connection-list>	\n";_h+="			<connection type='memo' namespace='*'>	\n";_h+="				<config-param-list>	\n";_h+="					<config-param name='data'>	\n";var _n=this.gfn_makeRexDataXml(_e,_f);_h+=_n[0];_h+="					</config-param>	\n";_h+="				</config-param-list>	\n";_h+=_n[1];_h+="			</connection>	\n";_h+="		</connection-list>	\n";_h+="		<field-list>	\n";_h+=_n[2];_h+="		</field-list>	\n";}_h+="<plugin-list>	\n";_h+="<plugin type='bcqure'>	\n";_h+="<config-param-list>	\n";_h+="<config-param name='initpath'>"+this.fv_rptUrl+"/rexpert//plugin/bcqre/prnInit/</config-param>	\n";_h+="<config-param name='datapath'>"+this.fv_rptUrl+"/rexpert//plugin/bcqre/bcqre.server.jsp</config-param>	\n";_h+="<config-param name='docnumber'>default</config-param>	\n";_h+="<config-param name='docname'>default</config-param>	\n";_h+="<config-param name='barcodewidth'>600</config-param>	\n";_h+="<config-param name='barcodeminheight'>50</config-param>	\n";_h+="<config-param name='barcodemaxheight'>200</config-param>	\n";_h+="</config-param-list>	\n";_h+="</plugin>	\n";_h+="</plugin-list>	\n";_h+="	</document>	\n";_h+="</oof>";_g.SetCSS("appearance.statusbar.visible=0");_g.SetCSS("appearance.tabheader.visible=0");_g.SetCSS("appearance.toolbar.button.about.visible=0");_g.SetCSS("appearance.toolbar.button.movecontent.visible=0");_g.UpdateCSS();_g.OpenOOF(_h);return true;};this.gfn_makeRexDataXml=function(_c,_d){var _e=new Array();var _f="";var _g="";var _h="";if(this.m2n_length(_c)>0){var _i=this.m2n_split(_c," ","WebStyle");var _j=new Array();_f+="<gubun>	\n";for(var _m=0;_m<this.m2n_length(_i);_m++ ){_j=this.m2n_split(_i[_m],"=");_f+="<"+_j[0]+">	\n";if(this.m2n_pos(_j[1],"/")>-1){var _k=this.m2n_split(_j[1],"/");_f+="<root>	\n";for(var _n=0;_n<this.m2n_length(_k);_n++ ){var _l=this.m2n_replace(this.m2n_getObject(_k[_n]).saveXML(),"<?xml version=\"1.0\" encoding=\"euc-kr\"?>","");_l=this.m2n_replace(_l,"<root>","");_l=this.m2n_replace(_l,"</root>","");_l=this.m2n_replace(this.m2n_replace(_l,"<dataset","<"+_k[_n]),"/dataset>","/"+_k[_n]+">");_f+="	"+this.m2n_trim(_l)+"\n";}_f+="</root>	\n";_f+="</"+_j[0]+">	\n";_g+="				<content content-type='xml' namespace="+nexacro.wrapQuote(_j[0])+">	\n";_g+="					<content-param name='root'>gubun/"+_j[0]+"/root/"+_k[0]+"/record</content-param>	\n";_g+="					<content-param name='preservedwhitespace'>1</content-param>	\n";_g+="					<content-param name='bindmode'>name</content-param>	\n";_g+="				</content>	\n";}else{var _l=this.m2n_replace(this.m2n_getObject(_j[1]).saveXML(),"<?xml version=\"1.0\" encoding=\"euc-kr\"?>","");_l=this.m2n_replace(this.m2n_replace(_l,"<dataset","<"+_j[1]),"/dataset>","/"+_j[1]+">");_f+=_l;_f+="\n</"+_j[0]+">	\n";_g+="				<content content-type='xml' namespace="+nexacro.wrapQuote(_j[0])+">	\n";_g+="					<content-param name='root'>gubun/"+_j[0]+"/root/"+_j[1]+"/record</content-param>	\n";_g+="					<content-param name='preservedwhitespace'>1</content-param>	\n";_g+="					<content-param name='bindmode'>name</content-param>	\n";_g+="				</content>	\n";}}_f+="</gubun>	\n";}if(this.m2n_length(_d)>0){_i=this.m2n_split(_d," ","WebStyle");for(var _m=0;_m<this.m2n_length(_i);_m++ ){_j=this.m2n_split(_i[_m],"=");_h+="			<field name="+nexacro.wrapQuote(_j[0])+">"+_j[1]+"</field>	\n";}}_e[0]=_f;_e[1]=_g;_e[2]=_h;return _e;};this.gfn_openReportBySql=function(_c,_d,_e,_f){var _g="";_g+="<?xml version='1.0' encoding='utf-8'?> ";_g+="<oof version ='3.0'> ";_g+="<document title='report' enable-thread='0'> ";_g+="<file-list> ";_g+="<file type='reb' path='"+_d+"'></file> ";_g+="</file-list> ";_g+="<connection-list> ";_g+="<connection type='http' namespace='*'> ";_g+="<config-param-list> ";_g+="<config-param name='path'>"+this.fv_rptUrl+"/rexpert/rexservice.jsp</config-param> ";_g+="</config-param-list> ";_g+="<http-param-list><http-param name='Q1SQL'>{%auto%}</http-param> ";_g+="<http-param name='OE'>None</http-param> ";_g+="<http-param name='CN'>"+_e+"</http-param><http-param name='ID'>SDCSV</http-param> ";_g+="<http-param name='PE'>FALSE</http-param><http-param name='QC'>1</http-param> ";_g+="<http-param name='OT'>DataOnly</http-param> ";_g+="<http-param name='Q1Type'>SQL</http-param> ";_g+="</http-param-list> ";_g+="<content content-type='csv'> ";_g+="<content-param name='col-delim'>|*|</content-param> ";_g+="<content-param name='row-delim'>|#|</content-param> ";_g+="<content-param name='dataset-delim'>|@|</content-param> ";_g+="<content-param name='encoding'>UTF-8</content-param> ";_g+="</content></connection></connection-list> ";var _h=this.gfn_makeRexDataXml("",_f);_g+="		<field-list>	\n";_g+=_h[2];_g+="		</field-list>	\n";return _g;};});this.loadIncludeScript(_a);_b=null;};})();
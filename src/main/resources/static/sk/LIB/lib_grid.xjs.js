(function(){return function(_a){var _b;this.registerScript(_a,function(){this.ASC_MARK="▲";this.DESC_MARK="▼";this.fv_crtCheck=false;this.orgObj="";this.gfn_GridSort=function(_c,_d,_e){var _f=this.m2n_getBindDataset(_c);var _g=_c;if(_g.getCellProperty("Head",_d,"displaytype")=="checkbox"){if(_g.Editable==true){this.gfn_gridHeadCheck(_g,_d,this.m2n_getColidProperty(_g.getCellProperty("body",_d,"text")),false);}return;}if(getKeyState("Ctrl")){if(this.fv_crtCheck==false){this.m2n_create(this,"Dataset","cds_grdsort","");this.m2n_lookupPath("cds_grdsort").addColumn("Col","String",255);this.m2n_lookupPath("cds_grdsort").addColumn("Sort","String",255);this.fv_crtCheck=true;}if(_g!=this.orgObj){this.m2n_lookupPath("cds_grdsort").deleteAll();this.orgObj=_g;}if(this.m2n_lookupPath("cds_grdsort").getRowCount()<1){this.gfn_clearSortMarkAll(_c);}this.gfn_procGridMultiSort(_c,_f,_d);}else{if(this.fv_crtCheck){this.m2n_lookupPath("cds_grdsort").deleteAll();}this.gfn_procGridSort(_c,_f,_d,_e);}};this.gfn_procGridMultiSort=function(_c,_d,_e,_f){var _g,_h;var _i;var _j;var _k="";var _l;var _m;var _n=_c.getCellCount("head");var _o=_c.getCellCount("body");for(var _t=0;_t<_n;_t++ ){if(_e==_t){break;}}_i=_c.getCellProperty("head",_t,"col");for(var _u=0;_u<_o;_u++ ){if(_i==_c.getCellProperty("body",_u,"col")){break;}}if(this.m2n_right(_c.getCellProperty("head",_e,"text"),1)==this.ASC_MARK){if(_c.getCellProperty("head",_e,"colspan")>1){_j=_c.getCellProperty("head",_t,"colspan");_l=_c.getCellProperty("head",_t,"row");for(var _v=0;_v<_o;_v++ ){if((_c.getCellProperty("Body",_v,"col")>=_i)&&_c.getCellProperty("Body",_v,"col")<(nexacro.toNumber(_i)+nexacro.toNumber(_j))){_k+=this.m2n_getColidProperty(_c.getCellProperty("Body",_v,"text"))+",";}}_m=nexacro.toNumber(_i)+nexacro.toNumber(_j);this.gfn_clearHeaderSortMark(_c,_i,_m,_l);}else{_k=this.m2n_getColidProperty(_c.getCellProperty("Body",_u,"text"));}_g=this.m2n_replace(_c.getCellProperty("head",_e,"text"),this.ASC_MARK,"")+this.DESC_MARK;_h=this.DESC_MARK;}else if(this.m2n_right(_c.getCellProperty("head",_e,"text"),1)==this.DESC_MARK){if(_c.getCellProperty("head",_e,"colspan")>1){_j=_c.getCellProperty("head",_t,"colspan");_l=_c.getCellProperty("head",_t,"row");for(var _v=0;_v<_o;_v++ ){if((_c.getCellProperty("Body",_v,"col")>=_i)&&_c.getCellProperty("Body",_v,"col")<(nexacro.toNumber(_i)+nexacro.toNumber(_j))){_k+=this.m2n_getColidProperty(_c.getCellProperty("Body",_v,"text"))+",";}}_m=nexacro.toNumber(_i)+nexacro.toNumber(_j);this.gfn_clearHeaderSortMark(_c,_i,_m,_l);}else{_k=this.m2n_getColidProperty(_c.getCellProperty("Body",_u,"text"));}_g=this.m2n_replace(_c.getCellProperty("head",_e,"text"),this.DESC_MARK,"");_h="";}else{if(_c.getCellProperty("head",_e,"colspan")>1){_j=_c.getCellProperty("head",_t,"colspan");_l=_c.getCellProperty("head",_t,"row");for(var _v=0;_v<_o;_v++ ){if((_c.getCellProperty("Body",_v,"col")>=_i)&&_c.getCellProperty("Body",_v,"col")<(nexacro.toNumber(_i)+nexacro.toNumber(_j))){_k+=this.m2n_getColidProperty(_c.getCellProperty("Body",_v,"text"))+",";}}_m=nexacro.toNumber(_i)+nexacro.toNumber(_j);this.gfn_clearHeaderSortMark(_c,_i,_m,_l);}else{_k=this.m2n_getColidProperty(_c.getCellProperty("Body",_u,"text"));}_g=_c.getCellProperty("head",_e,"text");_g=_g+this.ASC_MARK;_h=this.ASC_MARK;}var _p=this.m2n_split(_k,",");for(var _w=0;_w<this.m2n_length(_p);_w++ ){var _q=this.m2n_lookupPath("cds_grdsort").findRow("Col",_p[_w]);if(_q<0){this.m2n_lookupPath("cds_grdsort").addRow();this.m2n_lookupPath("cds_grdsort").setColumn(this.m2n_lookupPath("cds_grdsort").rowposition,"Col",_p[_w]);this.m2n_lookupPath("cds_grdsort").setColumn(this.m2n_lookupPath("cds_grdsort").rowposition,"Sort","A");if(this.m2n_isNull(_h)==true){this.m2n_lookupPath("cds_grdsort").deleteRow(_q);}}else{this.m2n_lookupPath("cds_grdsort").deleteRow(_q);if(this.m2n_isNull(_h)!=true){this.m2n_lookupPath("cds_grdsort").addRow();this.m2n_lookupPath("cds_grdsort").setColumn(this.m2n_lookupPath("cds_grdsort").rowposition,"Col",_p[_w]);if(_h==this.DESC_MARK){this.m2n_lookupPath("cds_grdsort").setColumn(this.m2n_lookupPath("cds_grdsort").rowposition,"Sort","D");}else{this.m2n_lookupPath("cds_grdsort").setColumn(this.m2n_lookupPath("cds_grdsort").rowposition,"Sort","A");}}}}var _r="";for(var _w=0;_w<this.m2n_lookupPath("cds_grdsort").getRowCount();_w++ ){if(this.m2n_length(this.m2n_lookupPath("cds_grdsort").getColumn(_w,"Col"))<1){continue;}if(_w==nexacro.toNumber(this.m2n_lookupPath("cds_grdsort").getRowCount())-1){_r+=this.m2n_lookupPath("cds_grdsort").getColumn(_w,"Col")+":"+this.m2n_lookupPath("cds_grdsort").getColumn(_w,"Sort");}else{_r+=this.m2n_lookupPath("cds_grdsort").getColumn(_w,"Col")+":"+this.m2n_lookupPath("cds_grdsort").getColumn(_w,"Sort")+",";}}if(this.m2n_lookupPath("cds_grdsort").getRowCount()<1){var _o=_c.getCellCount("Body");var _s=0;if(this.m2n_length(_f)>2){_r+=this.gfn_defaultSortCols(_f);}else{for(_w=0;_w<_o;_w++ ){if(this.m2n_length(this.m2n_getColidProperty(_c.getCellProperty("Body",_w,"text")))>1){if((this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_w,"text")))!=true)&&(this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_w,"text")))!=true)){_r+=this.m2n_getColidProperty(_c.getCellProperty("Body",_w,"text"))+",";_s++ ;}}if(_s==5){break;}}}}this.m2n_sort(this.m2n_getObject(_d),_r,true);_c.setCellProperty("head",_e,"text",_g);};this.gfn_procGridSort=function(_c,_d,_e,_f){var _g;var _h;var _i;var _j="";var _k=_c.getCellCount("head");var _l=_c.getCellCount("body");for(var _p=0;_p<_k;_p++ ){if(_e==_p){break;}}_h=_c.getCellProperty("head",_p,"col");for(var _q=0;_q<_l;_q++ ){if(_h==_c.getCellProperty("body",_q,"col")){break;}}if(this.m2n_right(_c.getCellProperty("head",_e,"text"),1)==this.ASC_MARK){if(_c.getCellProperty("head",_e,"colspan")>1){_i=_c.getCellProperty("head",_p,"colspan");for(var _r=0;_r<_l;_r++ ){if((_c.getCellProperty("Body",_r,"col")>=_h)&&_c.getCellProperty("Body",_r,"col")<(nexacro.toNumber(_h)+nexacro.toNumber(_i))){_j+=this.m2n_getColidProperty(_c.getCellProperty("Body",_r,"text"))+",";}}}else{_j=this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text"));}_g=_c.getCellProperty("head",_p,"text");_g=this.m2n_replace(_g,this.ASC_MARK,"");_g=_g+this.DESC_MARK;this.m2n_sort(this.m2n_getObject(_d),_j,false);}else if(this.m2n_right(_c.getCellProperty("head",_e,"text"),1)==this.DESC_MARK){var _m=0;if(this.m2n_length(_f)>2){_j+=this.gfn_defaultSortCols(_f);}else{for(var _s=0;_s<_l;_s++ ){if(this.m2n_length(this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text")))>1){if((this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text")))!=true)&&(this.m2n_isNull(this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text")))!=true)){_j+=this.m2n_getColidProperty(_c.getCellProperty("Body",_s,"text"))+",";_m++ ;}}if(_m==5){break;}}}_g=_c.getCellProperty("head",_e,"text");_g=this.m2n_replace(_g,this.DESC_MARK,"");this.m2n_sort(this.m2n_getObject(_d),_j,true);}else{if(_c.getCellProperty("head",_e,"colspan")>1){_i=_c.getCellProperty("head",_p,"colspan");for(var _r=0;_r<_l;_r++ ){if((_c.getCellProperty("Body",_r,"col")>=_h)&&_c.getCellProperty("Body",_r,"col")<(nexacro.toNumber(_h)+nexacro.toNumber(_i))){_j+=this.m2n_getColidProperty(_c.getCellProperty("Body",_r,"text"))+",";}}}else{_j=this.m2n_getColidProperty(_c.getCellProperty("Body",_q,"text"));}_g=_c.getCellProperty("head",_p,"text");_g=_g+this.ASC_MARK;this.m2n_sort(this.m2n_getObject(_d),_j,true);}_c.setCellProperty("head",_e,"text",_g);var _n=_c.getCellCount("head");var _o;for(var _s=0;_s<_n;_s++ ){if(_e!=_s){_o=this.m2n_replace(this.m2n_replace(_c.getCellProperty("head",_s,"text"),this.ASC_MARK,""),this.DESC_MARK,"");_c.setCellProperty("head",_s,"text",_o);}}};this.gfn_defaultSortCols=function(_c){var _d;var _e=this.m2n_split(_c,",","webstyle");var _f=this.m2n_length(_e);for(var _g=0;_g<_f;_g++ ){if(this.m2n_length(_e[_g])<1){continue;}_d+=_e[_g]+",";}return _d;};this.gfn_clearSortMarkAll=function(_b){var _c=_b.getCellCount("head");var _d;for(var _e=0;_e<_c;_e++ ){_d=this.m2n_replace(this.m2n_replace(_b.getCellProperty("head",_e,"text"),this.ASC_MARK,""),this.DESC_MARK,"");_b.setCellProperty("head",_e,"text",_d);}};this.gfn_clearHeaderSortMark=function(_b,_c,_d,_e){var _f=_b.getCellCount("head");var _g;var _h;var _i;for(var _j=0;_j<_f;_j++ ){_h=_b.getCellProperty("head",_j,"row");_i=_b.getCellProperty("head",_j,"col");if(_i>=_c&&_i<_d){if(_e<_h){_g=this.m2n_replace(this.m2n_replace(_b.getCellProperty("head",_j,"text"),this.ASC_MARK,""),this.DESC_MARK,"");_b.setCellProperty("head",_j,"text",_g);}}}};this.gfn_gridHeadCheck=function(_c,_d,_e,_f){var _g=this.m2n_split(_e,":");var _h=this.m2n_decode(_g[1],null,_d,_g[1]);var _i=_c.getCellProperty('Head',_d,'text');if(this.m2n_length(_i)==0){_i="0";}_f=this.m2n_decode(_f,null,true,_f);var _j=this.m2n_decode(_i,"0","1","1","0");_c.setCellProperty('Head',_d,'text',_j);var _k=this.m2n_trim(_c.getCellProperty("body",_h,"edittype"));var _l=this.m2n_getColidProperty(_c.getCellProperty("body",_h,"text"));if(_k=="checkbox"){this.gfn_setColumnAll(this.m2n_getBindDataset(_c),_g[0],_j);}else if(this.m2n_pos(_k,"expr:iif")>=0&&this.m2n_pos(_k,"checkbox")>=0){var _m=this.m2n_pos(_k,"(")+1;var _n=this.m2n_trim(this.m2n_subString(_k,_m,this.m2n_pos(_k,",")-_m));var _o="";var _p="";var _q=this.m2n_pos(_n,"&&");var _r=this.m2n_pos(_n,"||");var _s=0;var _t=0;if(_q>=0||_r>=0){while(_q>=0||_r>=0){_t=this.m2n_iif(_q>_r,_q,_r);_o+=this.gfn_parseExprStr(this.m2n_trim(this.m2n_subString(_n,_s,_t-_s)),this.m2n_getBindDataset(_c));_o+=this.m2n_subString(_n,_t,2);_q=this.m2n_pos(_n,"&&",_t+2);_r=this.m2n_pos(_n,"||",_t+2);_s=_t+2;}if(_s<this.m2n_length(_n)){_o+=this.gfn_parseExprStr(this.m2n_trim(this.m2n_subString(_n,_s,this.m2n_length(_n)-_s)),this.m2n_getBindDataset(_c));}}else{_o=this.gfn_parseExprStr(_n,this.m2n_getBindDataset(_c));}var _u=this.m2n_getObject(this.m2n_getBindDataset(_c));for(var _v=0;_v<_u.getRowCount();_v++ ){if(eval(this.m2n_replace(_o,"_idx_",_v))){_u.setColumn(_v,_l,_j);}}}};this.gfn_setColumnAll=function(_c,_d,_e,_f,_g,_h){var _i=this.m2n_getObject(_c);var _j=this.m2n_decode(_f,null,0,_f);var _k=this.m2n_decode(_g,null,_i.getRowCount()-1,_g);_h=this.m2n_decode(_h,null,true,_h);if(_h==false){_i.set_enableevent(false);}for(var _l=_j;_l<=_k;_l++ ){_i.setColumn(_l,_d,_e);}if(_h==false){_i.set_enableevent(true);}};this.gfn_parseExprStr=function(_c,_d){var _e="";var _f="";var _g="";var _h=false;var _i=false;var _j=0;while(_j<this.m2n_length(_c)){_f=this.m2n_charAt(_c,_j);if(nexacro.isAlphaNumeric(_f)){if(_i){_e+=_f;}else if(_h){_g+=_f;}else{_h=true;_g+=_f;}}else{if(_h){_h=false;_i=true;_e+=_d+".GetColumn(_idx_,'"+_g+"' )";}_e+=_f;}_j++ ;}return _e;};this.gfn_addCheckCol=function(_c,_d){var _e=this.m2n_getObject(_c);if(this.m2n_isNull(this.m2n_getColType(_e,_d))==true){_e.addColumn(_d,"INT",1);for(var _f=0;_f<=_e.rowcount;_f++ ){_e.setColumn(_f,_d,0);}_e.applyChange();}};this.gfn_addColumn=function(_c,_d,_e){var _f=this.m2n_getObject(_c);if(this.m2n_isNull(this.m2n_getColType(_f,_d))==true){_f.addColumn(_d,"STRING");for(var _g=0;_g<=_f.rowcount;_g++ ){_f.setColumn(_g,_d,_e);}_f.applyChange();}};this.gfn_gridCheckExist=function(_c,_d,_e){var _f=this.m2n_getObject(this.m2n_getBindDataset(_c));for(var _g=0;_g<this.m2n_length(_f);_g++ ){if(_f.getColumn(_g,_d)==1){return true;}}if(this.m2n_isNull(_e)==true||_e==true){this.gfn_alert("ECI0019","");}return false;};this.gfn_gridCheckUnique=function(_c,_d,_e){var _f=this.m2n_getObject(this.m2n_getBindDataset(_c));var _g=false;for(var _h=0;_h<this.m2n_length(_f);_h++ ){if(_f.getColumn(_h,_d)==1){if(_g){if(this.m2n_isNull(_e)==true||_e==true){this.gfn_alert("ECI0020","");}return false;}else{_g=true;}}}if(!_g&&(this.m2n_isNull(_e)==true||_e==true)){this.gfn_alert("ECI0019","");}return _g;};this.gfn_requiredCheckGrid=function(_c,_d,_e){var _f=this.m2n_getObject(this.m2n_getBindDataset(_c));var _g=this.m2n_split(_d,";");var _h=this.m2n_indexOf(_d,"=");for(var _j=0;_j<_g.length;_j++ ){var _i=new Array(2);if(_h>-1){_i=this.m2n_split(_g[_j],"=");}else{_i[0]=_g[_j];_i[1]=this.gfn_getHeaderText(_c,_g[_j]);}for(var _k=0;_k<this.m2n_length(_f);_k++ ){if(this.gfn_IsEmpty(_f.getColumn(_k,_i[0]))){if(this.m2n_isNull(_e)==true||_e==true){this.gfn_alert("ECI0012",_i[1]);_f.row=_k;_c.setCellPos(_c.getBindCellIndex("body",_i[0]));_c.showEditor();}return false;}}}return true;};this.gfn_getHeaderText=function(_c,_d){var _e=_c.getBindCellIndex("body",_d);var _f=0;var _g=_c.getCellCount("head");for(var _i=0;_i<_g;_i++ ){_f+=_c.getCellProperty("head",_i,"colspan");if(_f -1>=_e){var _h=_c.getCellProperty("head",_i,"text");return _h;break;}}};this.gfn_emptyRowDelete=function(_c){var _d=this.m2n_getBindDataset(_c);var _e=this.m2n_getObject(_d).rowcount;_c.set_enableredraw(false);for(var _h=_e;_h>0;_h-- ){var _f="";var _g=false;for(var _i=0;_i<_c.getColCount();_i++ ){_f=_c.getCellValue(_h,_i);if(this.m2n_length(_f)>0){_g=true;continue;}}if(!_g){this.m2n_getObject(_d).deleteRow(_h);}}_c.set_enableredraw(true);};this.gfn_gridBlockCopy=function(_b,_c,_d){if(_d){if(_c==86){var _e=this.m2n_getObject(this.m2n_getBindDataset(_b));var _f=system.getClipboard("CF_TEXT");var _g=this.m2n_split2(_f,"\n",",");var _h=_e.row;var _i=_e.rowposition;var _j=_e.rowcount;var _k=_g.length;if(_g[0].length>_b.getCellCount("body")-_b.getCellPos()){this.alert("Paste 컬럼 불일치");return;}var _l=(_i+_k)-_j;if(_l>0){for(var _v=0;_v<_l;_v++ ){_e.addRow();}}_e.set_enableevent(false);for(var _v=0;_v<this.m2n_length(_g);_v++ ){var _m=_g[_v];_m=this.m2n_replace(_m,"[");_m=this.m2n_replace(_m,"]");var _n=this.m2n_split(_m,this.m2n_chr(9));var _o=_b.getCellPos();for(var _w=0;_w<_n.length;_w++ ){_e.setColumn(_h,_o,_n[_w]);_o++ ;}_h++ ;}_e.set_enableevent(true);}else if(_c==67){var _e=this.m2n_getObject(this.m2n_getBindDataset(_b));var _p;var _q,_r;var _s,_t;if(_b.selectstartrow==-1){_q=_e.row;_r=_e.row;_s=_b.getCellPos();_t=_b.getCellPos();}else{_q=_b.selectstartrow;_r=_b.selectendrow;_s=_b.selectstartcol;_t=_b.selectendcol;}for(var _v=_q;_v<=_r;_v++ ){for(var _w=_s;_w<=_t;_w++ ){_p+=_e.getColumn(_v,_w);if(_w!=_b.selectendcol){_p+=this.m2n_chr(9);}}if(_v!=_b.selectendrow){_p+="\n";}}system.clearClipboard();system.setClipboard("CF_TEXT",_p);}else if(_c==90){var _e=this.m2n_getObject(this.m2n_getBindDataset(_b));var _u;var _q,_r;var _s,_t;if(_b.selectstartrow==-1){_q=_e.row;_r=_e.row;_s=_b.getCellPos();_t=_b.getCellPos();}else{_q=_b.selectstartrow;_r=_b.selectendrow;_s=_b.selectstartcol;_t=_b.selectendcol;}for(var _v=_q;_v<=_r;_v++ ){for(var _w=_s;_w<=_t;_w++ ){_u=this.m2n_getColidProperty(_b.getCellProperty("body",_w,"text"));_e.setColumn(_v,_u,_e.getOrgColumn(_v,_u));}}}else if(_c==88){var _e=this.m2n_getObject(this.m2n_getBindDataset(_b));var _p;var _u;var _q,_r;var _s,_t;if(_b.selectstartrow==-1){_q=_e.row;_r=_e.row;_s=_b.getCellPos();_t=_b.getCellPos();}else{_q=_b.selectstartrow;_r=_b.selectendrow;_s=_b.selectstartcol;_t=_b.selectendcol;}for(var _v=_q;_v<=_r;_v++ ){for(var _w=_s;_w<=_t;_w++ ){_p+=_e.getColumn(_v,_w);if(_w!=_b.selectendcol){_p+=this.m2n_chr(9);}_u=this.m2n_getColidProperty(_b.getCellProperty("body",_w,"text"));_e.setColumn(_v,_u,"");}if(_v!=_b.selectendrow){_p+="\n";}}system.clearClipboard();system.setClipboard("CF_TEXT",_p);}}};this.fv_ds="";this.gfn_gridTreeInit=function(_c,_d,_e,_f,_g,_h){var _i=this.m2n_getObject(_c);var _j=this.m2n_getObject(_d);_h=this.m2n_decode(_h,null,"1",0,"1",_h);_i.set_enableredraw(false);_j.set_enableevent(false);this.m2n_destroy("__"+_d);this.m2n_create(this,"Dataset","__"+_d);var _k=this.m2n_getObject("__"+_d);_j.addColumn("EXPAND_YN","STRING","1");_j.addColumn("LEAF_YN","STRING","1");_j.addColumn("NEW_LEVEL","STRING","1");this.m2n_copyF(_k,_d);_k.clearData();var _l=3;var _m;for(var _p=0;_p<_j.getRowCount();_p++ ){_j.setColumn(_p,"EXPAND_YN","");_j.setColumn(_p,"LEAF_YN","");_j.setColumn(_p,"NEW_LEVEL",nexacro.toNumber(_j.getColumn(_p,_e))-_h+1);_m=nexacro.toNumber(_j.getColumn(_p,"NEW_LEVEL"));if(_m==1&&_c=="grdMenu"){_j.setColumn(_p,_g,this.m2n_space(1)+this.m2n_trim(_j.getColumn(_p,_g)));}else{_j.setColumn(_p,_g,this.m2n_space(_m* _l)+this.m2n_trim(_j.getColumn(_p,_g)));}if(_j.getColumn(_p-1,_e)<_j.getColumn(_p,_e)&&_p>0){_j.setColumn(_p-1,"LEAF_YN","N");_j.setColumn(_p-1,"EXPAND_YN","Y");}else{_j.setColumn(_p-1,"LEAF_YN","Y");_j.setColumn(_p-1,"EXPAND_YN","Y");}if(_p==_j.getRowCount()-1){_j.setColumn(_p,"LEAF_YN","Y");_j.setColumn(_p,"EXPAND_YN","Y");}}this.m2n_setBindDataset(_i,_j.id);var _n="NEW_LEVEL";for(var _p=0;_p<_j.getRowCountNF();_p++ ){var _o;if(_c=="grdMenu"){_o="expr:decode(LEAF_YN, 'Y', 'grdMenu_Leaf' + toString("+_n+"), decode(EXPAND_YN, 'Y', 'grdMenu_Expand' + toString("+_n+"), 'grdMenu_Collapse' + toString("+_n+")))";}else{_o="expr:decode(LEAF_YN, 'Y', 'gridtree_Leaf' + toString("+_n+"), decode(EXPAND_YN, 'Y', 'gridtree_Expand' + toString("+_n+"), 'gridtree_Collapse' + toString("+_n+")))";}_i.setCellProperty("body",this.gfn_getCellIdx(_c,_g),"style","background:sExpr;");}for(var _p=_j.getRowCountNF();_p>0;_p-- ){if(_j.getColumn(_p,"LEAF_YN")=="N"&&_j.getColumn(_p,"EXPAND_YN")=="Y"){this.gfn_gridTree(_c,_p,_f);}}_j.set_enableevent(true);_i.set_enableredraw(true);};this.gfn_getCellIdx=function(_c,_d){var _e=this.m2n_getObject(_c);var _f=-1;if(!this.m2n_isValid(_e)){return _f;}for(var _g=0;_g<_e.getCellCount("body");_g++ ){if(this.m2n_getColidProperty(_e.getCellProperty("body",_g,"text"))==_d){_f=_g;break;}}return _f;};this.gfn_gridTree=function(_c,_d,_e){var _f="NEW_LEVEL";var _g=this.m2n_getObject(_c);var _h=this.m2n_getObject(this.m2n_getBindDataset(_g));var _i=this.m2n_getObject("__"+this.m2n_getBindDataset(_g));if(_h.getColumn(_d,"LEAF_YN")=="Y"){return;}var _j=nexacro.toNumber(_h.getColumn(_d,_f));if(_h.getColumn(_d,"EXPAND_YN")=="N"){_h.set_enableevent(false);_h.setColumn(_d,"EXPAND_YN","Y");var _k=_d+1;var _l=_i.findRow(_e,_h.getColumn(_d,_e));_i.deleteRow(_l);for(var _m=_l;_m<_i.getRowCount();_m++ ){_h.insertRow(_k);_h.copyRow(_h.row,_i,_m);_i.deleteRow(_m);if(_i.getColumn(_m,"EXPAND_YN")=="E"){break;}_m-- ;_k++ ;}_i.deleteRow(_m);_h.set_enableevent(true);}else{_h.set_enableevent(false);_h.setColumn(_d,"EXPAND_YN","N");_i.addRow();_i.copyRow(_i.row,_h,_d);for(var _m=_d+1;_m<_h.getRowCount();_m++ ){if(_h.getColumn(_m,_f)<=_j){break;}_i.addRow();_i.copyRow(_i.row,_h,_m);_h.deleteRow(_m);_m-- ;}_i.addRow();_i.setColumn(_i.row,"EXPAND_YN","E");_h.set_enableevent(true);}_h.row=_d;};this.gfn_addRowToGrid=function(_b,_c){this.m2n_getObject(this.m2n_getBindDataset(_b)).addRow();_b.setCellPos(this.m2n_iif(_c==null,1,_c));_b.setFocus();};this.gfn_delRowFromGrid=function(_b){var _c=this.m2n_getObject(this.m2n_getBindDataset(_b));var _d=_c.rowposition;_c.filter("delChk==1");var _e=_c.rowcount;_c.filter("");_c.row=_d;if(_e<1){this.gfn_alert("ECI0019");}else{for(var _f=0;_f<_c.rowcount;_f++ ){if(_c.getColumn(_f,"delChk")==1){_c.deleteRow(_f);_f-- ;}}}};});this.loadIncludeScript(_a);_b=null;};})();
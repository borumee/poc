(function(){return function(_a){var _b;this.registerScript(_a,function(){this.Gv_CalendarPopDivURL="COMM::CalendarPopup.xfdl";this.Gv_CalendarPopDivX="";this.Gv_CalendarPopDivY="";this.Gv_CalendarPopDivW="";this.Gv_CalendarPopDivH="";this.Gv_rtnDate="";this.Gv_rtnDFlag="";this.Gv_CalendarPopRow=-1;this.Go_Calendar=null;this.gfn_IsPopDivCalendar=function(_b){var _c=_b.parent;if(this.m2n_isExistVar(_c,"CHK_MAKE_CALENDAR2")){return true;}else{return false;}};this.gfn_CreatePopDivCalendar=function(_b){var _c=_b.parent;this.m2n_create(_c,"PopupDiv","PopDiv_Calendar","URL="+nexacro.wrapQuote(this.Gv_CalendarPopDivURL)+' Border="Flat" BorderColor="#d0d0d0" Height="174" Width="203"');_c.m2n_addVariable("CHK_MAKE_CALENDAR2",true);};this.gfn_SetPopupDivCalendar=function(_c,_d,_e,_f,_g){this.m2n_lookupPath("Gv_objGrid")=_c;var _h=_c.parent;if(_f){_h.PopDiv_Calendar.userdata="onlyWorkingDay=true";}else{_h.PopDiv_Calendar.userdata="";}if(_g){this.Gv_rtnDFlag=true;}else{this.Gv_rtnDFlag=false;}var _i=this.m2n_getBindDataset(this.m2n_lookupPath("Gv_objGrid"));this.m2n_lookupPath("Gv_objBindDs")=this.m2n_getObject(_h,_i).id;this.m2n_lookupPath("Gv_grdRow")=_d;this.m2n_lookupPath("Gv_grdColId")=this.m2n_getColidProperty(this.m2n_lookupPath("Gv_objGrid").getCellProperty("Body",_e,"text"));var _j=this.m2n_getObject(_h,this.m2n_lookupPath("Gv_objBindDs")).getColumn(_d,this.m2n_lookupPath("Gv_grdColId"));if(this.m2n_length(_j)==0){_j=this.m2n_today();}var _k=this.m2n_getCellRect(this.m2n_lookupPath("Gv_objGrid"),_d,_e);var _l=_h.system.clientToScreenX(_c,_k[0]);var _m=_h.system.clientToScreenY(_c,_k[1]);var _n=_k[2]-_k[0];var _o=_k[3]-_k[1];if(this.gfn_IsPopDivCalendar(_c)==false){this.Gv_rtnDate=_j;this.Gv_CalendarPopDivX=_l;this.Gv_CalendarPopDivY=_m;this.Gv_CalendarPopDivW=_n;this.Gv_CalendarPopDivH=_o;this.Gv_CalendarPopRow=_d;this.gfn_CreatePopDivCalendar(_c);}else{if(this.m2n_length(_j)>0){var _p=this.m2n_mid(_j,0,4);var _q=this.m2n_mid(_j,4,2);var _r=this.m2n_mid(_j,6,2);_h.PopDiv_Calendar.Show_cal(_p,_q,_r,true);}else{this.m2n_lookupPath("PopDiv_Calendar").Show_cal("0","0","0",true);}if(_l<0){_l=0;}var _s=_h.PopDiv_Calendar.trackPopup(_l,_m,_n,_o);if(this.m2n_length(_s)>0){this.Gv_rtnDate=_s;this.m2n_getObject(_h,this.m2n_lookupPath("Gv_objBindDs")).setColumn(_d,this.m2n_lookupPath("Gv_grdColId"),_s);}}if(this.Gv_rtnDFlag){return this.Gv_rtnDate;}else{return;}};this.gfn_OnUserPopup=function(_b,_c,_d,_e){var _f=_b.parent;if(this.m2n_length(_c)>0){var _g=this.m2n_mid(_c,0,4);var _h=this.m2n_mid(_c,4,2);var _i=this.m2n_mid(_c,6,2);_f.PopDiv_Calendar.Show_cal(_g,_h,_i,true,_b);}else{_f.PopDiv_Calendar.Show_cal("0","0","0",true,_b);}_f.PopDiv_Calendar.userdata=_b.userdata;_d=_f.system.clientToScreenX(_b,0);_e=_f.system.clientToScreenY(_b,0);var _j;if(_d<0){_d=0;}_j=_f.PopDiv_Calendar.trackPopup(_d,_e,_b.getOffsetWidth(),_b.getOffsetHeight());return _j;};this.gfn_FormLoadEventProc=function(_b){for(var _c=0;_c<this.m2n_length(_b.all);_c++ ){if((this.m2n_getType(_b.all[_c])=="Dataset")||(this.m2n_getType(_b.all[_c])=="File")||(this.m2n_getType(_b.all[_c])=="FileDialog")||(this.m2n_getType(_b.all[_c])=="PopupDiv")){continue;}this.gfn_EventLink(_b.all[_c]);if(this.m2n_isComposite(_b.all[_c])){this.Gfn_SubFormEventProc(_b.all[_c]);}}};this.Gfn_SubFormEventProc=function(_b){for(var _c=0;_c<this.m2n_length(_b.all);_c++ ){if((this.m2n_getType(_b.all[_c])=="Dataset")||(this.m2n_getType(_b.all[_c])=="File")||(this.m2n_getType(_b.all[_c])=="FileDialog")||(this.m2n_getType(_b.all[_c])=="PopupDiv")){continue;}this.gfn_EventLink(_b.all[_c]);if(this.m2n_isComposite(_b.all[_c])){this.Gfn_SubFormEventProc(_b.all[_c]);}}};this.gfn_EventLink=function(_b){switch(this.m2n_toUpper(this.m2n_getType(_b))){case "CALENDAR2":case "CALENDAREX":case "CALENDAREX2":if(_b.UseUserEvent==true){if(this.gfn_IsPopDivCalendar(_b)==false){this.Go_Calendar=null;this.Gv_CalendarPopRow=-1;this.gfn_CreatePopDivCalendar(_b);}}_b.OnUserPopup="gfn_OnUserPopup";break;}};this.gfn_isWorkday=function(_c){if(this.gfn_isSunday(_c)||this.gfn_isSaturday(_c)){return false;}else{for(var _d=0;_d<nexacro.getApplication().gds_holiday.rowcount;_d++ ){if(_c==nexacro.getApplication().gds_holiday.getColumn(_d,"rdyDt")){return false;}}return true;}};this.gfn_isSunday=function(_c){return (this.m2n_getDay(_c)==0);};this.gfn_isSaturday=function(_c){return (this.m2n_getDay(_c)==6);};this.gfn_workingdayCalender_CanChange=function(_b,_c,_d){if(!this.gfn_isWorkday(_d)){this.gfn_alert("ECI0033");return false;}};this.gfn_onCharOfYearMonthComponent=function(_b,_c,_d,_e,_f,_g){var _h=this.m2n_replace(this.m2n_replace(_e,"/",""),"_","");switch(this.m2n_length(_h)){case 5:if(parseInt(this.m2n_subString(_h,4,1)>1)){return false;}break;case 6:if(parseInt(this.m2n_subString(_h,4,2))>12){return false;}break;}return true;};});this.loadIncludeScript(_a);_b=null;};})();
(function(){return function(_a){var _b;this.registerScript(_a,function(){this.sysv_openChkCob=false;this.sysv_objMultiCob="";this.sysv_objMCobDS="";this.sysv_Cobcheck="",this.sysv_CobCode="",this.sysv_CobText="";this.sysv_returnVal="";this.sysv_CheckFlag="";this.sysf_invokePDMultiCombo=function(_c,_d,_e,_f,_g,_h,_i,_j){this.sysv_objMultiCob=_c;this.sysv_objMCobDS=_d;this.sysv_Cobcheck=_e;this.sysv_CobCode=_f;this.sysv_CobText=_g;this.sysv_CheckFlag=_h;var _k=_c.getOffsetWidth();var _l=system.clientToScreenY(_c,0);var _m=system.clientToScreenX(_c,0);var _n=this.sysv_objMCobDS.getRowCount();var _o=118;var _p=118;var _q=0;if(_n<1){_p=_o-92;}else if(_n<5){_p=_o-((5-_n)* 18);}this.m2n_lookupPath("cal_Diff")=_o-_p;if(this.sysv_openChkCob==false){this.m2n_create(this,"PopDiv","PopDiv_MultiCombo",'width="100" height="'+_p+'" border="flat" OnCloseUp="_syse_MultiCombo_OnCloseUp"');this.sysv_openChkCob=true;}var _r=false;for(i=0;i<this.sysv_objMCobDS.getColCount();i++ ){if(this.sysv_objMCobDS.getColID(i)=="checked_flag"){_r=true;break;}}if(!_r){this.sysv_objMCobDS.addColumn("checked_flag");}else{for(i=0;i<this.sysv_objMCobDS.getRowCount();i++ ){this.sysv_objMCobDS.setColumn(i,"checked_flag","");}}var _s;if(this.m2n_toUpperCase(_h)=="CODE"||this.m2n_toUpperCase(_h)=="FIX"){_s=_i;}else{_s=this.sysv_objMultiCob.value;}this._sysf_checkSelectedMultiComboData(_s,_j);this.m2n_setContents(this.m2n_lookupPath("PopDiv_MultiCombo"),this.sysf_SetPopDivCob(_k,this.m2n_lookupPath("cal_Diff")));this.m2n_lookupPath("PopDiv_MultiCombo").trackPopup(_m,_l,_c.getOffsetWidth(),_c.getOffsetHeight());return this.sysv_returnVal;};this.sysf_SetPopDivCob=function(_c,_d){var _e;var _f=92;var _g=94;var _h=_f-_d;var _i=_g-_d;this.m2n_lookupPath("PopDiv_MultiCombo").setOffsetWidth(nexacro.toNumber(_c -2));this.m2n_lookupPath("PopDiv_MultiCombo").setOffsetHeight(_h+26);var _j=(nexacro.toNumber(_c -2)/2)-68;var _k='expr:iif(checked_flag=="C","#f5f5f5","white")';var _l='expr:iif(checked_flag=="C","none","checkbox")';_e+='<Contents>';_e+='	<Grid AutoFit="TRUE" BindDataset="'+this.sysv_objMCobDS.id+'" BkSelColor="#0a246a" BoldHead="true" Border="halfflat" Bottom="93" ColSelect="false" Editable="TRUE" Enable="true" EndLineColor="#919cb1" Height="'+_h+'" Id="grd_multi" InputPanel="FALSE" Left="2" MinWidth="100" Selcolor="white" TabOrder="1" TabStop="true" Top="1" UseSelColor="true" Visible="true" Width="'+nexacro.toNumber(_c -8)+'">';_e+='		<contents>';_e+='			<columns>';_e+='				<col fix="true" width="20"/>';_e+='				<col width="158"/>';_e+='			</columns>';_e+='			<body>';_e+='				<cell align="center" bkcolor='+_k+' col="0" colid="'+this.sysv_Cobcheck+'" display="checkbox" edit='+_l+'/>';_e+='				<cell col="1" bkcolor='+_k+' colid="'+this.sysv_CobText+'" display="text"/>';_e+='			</body>';_e+='		</contents>';_e+='	</Grid>';_e+=' <Div Height="20" Id="Div_cob" Left="'+_j+'" Top="'+_i+'" Width="135">';_e+='   <contents>';_e+='		<button BKColor="#5379a0" ButtonStyle="TRUE" Color="white" Height="20" Id="btn_sel" ImageID="d_4word" Left="0" OnClick="_syse_MultiCombo_OnClick" Style="btnStyle" TabOrder="2" Text="선택적용" Top="0" TopMargin="1" Width="64"></button>';_e+='		<button BKColor="#5379a0" ButtonStyle="TRUE" Color="white" Height="20" Id="btn_esc" ImageID="d_4word" Left="71" OnClick="_syse_MultiCombo_OnCancel" Style="btnStyle" TabOrder="3" Text="선택해제" Top="0" TopMargin="1" Width="64"></button>';_e+='   </contents>';_e+=' </Div>';_e+='</Contents>';return _e;};this._syse_MultiCombo_OnClick=function(){this._syse_MultiCombo_OnCloseUp();this.m2n_lookupPath("PopDiv_MultiCombo").closePopup();};this._syse_MultiCombo_OnCancel=function(){for(i=0;i<this.sysv_objMCobDS.getRowCount();i++ ){if(this.sysv_objMCobDS.getColumn(i,"checked_flag")!="C"){this.sysv_objMCobDS.setColumn(i,this.sysv_Cobcheck,"0");}}};this._syse_MultiCombo_OnCloseUp=function(){var _c="";var _d="";for(i=0;i<this.sysv_objMCobDS.getRowCount();i++ ){if(this.sysv_objMCobDS.getColumn(i,this.sysv_Cobcheck)==1){_c+=this.sysv_objMCobDS.getColumn(i,this.sysv_CobCode)+",";_d+=this.sysv_objMCobDS.getColumn(i,this.sysv_CobText)+",";}}if(this.m2n_toUpper(this.sysv_CheckFlag)=="CODE"||this.m2n_toUpper(this.sysv_CheckFlag)=="FIX"){this.sysv_objMultiCob.set_value(this.m2n_left(_d,this.m2n_length(_d)-1));this.sysv_returnVal=this.m2n_iif(this.m2n_length(_c)>0,this.m2n_left(_c,this.m2n_length(_c)-1),"");}else{this.sysv_objMultiCob.set_value(this.m2n_left(_c,this.m2n_length(_c)-1));}};this._sysf_checkSelectedMultiComboData=function(_c,_d){var _e=this.m2n_split(_c,",");var _f=this.m2n_split(_d,",");for(i=0;i<this.sysv_objMCobDS.getRowCount();i++ ){this.sysv_objMCobDS.setColumn(i,this.sysv_Cobcheck,"0");}if(this.m2n_length(_e)>0||this.m2n_length(_f)>0){for(i=0;i<this.m2n_length(_e);i++ ){for(j=0;j<this.sysv_objMCobDS.getRowCount();j++ ){if(_e[i]==this.sysv_objMCobDS.getColumn(j,this.sysv_CobCode)){this.sysv_objMCobDS.setColumn(j,this.sysv_Cobcheck,"1");}if(_f[i]==this.sysv_objMCobDS.getColumn(j,this.sysv_CobCode)){this.sysv_objMCobDS.setColumn(j,"checked_flag","C");}}}}};});this.loadIncludeScript(_a);_b=null;};})();
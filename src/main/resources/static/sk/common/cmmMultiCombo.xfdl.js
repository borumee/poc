(function(){return function(){if(!this._is_form){return;}var _a=null;this.on_create=function(){this.set_name("cmmMultiCombo");this.set_titletext("멀티콤보");this.set_scrollbartype("none none");this.set_scrolltype("none");if(Form==this.constructor){this._setFormPosition(200,29);}_a=new Dataset("dsCombo",this);_a._setContents("<ColumnInfo><Column id=\"chk\" type=\"STRING\" size=\"256\"/><Column id=\"code\" type=\"STRING\" size=\"256\"/><Column id=\"value\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Button("btnCbo",null,"0","29",null,"0","0",null,null,null,null,this);_a.set_taborder("0");_a.set_cssclass("btn_WF_Down");this.addChild(_a.name,_a);_a=new Edit("edtCbo","0","0",null,null,"28","0",null,null,null,null,this);_a.set_taborder("1");_a.set_displaynulltext("선택하세요");_a.set_readonly("true");this.addChild(_a.name,_a);_a=new PopupDiv("pdvCbo","0","29",null,"251","0",null,null,null,null,null,this);_a.set_text("pdiv00");_a.set_visible("false");this.addChild(_a.name,_a);_a=new Static("staBg","0","0",null,null,"0","0",null,null,null,null,this.pdvCbo.form);_a.set_taborder("0");_a.set_cssclass("sta_WF_GBg01");_a.set_text("");this.pdvCbo.addChild(_a.name,_a);_a=new Grid("grdMultiCombo","0","0",null,null,"0","28",null,null,null,null,this.pdvCbo.form);_a.set_taborder("1");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"48\"/><Column size=\"120\"/><Column size=\"120\"/></Columns><Rows><Row size=\"28\" band=\"head\"/><Row size=\"28\"/></Rows><Band id=\"head\"><Cell displaytype=\"checkboxcontrol\" edittype=\"checkbox\" autosizecol=\"limitmax\" text=\"0\"/><Cell col=\"1\" text=\"code\"/><Cell col=\"2\" text=\"value\"/></Band><Band id=\"body\"><Cell displaytype=\"checkboxcontrol\" edittype=\"checkbox\" autosizecol=\"limitmax\" text=\"bind:chk\"/><Cell col=\"1\" text=\"bind:code\"/><Cell col=\"2\" text=\"bind:value\"/></Band></Format></Formats>");this.pdvCbo.addChild(_a.name,_a);_a=new Button("btnOk","0",null,null,"28","0","0",null,null,null,null,this.pdvCbo.form);_a.set_taborder("2");_a.set_text("확인");this.pdvCbo.addChild(_a.name,_a);_a=new Layout("default","",0,0,this.pdvCbo.form,function(_b){});this.pdvCbo.form.addLayout(_a.name,_a);_a=new Layout("default","",200,29,this,function(_b){});_a.set_mobileorientation("landscape");this.addLayout(_a.name,_a);};this.loadPreloadList=function(){};this.registerScript("cmmMultiCombo.xfdl",function(){this.comboinnerdataset;this.combocodecolumn;this.combodatacolumn;this.headname;this.callbackfunc;this.multiCheck=true;this.displayrowcount=10;this.fvHeadHeight=28;this.fvRowHeight=28;this.fvWidth=null;this.fvAll=false;this.fvAllDisplay="";this.fvbReadOnly=false;this.fvOpenCount=0;this.form_onload=function(_a,_b){this.fvOpenCount=0;var _c=this.parent;if(this.gfnIsNull(_c.uDisplayrowcount)==false){this.displayrowcount=_c.uDisplayrowcount;}if(this.gfnIsNull(_c.uAll)==false){this.fvAll=_c.uAll;}if(this.gfnIsNull(_c.uAllDisplay)==false){this.fvAllDisplay=_c.uAllDisplay;}if(this.gfnIsNull(_c.uWidth)==false){this.fvWidth=_c.uWidth;}};this.setDataset=function(_b,_c,_d,_e,_f){this.comboinnerdataset=_b;this.combocodecolumn=_c;this.combodatacolumn=_d;this.headname=_e;this.callbackfunc=_f;if(this.headname.indexOf("chk")==-1){this.multiCheck=false;this.pdvCbo.form.grdMultiCombo.set_bottom(0);this.pdvCbo.form.btnOk.set_visible(false);}this.comboinnerdataset.set_enableevent(false);var _g=this.comboinnerdataset.getColumnInfo("chk");if(this.gfnIsNull(_g)){this.comboinnerdataset.addColumn("chk","STRING");}var _h=this.comboinnerdataset.getRowCount();for(var _l=0;_l<_h;_l++ ){if(this.fvAll){this.comboinnerdataset.setColumn(_l,"chk",1);}else{this.comboinnerdataset.setColumn(_l,"chk",0);}}this.comboinnerdataset.set_rowposition(0);this.comboinnerdataset.set_enableevent(true);var _i=this.pdvCbo.form.grdMultiCombo;_i.set_enableevent(false);_i.set_enableredraw(false);_i.setCellProperty("body",0,"text","bind:chk");_i.setCellProperty("body",1,"text","bind:"+this.combocodecolumn);_i.setCellProperty("body",2,"text","bind:"+this.combodatacolumn);if(this.multiCheck==false&&_i.getCellProperty("head",0,"displaytype")=="checkboxcontrol"){var _j=_i.deleteContentsCol("body",0);}var _k=this.headname.split(",");for(var _m=0;_m<_k.length;_m++ ){_i.setCellProperty("head",_m,"text",_k[_m]);}_i.set_binddataset(this.comboinnerdataset);_i.set_enableevent(true);_i.set_enableredraw(true);this.pdvCbo.form.resetScroll();this.fnSyncValue();};this.fnSyncValue=function(){var _b=[];var _c=[];if(this.multiCheck==false){_c.push(this.comboinnerdataset.getColumn(this.comboinnerdataset.rowposition,this.combocodecolumn));_b.push(this.comboinnerdataset.getColumn(this.comboinnerdataset.rowposition,this.combodatacolumn));this.fnSetComboText(_c,_b);return;}var _d=this.comboinnerdataset.getRowCount();var _e=this.comboinnerdataset.getCaseCount("chk=='1'");if(_d==_e){this.pdvCbo.form.grdMultiCombo.setCellProperty("head",0,"text",1);}else{this.pdvCbo.form.grdMultiCombo.setCellProperty("head",0,"text",0);}for(var _g=0;_g<_d;_g++ ){var _f=this.comboinnerdataset.getColumn(_g,"chk");if(_f=="1"){_c.push(this.comboinnerdataset.getColumn(_g,this.combocodecolumn));_b.push(this.comboinnerdataset.getColumn(_g,this.combodatacolumn));}}this.fnSetComboText(_c,_b);};this.fnSetComboText=function(_b,_c){var _d=_c.toString();this.edtCbo.uRetrunvalue=_b;this.edtCbo.uReturntext=_d;if(this.gfnIsNull(_d)){this.edtCbo.set_value(null);}else{if(this.gfnIsNull(this.fvAllDisplay)){this.edtCbo.set_value(_d);}else{if(_b.length==this.comboinnerdataset.rowcount){this.edtCbo.set_value(this.fvAllDisplay);this.resetScroll();}else{this.edtCbo.set_value(_d);}}}};this.fnInit=function(){var _b=this.comboinnerdataset;_b.set_enableevent(false);for(var _c=0;_c<_b.rowcount;_c++ ){_b.setColumn(_c,"chk","0");}_b.set_enableevent(true);this.edtCbo.set_value(null);this.edtCbo.uRetrunvalue=null;this.edtCbo.uReturntext=null;};this.setRequired=function(_b){if(_b){this.edtCbo.set_cssclass("essential");}else{this.edtCbo.set_cssclass("");}};this.setReadOnly=function(_b){this.fvbReadOnly=_b;this.btnCbo.set_enable(!_b);};this.getValue=function(){return this.edtCbo.uRetrunvalue;};this.getText=function(){return this.edtCbo.uReturntext;};this.setValue=function(_b){this.fnInit();if(this.gfnIsNull(_b)){return;}var _c;var _d=[];var _e=(""+_b).split(",");var _f=this.comboinnerdataset;_f.set_enableevent(false);for(var _g=0;_g<_e.length;_g++ ){_c=_f.findRow(this.combocodecolumn,_e[_g]);if(_c!=-1){_d.push(_f.getColumn(_c,this.combodatacolumn));_f.setColumn(_c,"chk","1");}}_f.set_enableevent(true);_f.set_rowposition(_c);this.fnSyncValue();};this.fnSelectAll=function(_b){var _c=this.comboinnerdataset;_c.set_enableevent(false);for(var _d=0;_d<_c.rowcount;_d++ ){_c.setColumn(_d,"chk",_b);}_c.set_enableevent(true);this.fnSyncValue();};this.fnOpenCombo=function(){if(this.comboinnerdataset.getRowCount()<=0){trace("멀티콤보에 표시할 Data가 없습니다. fnSetDataset으로 Dataset을 지정하세요!");return;}else{if(!this.gfnIsNull(this.fvWidth)){this.pdvCbo.set_width(this.fvWidth);}this.fnSyncValue();var _b=this.comboinnerdataset.getRowCount();var _c=this.displayrowcount;if(_c>_b){_c=_b;}var _d=this.fvHeadHeight+(this.fvRowHeight* _c)+2+30;this.pdvCbo.set_height(_d);this.pdvCbo.trackPopupByComponent(this.edtCbo,0,this.edtCbo.getOffsetHeight()-1);}};this.edtCbo_oneditclick=function(_a,_b){if(this.fvbReadOnly==false){this.fnOpenCombo();}};this.btnCbo_onclick=function(_a,_b){this.fnOpenCombo();};this.pdvCbo_grdMultiCombo_onheadclick=function(_a,_b){if(this.multiCheck==false){return;}var _c=_b.cell;if(_c==0){var _d=_a.getCellProperty("head",_c,"text");if(_d=="1"){_d="0";}else{_d="1";}this.fnSelectAll(_d);}};this.pdvCbo_grdMultiCombo_oncellclick=function(_a,_b){var _c=this.comboinnerdataset;if(this.multiCheck==false){var _d=_c.getColumn(_b.row,this.combocodecolumn);this.setValue(_d);this.pdvCbo.closePopup();}else{if(_b.cell>0){if(_c.getColumn(_b.row,"chk")=="1"){_c.setColumn(_b.row,"chk","0");}else{_c.setColumn(_b.row,"chk","1");}}this.fnSyncValue();}};this.pdvCbo_oncloseup=function(_a,_b){this.fnSyncValue();if(!this.gfnIsNull(this.callbackfunc)){this.lookupFunc(this.callbackfunc).call(this.parent.name,this.edtCbo.uRetrunvalue,this.edtCbo.uReturntext);}};this.pdvCbo_btnOk_onclick=function(_a,_b){this.pdvCbo.closePopup();this.edtCbo.setFocus();};});this.on_initEvent=function(){this.addEventHandler("onload",this.form_onload,this);this.btnCbo.addEventHandler("onclick",this.btnCbo_onclick,this);this.edtCbo.addEventHandler("oneditclick",this.edtCbo_oneditclick,this);this.pdvCbo.addEventHandler("oncloseup",this.pdvCbo_oncloseup,this);this.pdvCbo.form.grdMultiCombo.addEventHandler("onheadclick",this.pdvCbo_grdMultiCombo_onheadclick,this);this.pdvCbo.form.grdMultiCombo.addEventHandler("oncellclick",this.pdvCbo_grdMultiCombo_oncellclick,this);this.pdvCbo.form.btnOk.addEventHandler("onclick",this.pdvCbo_btnOk_onclick,this);};this.loadIncludeScript("cmmMultiCombo.xfdl");this.loadPreloadList();_a=null;};})();
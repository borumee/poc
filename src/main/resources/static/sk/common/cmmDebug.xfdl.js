(function(){return function(){if(!this._is_form){return;}var _a=null;this.on_create=function(){this.set_name("cmmDebug");this.set_titletext("디버그");if(Form==this.constructor){this._setFormPosition(900,500);}_a=new Dataset("dsDataset",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"PATH\" type=\"STRING\" size=\"256\"/><Column id=\"NAME\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsGDS",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"PATH\" type=\"STRING\" size=\"256\"/><Column id=\"NAME\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsGrid",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"PATH\" type=\"STRING\" size=\"256\"/><Column id=\"NAME\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsGridDataset",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("");this.addChild(_a.name,_a);_a=new Dataset("dsComponents",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("true");_a._setContents("<ColumnInfo><Column id=\"PATH\" type=\"STRING\" size=\"256\"/><Column id=\"NAME\" type=\"STRING\" size=\"256\"/><Column id=\"taborder\" type=\"INT\" size=\"256\"/><Column id=\"accessibilityenable\" type=\"STRING\" size=\"256\"/><Column id=\"visible\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsProperties",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"NAME\" type=\"STRING\" size=\"256\"/><Column id=\"VALUE\" type=\"STRING\" size=\"256\"/><Column id=\"FUNCTION\" type=\"STRING\" size=\"256\"/><Column id=\"COLOR\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsVariableType",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"CODE\" type=\"STRING\" size=\"256\"/><Column id=\"NAME\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"CODE\">FORM</Col><Col id=\"NAME\">Form</Col></Row><Row><Col id=\"CODE\">GLOBAL</Col><Col id=\"NAME\">Global</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("dsVariable",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"NAME\" type=\"STRING\" size=\"256\"/><Column id=\"VALUE\" type=\"STRING\" size=\"256\"/><Column id=\"TYPE\" type=\"STRING\" size=\"256\"/><Column id=\"LVL\" type=\"INT\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsDatasetView",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"NAME\" type=\"STRING\" size=\"256\"/><Column id=\"VALUE\" type=\"STRING\" size=\"256\"/><Column id=\"TYPE\" type=\"STRING\" size=\"256\"/><Column id=\"LVL\" type=\"INT\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Div("divSearch","0","0",null,"121","0",null,null,null,null,null,this);_a.set_taborder("0");_a.set_cssclass("div_WF_Search");_a.set_text("");_a.set_formscrolltype("none");_a.set_formscrollbartype("none none");this.addChild(_a.name,_a);_a=new Static("staTitle00","0","12","98","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("0");_a.set_text("LOCAL");_a.set_cssclass("sta_WF_SchLabel");this.divSearch.addChild(_a.name,_a);_a=new Combo("Combo01","56","-158","185","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("1");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");_a.set_readonly("false");var _b=new nexacro.NormalDataset("divSearch_form_Combo01_innerdataset",_a);_b._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\">1</Col><Col id=\"datacolumn\">전체</Col></Row><Row><Col id=\"codecolumn\">2</Col><Col id=\"datacolumn\">사용</Col></Row><Row><Col id=\"codecolumn\">3</Col><Col id=\"datacolumn\">미사용</Col></Row></Rows>");_a.set_innerdataset(_b);_a.set_text("전체");_a.set_value("1");_a.set_index("0");this.divSearch.addChild(_a.name,_a);_a=new Combo("Combo02","282","-158","185","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("2");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");_a.set_readonly("false");var _c=new nexacro.NormalDataset("divSearch_form_Combo02_innerdataset",_a);_c._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\">1</Col><Col id=\"datacolumn\">전체</Col></Row><Row><Col id=\"codecolumn\">2</Col><Col id=\"datacolumn\">사용</Col></Row><Row><Col id=\"codecolumn\">3</Col><Col id=\"datacolumn\">미사용</Col></Row></Rows>");_a.set_innerdataset(_c);_a.set_text("전체");_a.set_value("1");_a.set_index("0");this.divSearch.addChild(_a.name,_a);_a=new Combo("Combo03","521","-158","184","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("3");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");_a.set_readonly("false");var _d=new nexacro.NormalDataset("divSearch_form_Combo03_innerdataset",_a);_d._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\">1</Col><Col id=\"datacolumn\">전체</Col></Row><Row><Col id=\"codecolumn\">2</Col><Col id=\"datacolumn\">사용</Col></Row><Row><Col id=\"codecolumn\">3</Col><Col id=\"datacolumn\">미사용</Col></Row></Rows>");_a.set_innerdataset(_d);_a.set_text("전체");_a.set_value("1");_a.set_index("0");this.divSearch.addChild(_a.name,_a);_a=new Calendar("Calendar00","785","-158","184","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("4");_a.set_value("20190308");_a.set_dateformat("yyyy-MM-dd ddd");_a.set_readonly("false");this.divSearch.addChild(_a.name,_a);_a=new Static("staTitle01","0","staTitle00:5","98","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("5");_a.set_text("GLOBAL");_a.set_cssclass("sta_WF_SchLabel");this.divSearch.addChild(_a.name,_a);_a=new Combo("cboDataset","staTitle00:0","12","330","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("6");_a.set_innerdataset("dsDataset");_a.set_codecolumn("PATH");_a.set_datacolumn("NAME");_a.set_displayrowcount("25");this.divSearch.addChild(_a.name,_a);_a=new Combo("cboGDS","staTitle01:0","45","330","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("7");_a.set_innerdataset("dsGDS");_a.set_codecolumn("PATH");_a.set_datacolumn("NAME");_a.set_displayrowcount("25");this.divSearch.addChild(_a.name,_a);_a=new Button("btnLocalFilter","cboDataset:-1","12","85","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("8");_a.set_text("필터해제");this.divSearch.addChild(_a.name,_a);_a=new Button("cbtnGlobalFilter","cboGDS:-1","45","85","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("9");_a.set_text("필터해제");this.divSearch.addChild(_a.name,_a);_a=new Edit("edtLocal","btnLocalFilter:-1","12",null,"28","20",null,null,null,null,null,this.divSearch.form);_a.set_taborder("10");this.divSearch.addChild(_a.name,_a);_a=new Static("staTitle02","0","staTitle01:5","98","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("11");_a.set_text("GRID");_a.set_cssclass("sta_WF_SchLabel");this.divSearch.addChild(_a.name,_a);_a=new Edit("edtGlobal","cbtnGlobalFilter:-1","45",null,"28","20",null,null,null,null,null,this.divSearch.form);_a.set_taborder("13");this.divSearch.addChild(_a.name,_a);_a=new Combo("cboGrid","staTitle02:0","edtGlobal:5",null,"28","20",null,null,null,null,null,this.divSearch.form);_a.set_taborder("12");_a.set_innerdataset("dsGrid");_a.set_codecolumn("PATH");_a.set_datacolumn("NAME");_a.set_text("cbo00");this.divSearch.addChild(_a.name,_a);_a=new Tab("tabComponent","0","divSearch:15",null,null,"0","0",null,null,null,null,this);_a.set_taborder("1");_a.set_tabindex("0");_a.getSetter("scrollbars").set("autoboth");this.addChild(_a.name,_a);_a=new Tabpage("tabpage1",this.tabComponent);_a.set_text("Dataset");this.tabComponent.addChild(_a.name,_a);_a=new Button("btnCreatSQL",null,"5","74","28","0",null,null,null,null,null,this.tabComponent.tabpage1.form);_a.set_taborder("0");_a.set_text("SQL 생성");this.tabComponent.tabpage1.addChild(_a.name,_a);_a=new Button("btnSaveExcel",null,"5","78","28","btnCreatSQL:5",null,null,null,null,null,this.tabComponent.tabpage1.form);_a.set_taborder("1");_a.set_text("Excel 저장");this.tabComponent.tabpage1.addChild(_a.name,_a);_a=new Grid("grdDataset","0","38",null,null,"0","0",null,null,null,null,this.tabComponent.tabpage1.form);_a.set_taborder("2");_a.getSetter("useinputpanel").set("false");_a.set_binddataset("dsGridDataset");_a.set_cellsizingtype("col");_a.set_autoenter("select");_a._setContents("<Formats/>");this.tabComponent.tabpage1.addChild(_a.name,_a);_a=new Tabpage("tabpage2",this.tabComponent);_a.set_text("SaveXML");this.tabComponent.addChild(_a.name,_a);_a=new TextArea("txtSaveXML","0","10",null,null,"0","0",null,null,null,null,this.tabComponent.tabpage2.form);_a.set_taborder("0");this.tabComponent.tabpage2.addChild(_a.name,_a);_a=new Tabpage("tabpage3",this.tabComponent);_a.set_text("Dataset To Grid");this.tabComponent.addChild(_a.name,_a);_a=new TextArea("txtSetGrid","0","10",null,null,"0","0",null,null,null,null,this.tabComponent.tabpage3.form);_a.set_taborder("0");this.tabComponent.tabpage3.addChild(_a.name,_a);_a=new Tabpage("tabpage4",this.tabComponent);_a.set_text("Grid Format");this.tabComponent.addChild(_a.name,_a);_a=new TextArea("txtGridFormat","0","10",null,null,"0","0",null,null,null,null,this.tabComponent.tabpage4.form);_a.set_taborder("0");this.tabComponent.tabpage4.addChild(_a.name,_a);_a=new Tabpage("tabpage5",this.tabComponent);_a.set_text("Components");this.tabComponent.addChild(_a.name,_a);_a=new Grid("grdProperties00","0","10","50%",null,null,"0",null,null,null,null,this.tabComponent.tabpage5.form);_a.set_taborder("0");_a.getSetter("useinputpanel").set("false");_a.set_binddataset("dsComponents");_a.set_cellsizingtype("col");_a.set_cellmovingtype("none");_a.set_selecttype("row");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"162\"/><Column size=\"105\"/><Column size=\"51\"/><Column size=\"55\"/><Column size=\"48\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell text=\"PATH\"/><Cell col=\"1\" text=\"NAME\"/><Cell col=\"2\" text=\"taborder\"/><Cell col=\"3\" text=\"access\"/><Cell col=\"4\" text=\"visible\"/></Band><Band id=\"body\"><Cell text=\"bind:PATH\" textAlign=\"left\"/><Cell col=\"1\" text=\"bind:NAME\" textAlign=\"left\"/><Cell col=\"2\" text=\"bind:taborder\"/><Cell col=\"3\" text=\"bind:accessibilityenable\"/><Cell col=\"4\" text=\"bind:visible\"/></Band></Format></Formats>");this.tabComponent.tabpage5.addChild(_a.name,_a);_a=new Grid("grdProperties","grdProperties00:5","10","277",null,null,"0",null,null,null,null,this.tabComponent.tabpage5.form);_a.set_taborder("1");_a.getSetter("useinputpanel").set("false");_a.set_binddataset("dsProperties");_a.set_cellsizingtype("col");_a.set_cellmovingtype("col");_a.set_autofittype("col");_a.set_selecttype("row");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"178\"/><Column size=\"186\"/></Columns><Rows><Row size=\"24\" band=\"head\"/><Row size=\"24\"/></Rows><Band id=\"head\"><Cell text=\"Properties Name\"/><Cell col=\"1\" text=\"Value\"/></Band><Band id=\"body\"><Cell style=\"align:left;\" text=\"bind:NAME\" textAlign=\"left\"/><Cell col=\"1\" edittype=\"normal\" style=\"align:left;\" text=\"bind:VALUE\" textAlign=\"left\"/></Band></Format></Formats>");this.tabComponent.tabpage5.addChild(_a.name,_a);_a=new TextArea("txtScript","grdProperties:5","10",null,null,"0","0",null,null,null,null,this.tabComponent.tabpage5.form);_a.set_taborder("2");this.tabComponent.tabpage5.addChild(_a.name,_a);_a=new Tabpage("tabpage6",this.tabComponent);_a.set_text("Variable");this.tabComponent.addChild(_a.name,_a);_a=new Grid("grdVariable","1","38",null,null,"1","5",null,null,null,null,this.tabComponent.tabpage6.form);_a.set_taborder("0");_a.getSetter("useinputpanel").set("false");_a.set_binddataset("dsVariable");_a.set_cellsizingtype("col");_a.set_cellmovingtype("col");_a.set_autofittype("col");_a.set_selecttype("area");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"451\"/><Column size=\"926\"/></Columns><Rows><Row size=\"31\" band=\"head\"/><Row size=\"31\"/></Rows><Band id=\"head\"><Cell text=\"Variable Name\"/><Cell col=\"1\" text=\"Value\"/></Band><Band id=\"body\"><Cell style=\"align:left;color:BIND(COLOR);color2:BIND(COLOR);\" text=\"bind:NAME\" textAlign=\"left\"/><Cell col=\"1\" edittype=\"normal\" style=\"align:left;color:BIND(COLOR);color2:BIND(COLOR);\" text=\"bind:VALUE\" textAlign=\"left\"/></Band></Format></Formats>");this.tabComponent.tabpage6.addChild(_a.name,_a);_a=new Static("Static00","0","6","110","28",null,null,null,null,null,null,this.tabComponent.tabpage6.form);_a.set_text("Variable Type");_a.set_taborder("1");_a.set_cssclass("sta_WF_SchLabel");this.tabComponent.tabpage6.addChild(_a.name,_a);_a=new Combo("cboVariable","Static00:0","5","136","28",null,null,null,null,null,null,this.tabComponent.tabpage6.form);_a.set_taborder("2");_a.set_innerdataset("dsVariableType");_a.set_codecolumn("CODE");_a.set_datacolumn("NAME");_a.set_text("Local");_a.set_value("FORM");_a.set_index("0");this.tabComponent.tabpage6.addChild(_a.name,_a);_a=new Tabpage("tabpage7",this.tabComponent);_a.set_text("Run Script");this.tabComponent.addChild(_a.name,_a);_a=new TextArea("txtScript","0","38",null,null,"0","47",null,null,null,null,this.tabComponent.tabpage7.form);_a.set_taborder("0");_a.set_value("//디버그 실행 예제\n//alert(this.opener.dsList.saveXML());");this.tabComponent.tabpage7.addChild(_a.name,_a);_a=new Button("btnRunScript",null,"5","104","28","0",null,null,null,null,null,this.tabComponent.tabpage7.form);_a.set_taborder("1");_a.set_text("Run Script");this.tabComponent.tabpage7.addChild(_a.name,_a);_a=new TextArea("txtResult","0",null,null,"39","0","0",null,null,null,null,this.tabComponent.tabpage7.form);_a.set_taborder("2");_a.set_readonly("true");this.tabComponent.tabpage7.addChild(_a.name,_a);_a=new Layout("default","",0,0,this.divSearch.form,function(_e){});this.divSearch.form.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.tabComponent.tabpage1.form,function(_e){});this.tabComponent.tabpage1.form.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.tabComponent.tabpage2.form,function(_e){});this.tabComponent.tabpage2.form.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.tabComponent.tabpage3.form,function(_e){});this.tabComponent.tabpage3.form.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.tabComponent.tabpage4.form,function(_e){});this.tabComponent.tabpage4.form.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.tabComponent.tabpage5.form,function(_e){});this.tabComponent.tabpage5.form.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.tabComponent.tabpage6.form,function(_e){});this.tabComponent.tabpage6.form.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.tabComponent.tabpage7.form,function(_e){});this.tabComponent.tabpage7.form.addLayout(_a.name,_a);_a=new Layout("default","",900,500,this,function(_e){});_a.set_mobileorientation("landscape");this.addLayout(_a.name,_a);_a=new BindItem("item0","tabComponent.tabpage5.form.txtScript","value","dsProperties","FUNCTION");this.addChild(_a.name,_a);_a.bind();};this.loadPreloadList=function(){};this.registerScript("cmmDebug.xfdl",function(){this.fvCurrentCombo="";this.objApp=null;this.objEnv=null;this.form_onload=function(_a,_b){this.gfnFormOnload(_a,_b);this.objApp=nexacro.getApplication();this.objEnv=nexacro.getEnvironment();this.fvCurrentCombo="cboDataset";this.fnSaveDatasetList(this.opener);this.divSearch.form.cboDataset.set_index(0);this.fnMakeDatasetGrid();this.fnSaveGDSList();this.dsGDS.set_keystring("S:NAME");this.fnSaveGridList(this.opener);this.divSearch.form.cboGrid.set_index(0);this.fnSaveComponetsList(this.opener);this.dsComponents.set_keystring("S:PATH+taborder");this.dsComponents.set_rowposition(0);this.dsVariable.clearData();this.fnSaveVariableList(this.opener);this.fnSaveGlobalVariableList();this.dsVariable.set_keystring("S:LVL+NAME");};this.fnSaveDatasetList=function(_b,_c){var _d=_b.objects;for(var _j=0;_j<_d.length;_j++ ){if(_d[_j]+""=="[object Dataset]"){var _e=this.dsDataset.addRow();this.dsDataset.setColumn(_e,"NAME",_d[_j].id);if(this.gfnIsNull(_c)){this.dsDataset.setColumn(_e,"PATH",_d[_j].id);}else{var _f=_c+"."+_d[_j].id;this.dsDataset.setColumn(_e,"NAME",_f);this.dsDataset.setColumn(_e,"PATH",_c+"."+_d[_j].id);}}}var _g=_b.components;var _h;for(var _j=0;_j<_g.length;_j++ ){_h=_g[_j]+"";if(_h=="[object Div]"){if(this.gfnIsNull(_c)){this.fnSaveDatasetList(_g[_j].form,_g[_j].id+".form");}else{this.fnSaveDatasetList(_g[_j].form,_c+"."+_g[_j].id+".form");}}else if(_h=="[object Tab]"){var _i=_g[_j].tabpages;for(var _k=0;_k<_i.length;_k++ ){if(this.gfnIsNull(_c)){this.fnSaveDatasetList(_i[_k].form,_g[_j].id+"."+_i[_k].id+".form");}else{this.fnSaveDatasetList(_i[_k].form,_c+"."+_g[_j].id+"."+_i[_k].id+".form");}}}}};this.fnSaveGridList=function(_b,_c){var _d;var _e=_b.components;for(var _i=0;_i<_e.length;_i++ ){_d=_e[_i]+"";if(_e[_i]+""=="[object Grid]"){var _f=this.dsGrid.addRow();var _g=this.gfnIsNull(_c)?_e[_i].name:_c+"."+_e[_i].name;this.dsGrid.setColumn(_f,"NAME",_g);if(this.gfnIsNull(_c)){this.dsGrid.setColumn(_f,"PATH",_e[_i].name);}else{this.dsGrid.setColumn(_f,"PATH",_c+"."+_e[_i].name);}}if(_d=="[object Div]"){if(this.gfnIsNull(_c)){this.fnSaveGridList(_e[_i].form,_e[_i].name+".form");}else{this.fnSaveGridList(_e[_i].form,_c+"."+_e[_i].name+".form");}}if(_d=="[object PopupDiv]"){if(this.gfnIsNull(_c)){this.fnSaveGridList(_e[_i].form,_e[_i].name+".form");}else{this.fnSaveGridList(_e[_i].form,_c+"."+_e[_i].name+".form");}}else if(_d=="[object Tab]"){var _h=_e[_i].tabpages;for(var _j=0;_j<_h.length;_j++ ){if(this.gfnIsNull(_c)){this.fnSaveGridList(_h[_j].form,_e[_i].name+"."+_h[_j].name+".form");}else{this.fnSaveGridList(_h[_j].form,_c+"."+_e[_i].name+"."+_h[_j].name+".form");}}}}};this.fnSaveComponetsList=function(_b,_c){var _d;var _e=_b.components;for(var _h=0;_h<_e.length;_h++ ){_d=_e[_h]+"";if(_d=="[object Div]"){if(this.gfnIsNull(_c)){this.fnSaveComponetsList(_e[_h].form,_e[_h].name+".form");}else{this.fnSaveComponetsList(_e[_h].form,_c+"."+_e[_h].name+".form");}}if(_d=="[object PopupDiv]"){if(this.gfnIsNull(_c)){this.fnSaveComponetsList(_e[_h].form,_e[_h].name+".form");}else{this.fnSaveComponetsList(_e[_h].form,_c+"."+_e[_h].name+".form");}}else if(_d=="[object Tab]"){var _f=this.dsComponents.addRow();this.dsComponents.setColumn(_f,"PATH",_c);this.dsComponents.setColumn(_f,"NAME",_e[_h].name);this.dsComponents.setColumn(_f,"taborder",_e[_h].taborder);this.dsComponents.setColumn(_f,"accessibilityenable",_e[_h].accessibilityenable);this.dsComponents.setColumn(_f,"visible",_e[_h].visible);var _g=_e[_h].tabpages;for(var _i=0;_i<_g.length;_i++ ){var _f=this.dsComponents.addRow();this.dsComponents.setColumn(_f,"PATH",_e[_h].name);this.dsComponents.setColumn(_f,"NAME",_g[_i].name);this.dsComponents.setColumn(_f,"taborder",_g[_i].taborder);this.dsComponents.setColumn(_f,"accessibilityenable",_g[_i].accessibilityenable);this.dsComponents.setColumn(_f,"visible",_g[_i].visible);if(this.gfnIsNull(_c)){this.fnSaveComponetsList(_g[_i].form,_e[_h].name+"."+_g[_i].name+".form");}else{this.fnSaveComponetsList(_g[_i].form,_c+"."+_e[_h].name+"."+_g[_i].name+".form");}}}else{if(!this.gfnIsNull(_c)){var _f=this.dsComponents.addRow();this.dsComponents.setColumn(_f,"PATH",_c);this.dsComponents.setColumn(_f,"NAME",_e[_h].name);this.dsComponents.setColumn(_f,"taborder",_e[_h].taborder);this.dsComponents.setColumn(_f,"accessibilityenable",_e[_h].accessibilityenable);this.dsComponents.setColumn(_f,"visible",_e[_h].visible);}else{var _f=this.dsComponents.addRow();this.dsComponents.setColumn(_f,"PATH","");this.dsComponents.setColumn(_f,"NAME",_e[_h].name);this.dsComponents.setColumn(_f,"taborder",_e[_h].taborder);this.dsComponents.setColumn(_f,"accessibilityenable",_e[_h].accessibilityenable);this.dsComponents.setColumn(_f,"visible",_e[_h].visible);}}}};this.fnSaveGDSList=function(){var _b=this.objApp.all;for(var _d=0;_d<_b.length;_d++ ){if(_b[_d]+""=="[object Dataset]"){try{if(_b[_d].id.indexOf(".")==-1){var _c=this.dsGDS.addRow();this.dsGDS.setColumn(_c,"NAME",_b[_d].id);this.dsGDS.setColumn(_c,"PATH",_b[_d].id);}}catch(e){trace(">>>> e Message"+e);}}}};this.fnMakeDatasetGrid=function(){var dataset;if(this.fvCurrentCombo=="cboDataset"){if(this.divSearch.form.cboDataset.index==-1){return;}dataset=eval("this.opener."+this.divSearch.form.cboDataset.value);}else{if(this.divSearch.form.cboGDS.index==-1){return;}dataset=this.objApp[this.divSearch.form.cboGDS.text];}this.dsDatasetView.assign(dataset);if(dataset.getColCount()<1){var formats="";formats+='<Formats>\n';formats+='<Format id="default">\n';formats+='<Columns></Columns>\n';formats+='<Rows><Row size="31" band="head" /><Row size="31" /></Rows>\n';formats+='<Band id="head"></Band>\n';formats+='<Band id="body"></Band>\n';formats+='</Format>\n';formats+='</Formats>';this.tabComponent.tabpage1.form.grdDataset.set_formats(formats);return;}var columns='    <Column size="30" />\n';var head='    <Cell col="0" text=""/>\n';var body='    <Cell col="0" displaytype="normal" text="expr:(dataset.getRowType(currow)==2)?\'I\':(dataset.getRowType(currow)==4)?\'M\':(dataset.getRowType(currow)==8)?\'\':\'\'"/>\n';for(var i=0;i<dataset.getColCount();i++ ){var columinfo=dataset.getColumnInfo(i);var columname="";var columsize="";var columtype="";try{columname=columinfo.name;columsize=parseInt(columinfo.size);columtype=columinfo.type.toUpperCase();}catch(e){columname="undefined";columsize=50;columtype="STRING";}var align="";if(columtype=="STRING"){columsize=columsize* 9;if(columsize<columname.length* 9){columsize=columname.length* 9;}if(columsize>200){columns+='    <Column size="200" />\n';}else{columns+='    <Column size="'+columsize+'" />\n';}align='textAlign="left"';}else if(columtype=="INT"){columns+='<Column size="80" />\n';align='textAlign="right"';}else if(columtype=="FLOAT"){columns+='<Column size="80" />\n';align='textAlign="right;"';}else if(columtype=="DATE"){columns+='<Column size="88" />\n';align='textAlign="center"';}else if(columtype=="TIME"){columns+='<Column size="88" />\n';align='textAlign="center"';}else if(columtype=="DATETIME"){columns+='<Column size="120" />\n';align='textAlign="center"';}else if(columtype=="BIGDECIMAL"){columns+='<Column size="120" />\n';align='textAlign="right"';}else{columns+='<Column size="120" />\n';align='textAlign="left"';}head+='    <Cell col="'+(i+1)+'" text="'+columname+'"/>\n';body+='    <Cell col="'+(i+1)+'" '+align+' text="bind:'+columname+'" displaytype="normal" edittype="normal"/>\n';}var formats="";formats+='<Formats>\n';formats+='<Format id="default">\n';formats+='<Columns>\n'+columns.substring(0,columns.length-1)+'\n</Columns>\n';formats+='<Rows>\n    <Row size="31" band="head" />\n    <Row size="31" />\n</Rows>\n';formats+='<Band id="head">\n'+head.substring(0,head.length-1)+'\n</Band>\n';formats+='<Band id="body">\n'+body.substring(0,body.length-1)+'\n</Band>\n';formats+='</Format>\n';formats+='</Formats>';if(system.navigatorname=="nexacro"){this.tabComponent.tabpage1.form.grdDataset.set_binddataset(dataset);}else{this.tabComponent.tabpage1.form.grdDataset.set_binddataset(this.dsDatasetView);}this.tabComponent.tabpage1.form.grdDataset.set_formats(formats);};this.fnMakeDatasetXml=function(){var dataset;if(this.fvCurrentCombo=="cboDataset"){if(this.divSearch.form.cboDataset.index==-1){return;}dataset=eval("this.opener."+this.divSearch.form.cboDataset.value);}else{if(this.divSearch.form.cboGDS.index==-1){return;}dataset=this.objApp[this.divSearch.form.cboGDS.text];}var text=nexacro.replaceAll(dataset.saveXML(),'<Dataset id="'+dataset.id+'">','');text=nexacro.replaceAll(text,'</Dataset>','');this.tabComponent.tabpage2.form.txtSaveXML.set_value(text);};this.fnMakeDatasetGridFormat=function(){this.tabComponent.tabpage3.form.txtSetGrid.set_value(this.tabComponent.tabpage1.form.grdDataset.formats);};this.fnMakeGridFormats=function(){if(this.divSearch.form.cboGrid.index==-1){return;}var targetgrid=eval("this.opener."+this.divSearch.form.cboGrid.value);var formats=nexacro.replaceAll(targetgrid.formats,"><",">\n<");formats=nexacro.replaceAll(formats,"<Column ","    <Column ");formats=nexacro.replaceAll(formats,"<Cell ","    <Cell ");formats=nexacro.replaceAll(formats,"<Row ","    <Row ");var newcolumn="";for(var i=0;i<targetgrid.getCellCount("Body");i++ ){newcolumn+='    <Column size="'+targetgrid.getRealColSize(i,true)+'"/>\n';}formats=formats.split("<Columns>")[0]+"<Columns>\n"+newcolumn+"</Columns>"+formats.split("</Columns>")[1];this.tabComponent.tabpage4.form.txtGridFormat.set_value(formats);this.tabComponent.set_tabindex(3);};this.fnMakeCompoentsData=function(){if(this.dsComponents.rowposition==-1){return;}var sPath=this.dsComponents.getColumn(this.dsComponents.rowposition,"PATH");var sName=this.dsComponents.getColumn(this.dsComponents.rowposition,"NAME");var sCompName="";if(this.gfnIsNull(sPath)){sCompName=sName;}else{sCompName=sPath+"."+sName;}var targetobj=eval("this.opener."+sCompName);this.dsProperties.clearData();this.dsProperties.set_enableevent(false);for(var name in targetobj){var value=targetobj[name]+"";if(name[0]=="_"){continue;}if(value=="[object Object]"){continue;}if(value.substring(0,8)=="function"){continue;}if(value.substring(0,7)=="control"){continue;}if(this.gfnIsNull(value)){var nrow=this.dsProperties.addRow();this.dsProperties.setColumn(nrow,"NAME",name);this.dsProperties.setColumn(nrow,"VALUE","");}else{if(value.indexOf("[object")!=-1){if(value.indexOf("EventListener")!=-1){var eventhandler=targetobj.getEventHandler(name,0);if(!this.gfnIsNull(eventhandler)){var nrow=this.dsProperties.addRow();this.dsProperties.setColumn(nrow,"NAME",name);this.dsProperties.setColumn(nrow,"VALUE","function");this.dsProperties.setColumn(nrow,"FUNCTION",eventhandler);this.dsProperties.setColumn(nrow,"COLOR","red");}}}else{var nrow=this.dsProperties.addRow();this.dsProperties.setColumn(nrow,"NAME",name);this.dsProperties.setColumn(nrow,"VALUE",value);}}}this.dsProperties.set_enableevent(true);this.dsProperties.set_rowposition(0);};this.fnSaveVariableList=function(_b,_c){var _d=_b+"";this.dsVariable.set_enableevent(false);for(var _k in _b){var _e=_k.substr(0,2).toUpperCase();if(_e=="FV"){var _f=_b[_k]+"";if(_f.indexOf("[object")!=-1){continue;}if(_f.substring(0,8)=="function"){continue;}if(!_b.hasOwnProperty(_k)){continue;}var _g=this.dsVariable.addRow();var _h=this.gfnIsNull(_c)?"this."+_k:_c+"."+_k;this.dsVariable.setColumn(_g,"NAME",_h);this.dsVariable.setColumn(_g,"VALUE",_f);this.dsVariable.setColumn(_g,"TYPE","FORM");this.dsVariable.setColumn(_g,"LVL",_k.split(".").length);}}this.dsVariable.set_enableevent(true);_d="";var _i=_b.components;for(var _l=0;_l<_i.length;_l++ ){_d=_i[_l]+"";if(_d=="[object Div]"){if(this.gfnIsNull(_c)){this.fnSaveVariableList(_i[_l].form,_i[_l].name+".form");}else{this.fnSaveVariableList(_i[_l].form,_c+"."+_i[_l].name+".form");}}else if(_d=="[object Tab]"){var _j=_i[_l].tabpages;for(var _m=0;_m<_j.length;_m++ ){if(this.gfnIsNull(_c)){this.fnSaveVariableList(_j[_m].form,_i[_l].name+"."+_j[_m].name+".form");}else{this.fnSaveVariableList(_j[_m].form,_c+"."+_i[_l].name+"."+_j[_m].name+".form");}}}}};this.fnSaveGlobalVariableList=function(){this.dsVariable.set_enableevent(false);var _b=this.objApp;for(var _f in _b){var _c=_f.substr(0,2).toUpperCase();if(_c=="GV"){var _d=_b[_f]+"";if(_d.indexOf("[object")!=-1){continue;}if(_d.substring(0,8)=="function"){continue;}if(!_b.hasOwnProperty(_f)){continue;}if(this.dsVariable.findRow("NAME",_f)==-1){var _e=this.dsVariable.addRow();this.dsVariable.setColumn(_e,"NAME",_f);this.dsVariable.setColumn(_e,"VALUE",_d);this.dsVariable.setColumn(_e,"TYPE","GLOBAL");this.dsVariable.setColumn(_e,"LVL",0);}}}this.dsVariable.set_enableevent(true);};this.fnMakeVariableList=function(){this.dsVariable.filter("TYPE == '"+this.tabComponent.tabpage6.form.cboVariable.value+"'");this.dsVariable.set_rowposition(0);};this.fnExecScript=function(obj,e){try{var result=eval(this.tabComponent.tabpage7.form.txtScript.text);if(this.gfnIsNull(result)){result="";}this.tabComponent.tabpage7.form.txtResult.set_value("★★★ 성공 : "+result);}catch(ex){this.tabComponent.tabpage7.form.txtResult.set_value("＠＠＠ 실패 : "+ex);}};this.tabComponent_onchanged=function(_a,_b){var _c=this.tabComponent.tabindex;switch(_c){case 0:this.fnMakeDatasetGrid();break;case 1:this.fnMakeDatasetXml();break;case 2:this.fnMakeDatasetGridFormat();break;case 3:this.fnMakeGridFormats();break;case 4:this.fnMakeCompoentsData();break;case 5:this.fnMakeVariableList();break;default:break;}};this.divSearch.form.cboDataset_onitemchanged=function(_a,_b){this.fvCurrentCombo=_a.name;this.divSearch.form.edtLocal.set_value(_a.text);this.divSearch.form.edtGlobal.set_value("");this.tabComponent.set_tabindex(0);this.tabComponent_onchanged();};this.divSearch.form.cboGDS_onitemchanged=function(_a,_b){this.fvCurrentCombo=_a.name;this.divSearch.form.edtGlobal.set_value(_a.value);this.divSearch.form.edtLocal.set_value("");this.tabComponent.set_tabindex(0);this.tabComponent_onchanged();};this.tabComponent_tabpage6_cboVariable_onitemchanged=function(_a,_b){this.dsVariable.filter("TYPE == '"+this.tabComponent.tabpage6.form.cboVariable.value+"'");this.dsVariable.set_rowposition(0);};this.divSearch.form.edtLocal_onkeydown=function(_a,_b){if(_b.keycode==13){var _c=this.dsDataset.findRow("NAME",_a.value);if(_c!=-1){fvCurrentCombo="local";this.divSearch.form.cboDataset.set_index(_c);this.fnMakeDatasetGrid();this.divSearch.form.cboDataset_onitemchanged(this.divSearch.form.cboDataset);}}};this.divSearch.form.edtGlobal_onkeydown=function(_a,_b){if(_b.keycode==13){var _c=this.dsGDS.findRow("NAME",_a.value);if(_c!=-1){fvCurrentCombo="global";this.divSearch.form.cboGDS.set_index(_c);this.divSearch.form.cboGDS_onitemchanged(this.divSearch.form.cboGDS);}}};this.btnCreatSQL_onclick=function(_a,_b){var _c="";var _d=this.tabComponent.tabpage1.form.grdDataset.getBindDataset();for(var _i=0;_i<_d.getRowCount();_i++ ){var _e="";var _f="";for(var _j=0;_j<_d.getColCount();_j++ ){var _g=_d.getColID(_j);var _h=this.gfnNvl(_d.getColumn(_i,_g),"NULL");if(_h!="NULL"){_h="'"+_h+"'";}if(_j==0){_e=_g;_f=_h;}else{_e+=", "+_g;_f+=", "+_h;}}_c+="INSERT INTO "+_d.id+" ("+_e+") VALUES ("+_f+");\n";}system.clearClipboard();system.setClipboard("CF_TEXT",_c);};this.combo_onkeydown=function(_a,_b){system.clearClipboard();system.setClipboard("CF_TEXT",_a.text);};this.divSearch.form.btnLocalFilter_onclick=function(obj,e){var dataset=eval("this.opener."+this.divSearch.form.cboDataset.value);dataset.filter("");};this.divSearch.form.cbtnGlobalFilter_onclick=function(_a,_b){var _c=this.objApp[this.divSearch.form.cboGDS.text];_c.filter("");};this.btnClose_onclick=function(_a,_b){this.close();};this.tabComponent_tabpage1_btnSaveExcel_onclick=function(_a,_b){var _c="dsData";if(this.fvCurrentCombo=="cboDataset"){if(this.divSearch.form.cboDataset.index>-1){_c=this.divSearch.form.cboDataset.text;}}else{if(this.divSearch.form.cboGDS.index>-1){_c=this.divSearch.form.cboGDS.text;}}this.gfnExcelExport(this.tabComponent.tabpage1.form.grdDataset,_c,_c,"EXCEL2007");};});this.on_initEvent=function(){this.addEventHandler("onload",this.form_onload,this);this.divSearch.form.cboDataset.addEventHandler("onitemchanged",this.divSearch.form.cboDataset_onitemchanged,this);this.divSearch.form.cboDataset.addEventHandler("onkeydown",this.combo_onkeydown,this);this.divSearch.form.cboGDS.addEventHandler("onkeydown",this.combo_onkeydown,this);this.divSearch.form.cboGDS.addEventHandler("onitemchanged",this.divSearch.form.cboGDS_onitemchanged,this);this.tabComponent.addEventHandler("onchanged",this.tabComponent_onchanged,this);this.tabComponent.tabpage1.form.btnCreatSQL.addEventHandler("onclick",this.btnCreatSQL_onclick,this);this.tabComponent.tabpage1.form.btnSaveExcel.addEventHandler("onclick",this.tabComponent_tabpage1_btnSaveExcel_onclick,this);this.tabComponent.tabpage6.form.cboVariable.addEventHandler("onitemchanged",this.tabComponent_tabpage6_cboVariable_onitemchanged,this);this.tabComponent.tabpage7.form.btnRunScript.addEventHandler("onclick",this.fnExecScript,this);this.dsComponents.addEventHandler("onrowposchanged",this.fnMakeCompoentsData,this);};this.loadIncludeScript("cmmDebug.xfdl");this.loadPreloadList();_a=null;};})();
var m2nForm=m2nForm||nexacro.Form.prototype;m2nForm.lv_svcUrl="";m2nForm.lv_xmlDoc;m2nForm.lv_checkProp="tooltiptext";m2nForm.lv_checkPrefix="expr:";m2nForm.lv_ALPHA_CHAR_CODES=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102];m2nForm.m2n_formOnload=function(_a){var _b=_a;if(!nexacro.getApplication().http){nexacro.getApplication().http={};nexacro.getApplication().http.Sync=false;}};m2nForm.m2n_transaction=function(_a,_b,_c,_d,_e,_f,_g,_h){var _i=this;var _j={oForm:_i,svcid:_a,callback:_f};_g=_g||!nexacro.getApplication().http.Sync;_h=_h||0;this.transaction(_j,_b,_c,_d,_e,"m2n_transactionCallback",_g,_h);};m2nForm.m2n_transactionCallback=function(_a,_b,_c){var _d=this;var _e=_a.svcid;var _f=_a.callback;var _g={"ErrrorCode":_b,"ErrorMessage":_c};this.m2n_log({name:"m2n_transactionCallback",msg:_g});if(this.m2n_isNull(_f)){return;}if(typeof _f=="function"){_f.call(this,_e,_b,_c);}else if(typeof _f=="string"){this[_f].call(this,_e,_b,_c);}};m2nForm.m2n_dialogAsync=function(_a,_b,_c,_d,_e,_f,_g,_h,_i){this.m2n_log({name:"m2n_dialogAsync"});var _j=_a||"m2n_dialogAsync";_h=this.m2n_nvl(_h,-1);_i=this.m2n_nvl(_i,-1);_e=this.m2n_nvl(_e,-1);_f=this.m2n_nvl(_f,-1);_j="P_"+this.m2n_nvl(_a,"m2n_dialogAsync")+"_"+this.m2n_getUniqueId();var _k=this.m2n_makeArgumentArray(_d);var _l=this.getOwnerFrame();_c=_c.replace(".xml",".xfdl");var _m=new ChildFrame(_a,"absolute",_h,_i,_e,_f);if(_h==-1||_i==-1){_m.set_openalign("center middle");}if(_e==-1||_f==-1){_m.set_autosize(true);}_m.set_formurl(_c);_g=String(_g).toLowerCase();var _n=this.m2n_split2(_g," ","=");_m.set_autosize(true);for(var _p=0;_p<_n.length;_p++ ){switch(_n[_p][0]){case "titlebar":case "title":_m.set_showtitlebar(_n[_p][1]);break;case "resize":_m.set_resizable(_n[_p][1]);break;case "autosize":_m.set_autosize(_n[_p][1]);break;case "statusbar":case "status":_m.set_showstatusbar(_n[_p][1]);break;default:break;}}_m.arguments={};_m.arguments["fObj"]=this;_m.arguments["popup_oArg"]=_d;_m.arguments["p_callback"]=_b;var _o=_m.showModal(_j,this.getOwnerFrame(),_k,this,function(_q,_r){var _s=this.m2n_isNull(this.variant)?_r:this.variant;this.variant="";if(typeof _b=="function"){_b.call(this,_q,_s);}else if(typeof _b=="string"){this[_b].call(this,_q,_s);}return;});return _o;};m2nForm.m2n_close=function(_a){var _b=this;if(_b.opener&&typeof _a!="string"){_a=this.m2n_isNull(_a)?"":_a;_b.opener.variant=_a;_b.getOwnerFrame().form.close();}else{_b.getOwnerFrame().form.close(_a);}};m2nForm.m2n_dialog=function(_a,_b,_c,_d,_e,_f,_g,_h){this.m2n_log({name:"m2n_dialog"});if(nexacro.Browser!="Runtime"){var _i={"message":"현재 브라우저에서는 실행할수 없습니다."};this.m2n_log({name:"m2n_dialog",msg:_i});return;}_f=this.m2n_nvl(_f,-1);_g=this.m2n_nvl(_g,-1);_c=this.m2n_nvl(_c,-1);_d=this.m2n_nvl(_d,-1);var _j=this.m2n_makeArgumentArray(_b);if(this.m2n_isNull(_j)){_j=_b||"";}var _k=this.getOwnerFrame();_a=_a.replace(".xml",".xfdl");var _l="modal_"+this.m2n_getUniqueId();var _m=new ChildFrame(_l,"absolute",0,0,_c,_d);if(_f==-1||_g==-1){_m.set_openalign("center middle");}if(_c==-1||_d==-1){_m.set_autosize(true);}_m.set_formurl(_a);_e=String(_e).toLowerCase();var _n=this.m2n_split2(_e," ","=");for(var _p=0;_p<_n.length;_p++ ){switch(_n[_p][0]){case "titlebar":case "title":_m.set_showtitlebar(_n[_p][1]);break;case "resize":_m.set_resizable(_n[_p][1]);break;case "autosize":_m.set_autosize(_n[_p][1]);break;case "statusbar":case "status":_m.set_showstatusbar(_n[_p][1]);break;default:break;}}var _o=system.showModalSync(_m,_l,_k,_j,this);return _o;};m2nForm.m2n_open=function(_a,_b,_c,_d,_e,_f,_g){this.m2n_log({name:"m2n_open"});_f=this.m2n_nvl(_f,-1);_g=this.m2n_nvl(_g,-1);_c=this.m2n_nvl(_c,-1);_d=this.m2n_nvl(_d,-1);var _h=this.m2n_makeArgumentArray(_b);var _i="P_"+this.m2n_nvl(strPopId,"open")+"_"+this.m2n_getUniqueId();var _j;var _k;var _l=this;var _m;var _n;var _f=(nexacro.getApplication().mainframe.width/2)-Math.round(_l.width/2);var _g=(nexacro.getApplication().mainframe.height/2)-Math.round(_l.height/2);var _o=_l.getOwnerFrame();var _j=nexacro.open(_i,_a,_o,_h,"showtitlebar=true showstatusbar=false",_f,_g,_c,_d,_l);return _j;};m2nForm.m2n_exportExcel=function(_a,_b,_c,_d){this.m2n_log({name:"m2n_exportExcel"});var _e=this;var _f=_d||this.lv_svcUrl;var _b=_b||_a.name;var _g=new Date();var _h=_f+"XExportImport";var _i=_a;var _j=_i.toString().toUpperCase();var _c=_c||"sheet";var _k=this.m2n_isNull(_b)?this.m2n_getDate():(this.m2n_getDate()+"_"+_b);var _l=new ExcelExportObject();_l.clear();_l.addEventHandler("onsuccess",function(_m,_n){},_e);_l.addEventHandler("onerror",function(_m,_n){var _o={"e.eventid              ":"Excel Export onerror event start","e.fromobject           ":_n.fromobject,"e.fromreferenceobject  ":_n.fromreferenceobject,"e.errorcode            ":_n.errorcode,"e.errormsg             ":_n.errormsg};this.m2n_log({name:"ExcelExport OnError",msg:_o});},_e);_l.set_exporttype(nexacro.ExportTypes.EXCEL2007);_l.set_exportuitype("exportprogress");_l.set_exporturl(_h);_l.set_exportfilename(_k);if(_j=="[OBJECT GRID]"){_i=_i;sSheetName=_c+"1";_l.addExportItem(nexacro.ExportItemTypes.GRID,_i,sSheetName+"!A1","allband","allrecord","suppress","allstyle","background","font","both");}else{for(var _m=0;_m<obj.length;_m++ ){sSheetName=_c+(_m+1);_i=_i[_m];_l.addExportItem(nexacro.ExportItemTypes.GRID,_i,sSheetName+"!A1","allband","allrecord","suppress","allstyle","background","font","both");}}_l.exportData();};m2nForm.m2n_importExcel=function(_a,_b){this.m2n_log({name:"m2n_importExcel"});var _c=this.ds_out;var _d=this;var _e=_c.name;var _f=this.m2n_isCheckDs("ds_importTemp");var _g=this.lv_svcUrl+"XExportImport";var _h=new nexacro.ExcelImportObject("importExcel",_d);_c.clearData();_f.copyData(_c);_d["ds_import"]=_c;_h.set_importtype(nexacro.ImportTypes.EXCEL);_h.addEventHandler("onsuccess",function(_i,_j){var _k=this["ds_importTemp"];var _l=this["ds_import"];var _m=[];for(var _q=0;_q<_l.getColCount();_q++ ){var _n=_l.getColID(_q);var _o=_k.getColID(_q);_m[_q]=_n+"="+_o;}_l.clearData();_k.set_enableevent(false);for(var _q=0;_q<_k.getRowCount();_q++ ){var _p=_l.addRow();_l.copyRow(_p,_k,_q,_m.join(","));}_k.set_enableevent(true);_l.applyChange();_k.clear();},_d);_h.addEventHandler("onerror",function(_i,_j){var _k={"e.eventid              ":"Excel Import onerror event","e.fromobject           ":_j.fromobject,"e.fromreferenceobject  ":_j.fromreferenceobject,"e.errorcode            ":_j.errorcode,"e.errormsg             ":_j.errormsg};this.m2n_log({name:"ExcelImport OnError",msg:_k});},_d);_h.set_importurl(_g);_h.importData("","[command=getsheetdata;output=outDs;"+_a+"]","["+_f.name+"=outDs]");};m2nForm.m2n_applyData=function(_a){if(this.m2n_isNull(_a)){_a=this.getFocus();}if(_a!=null){try{_a.updateToDataset();}catch(e){}}};m2nForm.m2n_arrangeWindow=function(_a){var _b=nexacro.getApplication().mainframe.VFrames.HFrames.MDIForms;if(this.m2n_isNull(_b)){return;}var _c=_a.toLowerCase();switch(_c){case "htile":_b.arrange("tilehorizontal");break;case "vtile":_b.arrange("tilevertical");break;case "cascade":_b.arrange("cascade");break;}};m2nForm.m2n_closeSession=function(){nexacro.getApplication().Session=false;this.m2n_loginSession();};m2nForm.m2n_loginSession=function(){if(nexacro.getApplication().Session==true){return;}var _a=new ChildFrame("login");_a.set_formurl(nexacro.getApplication().SessionURL);_a.set_openalign("center middle");_a.set_showtitlebar(false);_a.showModal(nexacro.getApplication().mainframe,null,nexacro.getApplication().mainframe,function(_b,_c){if(nexacro.getApplication().Session==false){if(nexacro.Browser=="Runtime"){nexacro.getApplication().exit();}else{window.top.location.reload(true);}return;}});};m2nForm.m2n_getSession=function(){return nexacro.getApplication().Session;};m2nForm.m2n_initSession=function(_a){nexacro.getApplication().Session=_a;};m2nForm.m2n_createObject=function(_a){var _b=new Plugin();_b.set_classid(_a);return _b;};m2nForm.m2n_createRegExp=function(_a,_b){return new RegExp(_a,_b);};m2nForm.m2n_deleteCacheFile=function(){nexacro.getApplication().deleteCacheDB();};m2nForm.m2n_destroyObject=function(_a,_b){var _c=this;var _d="";if(arguments.length==2){_c=_a;_d=_b.name;}else{_d=_a.name;}this.m2n_destroy(_c,_d);};m2nForm.m2n_destroy=function(_a,_b){var _c=this;var _d=arguments;if(_d.length==2){_c=_a;}else{_b=_a;}var _e=_c.removeChild(_b);if(_e==null){return;}if(_e.destroy){_e.destroy();}};m2nForm.m2n_getCurrentComponent=function(_a){if(this.m2n_isNull(_a)){_a=false;}var _b=this.getFocus();if(_a==false){var _c=_b.parent;if(this.m2n_isComposite(_c)){return _c;}}return _b;};m2nForm.m2n_getCurrentMonitor=function(){return system.getMonitorIndex(system.cursorx,system.cursory);};m2nForm.m2n_getFormFromHandle=function(_a){var _b=this.m2n_allWindows();for(var _c=0;_c<_b.length;_c++ ){if(_a==_b[_c].name){return _b[_c].form;}}return null;};m2nForm.m2n_getAllCommponents=function(_a,_b){if(!_a){return null;}if(_a.components&&_a.components[_b]){return _a.components[_b];}if(_a.objects&&_a.objects[_b]){return _a.objects[_b];}return null;};m2nForm.m2n_find=function(){var _a,_b,_c;_a=arguments.length;if(_a==0){return null;}_b=arguments[0];_c=arguments[1];if(_a==1){return this.lookup(_b);}if(_a==2){return _b.lookup(_c);}};m2nForm.m2n_getHScroll=function(_a){return _a.hscrollbar.pos;};m2nForm.m2n_getVScroll=function(_a){return _a.vscrollbar.pos;};m2nForm.m2n_setScroll=function(_a,_b,_c){_a.hscrollbar.set_pos(_b);_a.vscrollbar.set_pos(_c);};m2nForm.m2n_isSimulator=function(){var _a=nexacro.getApplication().xadl;if(_a.indexOf("http")>-1){return false;}else{return true;}};m2nForm.m2n_printScreen=function(_a,_b,_c){if(this.m2n_isNull(_a)){_a=true;}if(this.m2n_isNull(_b)){_b="middle";}if(this.m2n_isNull(_c)){_c="center";}return system.print(this,_a,_b.toLowerCase(),_c.toLowerCase());};m2nForm.m2n_releaseCapture=function(){this.setWaitCursor(false,true);};m2nForm.m2n_setCapture=function(){this.setWaitCursor(true,true);};m2nForm.m2n_setWaitCursor=function(_a){this.setWaitCursor(this.m2n_nvl(_a,false),true);};m2nForm.m2n_setReg=function(_a,_b){return nexacro.setPrivateProfile(_a,_b);};m2nForm.m2n_getReg=function(_a,_b){return this.m2n_nvl(nexacro.getPrivateProfile(_a),_b);};m2nForm.m2n_binToText=function(_a,_b){if(this.m2n_isNull(_b)){return _a.getText(0);}else{return _a.getText(0,-1,_b);}};m2nForm.m2n_chr=function(_a){if(this.m2n_isNull(_a)){return null;}return String.fromCharCode(_a);};m2nForm.m2n_lTrimCase=function(_a,_b){var _c;if(this.m2n_isNull(_a)){return "";}if(this.m2n_isNull(_b)){_b=" ";}_a=String(_a);for(_c=0;_c<_a.length;_c+=_b.length){if(_a.toLowerCase().substr(_c,_b.length)!=_b.toLowerCase()){break;}}return _a.substr(_c);};m2nForm.m2n_rTrimCase=function(_a,_b){var _c,_d;if(this.m2n_isNull(_a)){return "";}if(this.m2n_isNull(_b)){_b=" ";}for(_c=_a.length-_b.length;_c>=0;_c-=_b.length){if(_a.toLowerCase().substr(_c,_b.length)!=_b.toLowerCase()){break;}}return _a.substr(0,_c+_b.length);};m2nForm.m2n_lpad=function(_a,_b,_c){var _d="";var _e=_c-String(_a).length;if(_b!=null){for(var _f=0;_f<_e;_f++ ){_d+=_b;}}else if(_b==null){for(var _f=0;_f<_e;_f++ ){_d+=" ";}}_d=_d+_a;return _d;};m2nForm.m2n_rpad=function(_a,_b,_c){var _d="";var _e=_c-String(_a).length;_d=_d+_a;if(_b!=null){for(var _f=0;_f<_e;_f++ ){_d+=_b;}}else if(_b==null){for(var _f=0;_f<_e;_f++ ){_d+=" ";}}return _d;};m2nForm.m2n_indexOf=function(_a,_b,_c){if(this.m2n_indexOf.arguments.length==3){return String(_a).indexOf(_b,_c);}else{return String(_a).indexOf(_b);}};m2nForm.m2n_replace=function(_a,_b,_c){return String(_a).split(_b).join(this.m2n_nvl(_c,""));};m2nForm.m2n_charAt=function(_a,_b){return String(_a).charAt(_b);};m2nForm.m2n_space=function(_a){return String("").padLeft(_a," ");};m2nForm.m2n_exponentFormat=function(_a,_b){return Number(_a).toExponential(_b);};m2nForm.m2n_dateTime=function(_a,_b,_c){if(this.m2n_trim(_a.toString()).length>=5){var _d=new String(_a);var _a=_d.substr(0,4);var _b=_d.substr(4,2);var _c=((_d.substr(6,2)=="")?1:_d.substr(6,2));var _e=((_d.substr(8,2)=="")?0:_d.substr(8,2));var _f=((_d.substr(10,2)=="")?0:_d.substr(10,2));var _g=((_d.substr(12,2)=="")?0:_d.substr(12,2));var _h=new Date(parseInt(_a),parseInt(_b)-1,parseInt(_c),parseInt(_e),parseInt(_f),parseInt(_g));}else{var _h=new Date(parseInt(_a),parseInt(_b)-1,parseInt(((_c==null)?1:_c)));}var _i=_h.getFullYear().toString();var _j=(_h.getMonth()+1).toString();var _k=_h.getDate().toString();if(_j.length==1){_j="0"+_j;}if(_k.length==1){_k="0"+_k;}return _i+_j+_k;};m2nForm.m2n_getMaskFormat=function(_a,_b){var _c="";var _d;if(this.m2n_isNull(_a)){return null;}var _e=String(_a);var _f=this.m2n_nvl(_b,"");for(var _g=0;_g<_f.length;_g++ ){_d=_f.substr(_g,1);if(_d=="@"){_c+=_e.substr(0,1);_e=_e.substr(1);if(_e.length==0){break;}}else{_c+=_d;}}return _c;};m2nForm.m2n_dateFormatString=function(_a,_b){if(this.m2n_isNull(_b)){return "";}var _c=String(_a.getFullYear());var _d=_c.substr(_c.length-2,2);_b=_b.toString();_b=_b.split("%Y").join(String(_a.getFullYear()));_b=_b.split("%y").join(_d);_b=_b.split("%m").join(String(_a.getMonth()+1).padLeft(2,"0"));_b=_b.split("%d").join(String(_a.getDate()).padLeft(2,"0"));_b=_b.split("%H").join(String(_a.getHours()).padLeft(2,"0"));_b=_b.split("%M").join(String(_a.getMinutes()).padLeft(2,"0"));_b=_b.split("%S").join(String(_a.getSeconds()).padLeft(2,"0"));return _b;};m2nForm.m2n_ToDate=function(_a){_a=_a.toString();var _b=_a.substr(0,4);var _c=_a.substr(4,2);var _d=_a.substr(6,2).padLeft(2,"0");_a=_b+_c+_d;return new Date(this.m2n_getMaskFormat(_a,"@@@@/@@/@@"));};m2nForm.m2n_getDay=function(_a){if(this.m2n_isNull(_a)){return -1;}var _b=new Date(this.m2n_getMaskFormat(_a,"@@@@/@@/@@"));return _b.getDay()+1;};m2nForm.m2n_today=function(){return this.m2n_dateFormatString(new Date(),"%Y%m%d");};m2nForm.m2n_todayTime=function(){return this.m2n_getDate();};m2nForm.m2n_getDate=function(){return this.m2n_dateFormatString(new Date(),"%Y%m%d%H%M%S");};m2nForm.m2n_addDate=function(_a,_b){var _c=this.m2n_ToDate(_a);_c.addDate(_b);return this.m2n_dateFormatString(_c,"%Y%m%d");};m2nForm.m2n_addMonth=function(_a,_b){if(this.m2n_isNull(_a)){_a=this.m2n_today();}var _c=this.m2n_ToDate(_a);if((_c instanceof Date)==false){return alert(_c);}var _d=_c.getDate();var _e=this.m2n_getFirstMonthDate(_a);_e.addMonth(_b);var _f=this.m2n_getLastDayOfMonth(this.m2n_dateFormatString(_e,"%Y%m%d"));if(_d>_f){_d=_f;}_e.addDate(_d-1);return this.m2n_dateFormatString(_e,"%Y%m%d");};m2nForm.m2n_getFirstMonthDate=function(_a){var _b=this.m2n_ToDate(_a);_b.addDate(-1* (_b.getDate()-1));return _b;};m2nForm.m2n_getLastMonthDate=function(_a){var _b=this.m2n_getFirstMonthDate(_a);_b.addMonth(1);_b.addDate(-1);return _b;};m2nForm.m2n_getLastDayOfMonth=function(_a){var _b=this.m2n_getFirstMonthDate(_a);_b.addMonth(1);_b.addDate(-1);return _b.getDate();};m2nForm.m2n_lunar2Solar=function(_a){var _b="31,0,31,30,31,30,31,31,30,31,30,31";var _c=new Array();var _d=new Array();var _e,_f,_g,_h;var _i,_j,_k;var _l,_m,_n,_o,_p,_q;var _r;if(this.m2n_isNull(_a)){return "";}if(_a.length!=9){return "";}_h=_a.substr(0,1);_e=parseInt(_a.substr(1,4),10);_f=parseInt(_a.substr(5,2),10);_g=parseInt(_a.substr(7,2),10);if(_e<1841||_e>2043){return "";}if(_h!="0"&&_h!="1"){return "";}_d=this.m2n_solarBase();_c=_b.split(",");if(this.m2n_isLeapYear(_a.substr(1,8))==true){_c[1]=29;}else{_c[1]=28;}_l=_e-1841;_m=_f-1;_r=0;if(parseInt(_d[_l* 12+_m],10)>2){_r=this.m2n_isLeapYear(_e+"0101");}var _s;if(_r==1){switch(parseInt(_d[_l* 12+_m],10)){case 3:_s=29;break;case 4:_s=30;break;case 5:_s=29;break;case 6:_s=30;break;}}else{switch(parseInt(_d[_l* 12+_m],10)){case 1:_s=29;break;case 2:_s=30;break;case 3:_s=29;break;case 4:_s=29;break;case 5:_s=30;break;case 6:_s=30;break;}}var _t;_t=0;for(_n=0;_n<=_l-1;_n++ ){for(_o=0;_o<=11;_o++ ){switch(parseInt(_d[_n* 12+_o],10)){case 1:_t=_t+29;break;case 2:_t=_t+30;break;case 3:_t=_t+58;break;case 4:_t=_t+59;break;case 5:_t=_t+59;break;case 6:_t=_t+60;break;}}}for(_o=0;_o<=_m-1;_o++ ){switch(parseInt(_d[_l* 12+_o],10)){case 1:_t=_t+29;break;case 2:_t=_t+30;break;case 3:_t=_t+58;break;case 4:_t=_t+58;break;case 5:_t=_t+59;break;case 6:_t=_t+60;break;}}if(_r==1){switch(parseInt(_d[_l* 12+_m],10)){case 3:_s=29;break;case 4:_s=29;break;case 5:_s=30;break;case 6:_s=30;break;}}_t=_t+_g+22;if(_h=="1"){switch(parseInt(_d[_l* 12+_m],10)){case 3:_t=_t+29;break;case 4:_t=_t+30;break;case 5:_t=_t+29;break;case 6:_t=_t+30;break;}}_l=1840;do{_l=_l+1;_r=this.m2n_isLeapYear(_l+"0101");if(_r==1){_p=366;}else{_p=365;}if(_t<=_p){break;}_t=_t-_p;}while(1)_i=_l;_c[1]=_p-337;_m=0;do{_m=_m+1;if(_t<=parseInt(_c[_m-1],10)){break;}_t=_t-parseInt(_c[_m-1],10);}while(1)_j=_m;_k=_t;_q=_i;_t=_q* 365+parseInt(_q/4,10)-parseInt(_q/100,10)+parseInt(_q/400,10);for(_n=0;_n<=_j-1;_n++ ){_t=_t+parseInt(_c[_n],10);}_t=_t+_k;return _q+this.m2n_right("0"+_j,2)+this.m2n_right("0"+_k,2);};m2nForm.m2n_isLeapYear=function(_a){var _b;var _c;_c=parseInt(_a.substring(0,4),10);if((_c%4)==0){if((_c%100)!=0||(_c%400)==0){_b=true;}else{_b=false;}}else{_b=false;}return _b;};m2nForm.m2n_solarBase=function(){var _a;_a="1,2,4,1,1,2,1,2,1,2,2,1,";_a+="2,2,1,2,1,1,2,1,2,1,2,1,";_a+="2,2,2,1,2,1,4,1,2,1,2,1,";_a+="2,2,1,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,2,1,2,1,2,1,2,1,";_a+="2,1,2,1,5,2,1,2,2,1,2,1,";_a+="2,1,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,3,2,1,2,1,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,1,2,1,2,1,5,2,";_a+="2,1,2,2,1,1,2,1,2,1,1,2,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,5,2,1,2,1,2,";_a+="1,1,2,1,2,2,1,2,2,1,2,1,";_a+="2,1,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,5,2,1,2,1,2,2,2,";_a+="1,2,1,1,2,1,1,2,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,1,2,2,";_a+="2,1,6,1,1,2,1,1,2,1,2,2,";_a+="1,2,2,1,2,1,2,1,2,1,1,2,";_a+="2,1,2,1,2,2,1,2,2,3,1,2,";_a+="1,2,2,1,2,1,2,2,1,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,1,2,4,1,2,2,1,2,2,1,";_a+="2,1,1,2,1,1,2,2,1,2,2,2,";_a+="1,2,1,1,2,1,1,2,1,2,2,2,";_a+="1,2,2,3,2,1,1,2,1,2,2,1,";_a+="2,2,2,1,1,2,1,1,2,1,2,1,";_a+="2,2,2,1,2,1,2,1,1,5,2,1,";_a+="2,2,1,2,2,1,2,1,2,1,1,2,";_a+="1,2,1,2,2,1,2,1,2,2,1,2,";_a+="1,1,2,1,2,4,2,1,2,2,1,2,";_a+="1,1,2,1,2,1,2,1,2,2,2,1,";_a+="2,1,1,2,1,1,2,1,2,2,2,1,";_a+="2,2,1,1,5,1,2,1,2,2,1,2,";_a+="2,2,1,1,2,1,1,2,1,2,1,2,";_a+="2,2,1,2,1,2,1,1,2,1,2,1,";_a+="2,2,4,2,1,2,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,2,1,2,1,1,2,";_a+="1,2,1,2,1,2,5,2,2,1,2,1,";_a+="1,2,1,2,1,2,1,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,2,1,2,";_a+="2,1,1,2,3,2,1,2,2,1,2,2,";_a+="2,1,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,2,1,2,1,2,";_a+="2,2,1,5,2,1,1,2,1,2,1,2,";_a+="2,1,2,2,1,2,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,5,2,1,2,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,1,2,2,1,2,2,";_a+="1,1,2,1,1,5,2,2,1,2,2,2,";_a+="1,1,2,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,5,1,2,1,2,1,2,1,";_a+="2,2,2,1,2,1,1,2,1,2,1,2,";_a+="1,2,2,1,2,1,2,1,2,1,2,1,";_a+="2,1,5,2,2,1,2,1,2,1,2,1,";_a+="2,1,2,1,2,1,2,2,1,2,1,2,";_a+="1,2,1,1,2,1,2,5,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,3,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,1,2,1,1,2,2,1,";_a+="2,2,1,2,2,1,1,2,1,2,1,2,";_a+="1,2,2,4,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,2,1,2,1,2,2,1,2,";_a+="1,5,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,5,1,2,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,1,2,1,1,2,1,2,";_a+="2,2,1,2,5,1,2,1,2,1,1,2,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,2,1,2,1,2,1,";_a+="2,3,2,1,2,2,1,2,2,1,2,1,";_a+="2,1,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,5,2,2,1,2,2,";_a+="1,2,1,1,2,1,1,2,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,1,2,2,";_a+="2,1,2,2,3,2,1,1,2,1,2,2,";_a+="1,2,2,1,2,1,2,1,2,1,1,2,";_a+="2,1,2,1,2,2,1,2,1,2,1,1,";_a+="2,1,2,5,2,1,2,2,1,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,1,2,1,2,1,2,2,1,2,2,";_a+="1,5,1,2,1,1,2,2,1,2,2,2,";_a+="1,2,1,1,2,1,1,2,1,2,2,2,";_a+="1,2,2,1,1,5,1,2,1,2,2,1,";_a+="2,2,2,1,1,2,1,1,2,1,2,1,";_a+="2,2,2,1,2,1,2,1,1,2,1,2,";_a+="1,2,2,1,6,1,2,1,2,1,1,2,";_a+="1,2,1,2,2,1,2,2,1,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,4,1,2,1,2,1,2,2,2,1,";_a+="2,1,1,2,1,1,2,1,2,2,2,1,";_a+="2,2,1,1,2,1,4,1,2,2,1,2,";_a+="2,2,1,1,2,1,1,2,1,2,1,2,";_a+="2,2,1,2,1,2,1,1,2,1,2,1,";_a+="2,2,1,2,2,4,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,2,1,2,1,1,2,";_a+="1,2,1,2,1,2,2,1,2,2,1,2,";_a+="1,1,2,4,1,2,1,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,2,1,2,";_a+="2,1,1,2,1,1,2,1,2,2,1,2,";_a+="2,5,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,2,1,2,1,2,";_a+="2,2,1,2,1,2,3,2,1,2,1,2,";_a+="2,1,2,2,1,2,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,4,2,1,2,1,2,1,2,";_a+="1,2,1,1,2,2,1,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,1,2,2,";_a+="2,1,4,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,5,2,1,2,2,";_a+="1,2,2,1,2,1,1,2,1,2,1,2,";_a+="1,2,2,1,2,1,2,1,2,1,2,1,";_a+="2,1,2,1,2,5,2,1,2,1,2,1,";_a+="2,1,2,1,2,1,2,2,1,2,1,2,";_a+="1,2,1,1,2,1,2,2,1,2,2,1,";_a+="2,1,2,3,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,1,2,2,1,";_a+="2,2,5,2,1,1,2,1,1,2,2,1,";_a+="2,2,1,2,2,1,1,2,1,2,1,2,";_a+="1,2,2,1,2,1,5,2,1,2,1,2,";_a+="1,2,1,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,2,1,2,1,2,2,1,2,";_a+="1,2,1,1,5,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,1,2,2,2,1,";_a+="2,2,1,5,1,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,1,2,1,1,2,1,2,";_a+="2,2,1,2,1,2,1,5,2,1,1,2,";_a+="2,1,2,2,1,2,1,2,1,2,1,1,";_a+="2,2,1,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,1,6,1,2,2,1,2,1,";_a+="2,1,1,2,1,2,1,2,2,1,2,2,";_a+="1,2,1,1,2,1,1,2,2,1,2,2,";_a+="2,1,2,3,2,1,1,2,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,1,2,2,";_a+="2,1,2,2,1,1,2,1,1,5,2,2,";_a+="1,2,2,1,2,1,2,1,1,2,1,2,";_a+="1,2,2,1,2,2,1,2,1,2,1,1,";_a+="2,1,2,2,1,5,2,2,1,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,1,2,1,2,1,2,2,1,2,2,";_a+="1,2,1,1,5,1,2,1,2,2,2,2,";_a+="1,2,1,1,2,1,1,2,1,2,2,2,";_a+="1,2,2,1,1,2,1,1,2,1,2,2,";_a+="1,2,5,2,1,2,1,1,2,1,2,1,";_a+="2,2,2,1,2,1,2,1,1,2,1,2,";_a+="1,2,2,1,2,2,1,5,2,1,1,2,";_a+="1,2,1,2,2,1,2,1,2,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,1,2,3,2,2,1,2,2,2,1,";_a+="2,1,1,2,1,1,2,1,2,2,2,1,";_a+="2,2,1,1,2,1,1,2,1,2,2,1,";_a+="2,2,2,3,2,1,1,2,1,2,1,2,";_a+="2,2,1,2,1,2,1,1,2,1,2,1,";_a+="2,2,1,2,2,1,2,1,1,2,1,2,";_a+="1,5,2,2,1,2,1,2,2,1,1,2,";_a+="1,2,1,2,1,2,2,1,2,2,1,2,";_a+="1,1,2,1,2,1,5,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,2,1,2,";_a+="2,1,1,2,1,1,2,1,2,2,1,2,";_a+="2,2,1,1,5,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,2,1,2,1,2,";_a+="2,1,2,2,1,2,1,1,2,1,2,1,";_a+="2,1,6,2,1,2,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,1,2,5,2,1,2,";_a+="1,2,1,1,2,1,2,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,1,2,2,";_a+="2,1,1,2,3,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,2,1,2,1,2,";_a+="2,1,2,5,2,1,1,2,1,2,1,2,";_a+="1,2,2,1,2,1,2,1,2,1,2,1,";_a+="2,1,2,1,2,2,1,2,1,2,1,2,";_a+="1,5,2,1,2,1,2,2,1,2,1,2,";_a+="1,2,1,1,2,1,2,2,1,2,2,1,";_a+="2,1,2,1,1,5,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,1,2,2,2,";_a+="1,2,2,1,5,1,2,1,1,2,2,1,";_a+="2,2,1,2,2,1,1,2,1,1,2,2,";_a+="1,2,1,2,2,1,2,1,2,1,2,1,";_a+="2,1,5,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,1,2,2,1,2,2,1,2,";_a+="1,2,1,1,2,1,5,2,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,4,1,1,2,1,2,2,";_a+="2,2,1,2,1,1,2,1,1,2,1,2,";_a+="2,2,1,2,1,2,1,2,1,1,2,1,";_a+="2,2,1,2,5,2,1,2,1,2,1,1,";_a+="2,1,2,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,1,2,2,1,2,2,1,2,";_a+="1,5,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,1,2,2,1,2,2";var _b=new Array();_b=_a.split(",");return _b;};m2nForm.m2n_solar2Lunar=function(_a){var _b=this.m2n_solar2LunarBase(_a);if(_b.valueOf().length==9){_b=_b.valueOf().substr(1,8);}else{_b="";}return _b;};m2nForm.m2n_solar2LunarEx=function(_a){var _b=new Array();var _c=this.m2n_solar2LunarBase(_a);if(_c.valueOf().length==9){_b[0]=_c.valueOf().substr(1,8);if(_c.valueOf().substr(0,1)=="1"){_b[1]=true;}else{_b[1]=false;}}return _b;};m2nForm.m2n_solar2LunarBase=function(_a){var _b="31,0,31,30,31,30,31,31,30,31,30,31";var _c=new Array();var _d=new Array();var _e=new Array();var _f;var _g;var _h;var _i;var _j,_k,_l;var _m;if(m2n_isNull(_a)){return "";}sY=parseInt(_a.substr(0,4),10);sM=parseInt(_a.substr(4,2),10);sD=parseInt(_a.substr(6,2),10);if(sY<1841||sY>2043){return "";}_d=_SolarBase();_c=_b.split(",");if(IsLeapYear(_a)==true){_c[1]=29;}else{_c[1]=28;}_g=672069;_h=(sY-1)* 365+parseInt((sY-1)/4)-parseInt((sY-1)/100)+parseInt((sY-1)/400);for(i=0;i<=sM-2;i++ ){_h=_h+parseInt(_c[i]);}_h=_h+sD;_f=_h-_g+1;for(i=0;i<=sY-1841;i++ ){_e[i]=0;for(j=0;j<=11;j++ ){switch(parseInt(_d[i* 12+j])){case 1:_i=29;break;case 2:_i=30;break;case 3:_i=58;break;case 4:_i=59;break;case 5:_i=59;break;case 6:_i=60;break;}_e[i]=_e[i]+_i;}}_j=0;do{_f=_f-_e[_j];_j=_j+1;}while(_f>_e[_j])_k=0;_m="0";do{if(parseInt(_d[_j* 12+_k])<=2){_i=parseInt(_d[_j* 12+_k])+28;if(_f>_i){_f=_f-_i;_k=_k+1;}else{break;}}else{switch(parseInt(_d[_j* 12+_k])){case 3:m1=29;m2=29;break;case 4:m1=29;m2=30;break;case 5:m1=30;m2=29;break;case 6:m1=30;m2=30;break;}if(_f>m1){_f=_f-m1;if(_f>m2){_f=_f-m2;_k=_k+1;}else{_m="1";}}else{break;}}}while(1)_j=_j+1841;_k=_k+1;_l=_f;return _m+_j+Right("0"+_k,2)+Right("0"+_l,2);};m2nForm.m2n_getStartOfWeek=function(_a){var _b=_a.getDayOfWeek();var _c=0-_b;var _d=new Date(_a.getYear(),_a.getMonth()+1,_a.getDay());if(_b==0){return this.m2n_dateFormatString(_d,"%Y%m%d");}var _e=_d.addDate(_c);return this.m2n_dateFormatString(_d,"%Y%m%d");};m2nForm.m2n_getEndOfWeek=function(_a){var _b=6;var _c=_a.getDayOfWeek();var _d=new Date(_a.getYear(),_a.getMonth()+1,_a.getDay());if(_c==_b){return this.m2n_dateFormatString(_d,"%Y%m%d");}var _e=new Date(_a.getYear(),_a.getMonth()+1,_a.getDay());var _f=_d.getDate();_e.addDate(_b-_c);var _g=_e.getDate();return this.m2n_dateFormatString(_e,"%Y%m%d");};m2nForm.m2n_lastDateNum=function(_a){var _b,_c;_b=parseInt(_a.substr(4,2),10);if(_b==1||_b==3||_b==5||_b==7||_b==8||_b==10||_b==12){_c=31;}else if(_b==2){if(this.m2n_isLeapYear(_a)==true){_c=29;}else{_c=28;}}else{_c=30;}return _c;};m2nForm.m2n_getChild=function(){switch(arguments.length){case 0:return null;break;case 1:parentObj=this;objStr=arguments[0];break;default:parentObj=arguments[0];objStr=arguments[1];break;}return parentObj.all[objStr]||null;};m2nForm.m2n_getDeviceInfo=function(_a){if(this.m2n_isNull(_a)){return "";}var _b=_a.toLowerCase();if(nexacro.Browser=="Runtime"){if(_b=='cxscreen'){return system.getScreenRect(1).width;}else if(_b=='cyscreen'){return system.getScreenRect(1).height;}else if(_b=='cmonitor'){return system.monitorcount;}else if(_b=='osversion'){return system.osversion;}else if(_b=='osversionsp'){return null;}else if(_b=='osproducttype'){return null;}else if(_b=='oeminfo'){return null;}}else{if(_b=='cxscreen'){return screen.width;}else if(_b=='cyscreen'){return screen.height;}else{return null;}}};m2nForm.m2n_getVariable=function(_a,_b){strTarget=this.m2n_nvl(_b,"");strTarget=this.m2n_toLower(strTarget);switch(strTarget){case "local":return this[_a]||null;break;case "share":case "global":case "aglobal":default:return nexacro.getApplication().all[_a]||null;break;}};m2nForm.m2n_setVariable=function(_a,_b,_c){_c=this.m2n_nvl(_c,"");_b=this.m2n_nvl(_b,"");_c=this.m2n_toLower(_c);switch(_c){case "aglobal":return nexacro.getApplication().setVariable(_a,_b,"global");break;case "local":this[_a]=_b;return 1;break;case "share":case "global":default:return nexacro.getApplication().setVariable(_a,_b,_c);break;}};m2nForm.m2n_addVariable=function(_a,_b,_c){_c=this.m2n_nvl(_c,"");_b=this.m2n_nvl(_b,"");_c=this.m2n_toLower(_c);switch(_c){case "share":case "global":return nexacro.getApplication().addVariable(_a,_b,_c);break;case "aglobal":return nexacro.getApplication().addVariable(_a,_b,"global");break;case "local":default:this[_a]=_b;return 1;break;}};m2nForm.m2n_deleteVariable=function(_a,_b){_b=this.m2n_nvl(_b,"");_b=this.m2n_toLower(_b);var _c;switch(_b){case "share":case "global":case "aglobal":_c=this.m2n_getVariable(_a,_b);if(_c==null){return false;}try{delete nexacro.getApplication()[_a];delete nexacro.getApplication().all[_a];}catch(e){return false;}return true;break;case "local":default:_c=this.m2n_getVariable(_a,_b);if(_c==null){return false;}try{delete this[_a];}catch(e){return false;}return true;break;}};m2nForm.m2n_isExistVariable=function(_a,_b){var _c=false;_b=this.m2n_nvl(_b,"");_b=this.m2n_toLower(_b);switch(_b){case "share":case "global":case "aglobal":_c=(_a in nexacro.getApplication())||false;break;case "local":_c=(_a in this)||(_a in this.parent);break;default:_c=this.m2n_isExistVar(this,_a,true);break;}if(_c==false){return _c;}return true;};m2nForm.m2n_isExistVar=function(_a,_b,_c){if(_a==null){_a=this;}var _d=(_b in _a);if(_d==true){return true;}if(_c==true){if(_a.parent&&this.m2n_isExistVar(_a.parent,_b,_c)){return true;}else if(_a.opener&&this.m2n_isExistVar(_a.opener,_b,_c)){return true;}}return false;};m2nForm.m2n_isExistFunc=function(_a,_b,_c){if(this.m2n_isNull(_c)){_c=false;}var _d;if(_a==null){_a=this;}if(_c){_d=this.m2n_getObject(_a,_b);}else{_d=_a[_b];}if(this.m2n_isNull(_d)){return false;}if(typeof (_d)=='function'){return true;}else{return false;}};m2nForm.m2n_subString=function(_a,_b,_c){if(arguments.length==3){return String(_a).substr(_b,_c);}else{return String(_a).substr(_b);}};m2nForm.m2n_varKeyState=function(_a){var _b=new Array();switch(_a.button){case "lbutton":_b.push(true);_b.push(false);_b.push(false);break;case "mbutton":_b.push(false);_b.push(true);_b.push(false);break;case "rbutton":_b.push(false);_b.push(false);_b.push(true);break;}_b.push(_a.shiftKey);_b.push(_a.ctrlKey);_b.push(_a.altKey);return _b;};m2nForm.m2n_random=function(_a,_b){var _c;if(this.m2n_isNull(_a)){_a=0;}if(this.m2n_isNull(_b)){_b=65535;}if(_a<0){_a=0;}if(_a>=65535){_a=65535;}if(_b>65535){_b=65535;}var _d=_b-_a;_c=_a+Math.floor(Math.random()* _d);return _c;};m2nForm.m2n_callScript=function(_a){if(this.m2n_isNull(_a)){return "";}return NexacroAX.callscript(_a);};m2nForm.m2n_getMDIStatus=function(_a){var _b;if(this.m2n_isNull(_a)){return;}if(_a.toString().toUpperCase()=="[OBJECT FRAMESET]"){_b=_a.openstatus;}else{_b=_a.getOwnerFrame().openstatus;}switch(_b){case "maximize":return "Max";break;case "minimize":return "Min";break;case "normal":return "Normal";break;}};m2nForm.m2n_setMDIStatus=function(_a,_b){var _c;if(this.m2n_isNull(_a)){return;}switch(_b.toLowerCase()){case "max":_c="maximize";break;case "min":_c="minimize";break;case "normal":_c="normal";break;}if(_a.toString().toUpperCase()=="[OBJECT FRAMESET]"){_a.set_openstatus(_c);}else{_a.getOwnerFrame().set_openstatus=_c;}};m2nForm.m2n_getObject=function(){var nLength,parentObj,objStr,objRet;var FindObj;nLength=arguments.length;if(nLength==0){return null;}if(nLength==1){parentObj=this;objStr=arguments[0];}else{parentObj=arguments[0];objStr=arguments[1];}if(parentObj.name==objStr){return this;}FindObj=parentObj.lookup(objStr);if(FindObj==null||FindObj==undefined){try{FindObj=eval("parentObj."+objStr);}catch(e){}if(!FindObj){if(this.opener){FindObj=this.opener.lookup(objStr);if(!FindObj){try{FindObj=eval("this.opener."+objStr);}catch(e){}}}}}if(FindObj==null||FindObj==undefined){trace("##### : "+objStr+" 찾지 못했습니다.");}return FindObj;};m2nForm.m2n_getPrevComponent=function(_a){var _b,_c,_d;_d=this.getFocus();_b=this.m2n_nvl(_a,false);_c=this.getPrevComponent(_d,_b);return _c;};m2nForm.m2n_getNextComponent=function(_a){var _b,_c,_d;_d=this.getFocus();_b=this.m2n_nvl(_a,false);_c=this.getNextComponent(_d,_b);return _c;};m2nForm.m2n_allWindows=function(_a){var _b=[];if(nexacro.getApplication().popupframes.length>0){for(var _c=0;_c<nexacro.getApplication().popupframes.length;_c++ ){_b.push(nexacro.getApplication().popupframes[_c]);}}_b=_b.concat(this.m2n_allChildWindow(nexacro.getApplication().mainframe.frame.all,true));if(this.m2n_isNull(_a)){return _b;}for(var _c=0;_c<_b.length;_c++ ){if(_a==_b[_c].name){return _b[_c];}}return _b;};m2nForm.m2n_allChildWindow=function(_a,_b){var _c=[];for(var _d=0;_d<_a.length;_d++ ){_c.push(_a[_d]);if(_a[_d].frames){if(_b==false&&_a[_d].toString().toUpperCase()=="[OBJECT FRAMESET]"){continue;}_c=_c.concat(this.m2n_allChildWindow(_a[_d].frames));}}return _c;};m2nForm.m2n_create=function(objParent,strCompID,strCompName,strAttrib,strPersistData){if(typeof (objParent)=="string"){strAttrib=strCompName;strCompName=strCompID;strCompID=objParent;objParent=this;}if(this.m2n_isNull(objParent)){objParent=this;}var comp=this.m2n_getAllCommponents(objParent,strCompName);if(comp){return comp;}var newObj;if(strCompID.toLowerCase()=="dataset"){newObj=new Dataset;newObj.set_name(strCompName);objParent.addChild(strCompName,newObj);}else{var newObj=eval("new "+strCompID+"('"+strCompName+"')");newObj.init(strCompName,"absolute",0,0);objParent.addChild(strCompName,newObj);newObj.show();}if(this.m2n_isNull(strAttrib)){return newObj;}var attributes=this.m2n_makeArgumentArray(strAttrib);this.m2n_setProperty(newObj,attributes);return newObj;};m2nForm.m2n_setProperty=function(_a,_b,_c){var _d;for(var _e in _b){_d=_e;_e=this.m2n_toLower(_e);if(_a.hasOwnProperty(_e)||_a["set_"+_e]){try{_a["set_"+_e].call(_a,_b[_d]);}catch(e){trace("[m2n_setProperty]Property 설정 오류: "+_d);}}else{if(_d.indexOf("on")==0||_d.indexOf("can")==0){try{_a.setEventHandlerLookup(_e,_b[_d],this);}catch(e){trace("[m2n_setProperty]Property 설정 오류: "+_d);}}else{if(_c!=false){_a[_e]=_b[_d];}}}}};m2nForm.m2n_newWindow=function(_a,_b,_c,_d,_e,_f,_g,_h){var _i=new ChildFrame();var _j=_a;_b=this.m2n_replace(_b,".xml",".xfdl");_i.init(_a,"absolute",this.m2n_nvl(_g,0),this.m2n_nvl(_h,0),_d,_e);_i.set_formurl(_b);_i.formID=_a;nexacro.getApplication().MDIForms.addChild(_j,_i);_i.show();if(!this.m2n_isNull(_c)){var _k=this.m2n_makeArgumentArray(_c);for(var _m in newArguments){_i[_m]=newArguments[_m];}}if(this.m2n_isNull(_f)){return _j;}_f=String(_f).toLowerCase();var _l=this.m2n_split2(_f," ","=");for(var _n=0;_n<_l.length;_n++ ){switch(_l[_n][0]){case "titlebar":_i.set_showtitlebar(_l[_n][1]);break;case "resize":_i.set_resizable(_l[_n][1]);break;case "autosize":_i.set_autosize(_l[_n][1]);break;case "statusbar":_i.set_showstatusbar(_l[_n][1]);break;case "openstyle":if(_l[_n][1]=="max"){_i.set_openstatus("maximize");}else if(_l[_n][1]=="min"){_i.set_openstatus("minimize");}else if(_l[_n][1]=="normal"){_i.set_openstatus("normal");}break;case "max":_i.set_openstatus("maximize");break;default:break;}}return _j;};m2nForm.m2n_collection=function(_a,_b){var _c=new Array();for(var _d=0;_d<_a.all.length;_d++ ){comp=this.m2n_getType(_a.all[_d]);if(comp==_b){_c.push(_a.all[_d]);}}if(_c.length==0){return null;}return _c;};m2nForm.m2n_getCompPath=function(_a){if(_a==this){return "";}var _b=_a.name;var _c=_a.parent;while(_c!=this){_b=_c.name+"."+_b;_c=_c.parent;}return _b;};m2nForm.m2n_getTopForm=function(){var _a=nexacro.getApplication().getActiveFrame();if(!this.m2n_isNull(_a)){return _a.form;}return this.m2n_nvl(nexacro.getApplication().getActiveForm(),this);};m2nForm.m2n_getArgVal=function(_a){var _b=this.getOwnerFrame();return _b[_a]||"";};m2nForm.m2n_getDLLPath=function(_a){if(nexacro.getApplication().xadl.indexOf("file://")!=-1){var _b=nexacro.getApplication().xadl.replace("file://","");return nexacro.replaceAll(_b.substring(0,_b.lastIndexOf("/")),"/","\\")+"\\nexacro14lib\\"+_a;}else{return system.convertRealPath("%COMPONENT%\\"+_a);}};m2nForm.arrPath;m2nForm.m2n_lookupParent=function(_a,_b,_c){var _d;if(_c){this.arrPath.push(_c);}if(_a[_b]||_b in _a){return _a;}else if(_a.parent&&_a.parent!=nexacro.getApplication()&&(_d=this.m2n_lookupParent(_a.parent,_b,"parent"))){return _d;}else if(_a.opener&&_a.opener!=nexacro.getApplication()&&(_d=this.m2n_lookupParent(_a.opener,_b,"opener"))){return _d;}this.arrPath.pop();return null;};m2nForm.m2n_lookupPath=function(_a){this.arrPath=new Array();var _b;_b=this;this.arrPath.push("this");var _c=this.m2n_lookupParent(_b,_a,null);if(_c){trace("[X-LOG] ("+_a+")의 Path는 ['"+this.arrPath.join(".")+"."+_a+"']입니다. url: "+this._url);return _c[_a];}else if(nexacro.getApplication()[_a]){trace("[X-LOG] ("+_a+")의 Path는 ['nexacro.getApplication()"+"."+_a+"']입니다. url: "+this._url);return nexacro.getApplication()[_a];}trace("[X-LOG] m2n_lookupPath: 객체("+_a+")를 찾을 수 없습니다. url: "+this._url);return null;};m2nForm.m2n_getLookupVar=function(_a,_b){if(_b instanceof Dataset){_b=_b.name;}else{_b=_b.trim();}var _c=true,_d=_a;if(typeof (_a)=="string"){var _e=_a.split(".");_a=this;for(var _i=0,_j=_e.length;_i<_j;_i++ ){if(!_a){trace(">>>>>>>>> m2n_getLookupVar::: 해당 경로가 정확하지 않습니다.("+_e.join(".")+") ==> 객체명: "+_b+" url: "+this._url);return;}switch(_e[_i]){case "this":_a=this;break;case "parent":if(_a instanceof nexacro.Form&&_a.opener){_a=_a.opener;}else{_a=_a.parent;}break;default:_a=_a[_e[_i]];break;}}}_c=true;var _f=_a,_g,_h=false;while(_f){if(_f.hasOwnProperty(_b)){_g=_f[_b];_h=true;break;}if(_f instanceof nexacro.Frame&&_f.opener){_f=_f.opener;}else{_f=_f.parent;}}if(!_h){trace(">>>>>>>>> m2n_getLookupVar::: 해당 객체를 찾을 수 없습니다.("+_b+") ==> 해당 경로 : "+(_d.name||_d)+" url: "+(_d.name?_a._url:this._url));}return _g;};m2nForm.m2n_setLookupVar=function(_a,_b,_c){if(_b instanceof Dataset){_b=_b.name;}else{_b=_b.trim();}var _d=true,_e=_a;if(typeof (_a)=="string"){var _f=_a.split(".");_a=this;for(var _k=0,_l=_f.length;_k<_l;_k++ ){if(!_a){trace("m2n_setLookupVar::: 해당 경로가 정확하지 않습니다.("+_f.join(".")+") ==> 객체명: "+_b+" url: "+this._url);return;}switch(_f[_k]){case "this":_a=this;break;case "parent":if(_a instanceof nexacro.Form&&_a.opener){_a=_a.opener;}else{_a=_a.parent;}break;default:_a=_a[_f[_k]];break;}}}_d=true;var _g=_a,_h=_a,_i,_j=false;while(_g){if(_g.hasOwnProperty(_b)){_g[_b]=_c;_j=true;break;}if(_g instanceof nexacro.Frame&&_g.opener){_g=_g.opener;}else{_g=_g.parent;}}if(!_j){_h[_b]=_c;trace("m2n_setLookupVar::: 해당 객체를 찾을 수 없습니다.("+_b+") ==> 해당 경로 : "+(_e.name||_e)+" url: "+(_e.name?_a._url:this._url));}};m2nForm.m2n_executeLookupFunc=function(_a,_b,_c){_b=_b.trim();var _d=true,_e=_a;if(typeof (_a)=="string"){var _f=_a.split(".");_a=this;for(var _k=0,_l=_f.length;_k<_l;_k++ ){if(!_a){trace(">>>>>>>>> m2n_executeLookupFunc::: 해당 경로가 정확하지 않습니다.("+_f.join(".")+") ==> 함수명: "+_b+" url: "+this._url);return;}switch(_f[_k]){case "this":_a=this;break;case "parent":if(_a instanceof nexacro.Form&&_a.opener){_a=_a.opener;}else{_a=_a.parent;}break;default:_a=_a[_f[_k]];break;}}}_d=true;var _g=_a,_h,_i=false;while(_g){if(_g.hasOwnProperty(_b)){_h=_g[_b];_i=true;break;}if(_g instanceof nexacro.Frame&&_g.opener){_g=_g.opener;}else{_g=_g.parent;}}var _j;if(_i){if(_h&&(typeof (_h)=="function")){_j=_h.apply(_g,_c||[]);}else{trace(">>>>>>>>> m2n_executeLookupFunc::: 해당 명의 함수명이 function 객체가 아닙니다.("+_b+") ==> 해당 경로 : "+(_e.name||_e)+" url: "+(_e.name?_a._url:this._url));}}else{trace(">>>>>>>>> m2n_executeLookupFunc::: 해당 function을 찾을 수 없습니다.("+_b+") ==> 해당 경로 : "+(_e.name||_e)+" url: "+(_e.name?_a._url:this._url));}return _j;};m2nForm.m2n_callEventHandler=function(_a,_b,_c,_d){if(!_a||!_a[_b]){return;}if(typeof (_a[_b])!="function"){return;}var _e=arguments,_f={};if(_c){_c=_c.toLowerCase();}if(_c=="onclick"){_f.fromobject=_d;_f.fromreferenceobject=_d;}else if(_c=="onkeydown"){_f.keycode=_e[4];_f.shiftKey=_e[5];_f.ctrlKey=_e[6];_f.altKey=_e[7];_f.fromobject=_d;_f.fromreferenceobject=_d;}else if(_c=="onkillfocus"){_f.fromobject=_d;_f.fromreferenceobject=_d;}else if(_d instanceof Combo){if(_c=="onitemchanged"){_f.postindex=_e[7];_f.posttext=_e[5];_f.postvalue=_e[4];_f.preindex=_e[6];_f.fromobject=_d;_f.fromreferenceobject=_d;}else if(_c=="ontextchange"){_f.pretext=_e[4];_f.posttext=_e[5];_f.fromobject=_d;_f.fromreferenceobject=_d;}}else if(_d instanceof MaskEdit||_d instanceof Edit){if(_c=="onchanged"){_f.posttext=_e[4];_f.fromobject=_d;_f.fromreferenceobject=_d;}}else if(_d instanceof Radio){if(_c=="onitemchanged"){_f.postindex=_e[7];_f.posttext=_e[5];_f.postvalue=_e[4];_f.preindex=_e[6];_f.fromobject=_d;_f.fromreferenceobject=_d;}}else if(_c=="oncellclick"){_f.row=_e[4];_f.cell=_e[5];_f.clientX=_e[6];_f.clientY=_e[7];_f.fromobject=_d;_f.fromreferenceobject=_d;}else if(_c=="oncelldblclick"){_f.row=_e[4];_f.cell=_e[5];_f.col=_e[5];_f.clientX=_e[6];_f.clientY=_e[7];_f.fromobject=_d;_f.fromreferenceobject=_d;}else if(_c=="onrowposchanged"){_f.oldrow=_e[4];_f.newrow=_e[5];_f.fromobject=_d;_f.fromreferenceobject=_d;}else if(_c=="onheadclick"){_f.cell=_e[4];_f.col=_e[4];_f.clientX=_e[5];_f.clientY=_e[6];_f.fromobject=_d;_f.fromreferenceobject=_d;}else if(_c=="onexpandup"){_f.row=_e[4];_f.cell=_e[5];_f.col=_e[5];_f.clientX=_e[6];_f.clientY=_e[7];_f.fromobject=_d;_f.fromreferenceobject=_d;}else if(_c=="onsize"){_f.cx=_e[4];_f.cy=_e[5];_f.fromobject=_d;_f.fromreferenceobject=_d;}return _a[_b].call(_a,_d,_f);};m2nForm.m2n_setBindDataInfo=function(_a,_b,_c){if(this.m2n_toUpper(this.m2n_getType(_a))=="GRID"){_a.set_binddataset(_b);return;}_c=this.m2n_nvl(_c,_a.column);_b=this.m2n_nvl(_b,_a.binddataset);objBindItem=this.m2n_getBindItem(_a);if(objBindItem!=null){objBindItem.set_columnid(_c);objBindItem.set_datasetid(_b);objBindItem.bind();return;}var _d="value";switch(this.m2n_toUpper(this.m2n_getType(_a))){case "IMAGEVIEWER":bindItem=this.m2n_replace(this.m2n_getCompPath(_a),".","_")+"_"+"image";objBindItem=new BindItem(bindItem);objBindItem.init(bindItem,this.m2n_getCompPath(_a),"image",_b,_c);break;default:if(_a["set_value"]==undefined){_d="text";}bindItem=this.m2n_replace(this.m2n_getCompPath(_a),".","_")+"_"+_d;objBindItem=new BindItem(bindItem);objBindItem.init(bindItem,this.m2n_getCompPath(_a),_d,_b,_c);break;}this.addChild(bindItem,objBindItem);objBindItem.bind();};m2nForm.m2n_setBindColumn=function(_a,_b){_a.column=_b;this.m2n_setBindDataInfo(_a,_a.binddataset,_a.column);};m2nForm.m2n_setBindDataset=function(_a,_b){_a.binddataset=_b;this.m2n_setBindDataInfo(_a,_a.binddataset,_a.column);};m2nForm.m2n_getBindItem=function(_a){if(this.m2n_isNull(_a)){return null;}var _b=this.binds;var _c;var _d=this.m2n_toUpper(this.m2n_getCompPath(_a));for(var _e=0;_e<_b.length;_e++ ){_c=this.m2n_toUpper(_b[_e].compid);if(_c==_d){return _b[_e];}}return null;};m2nForm.m2n_getBindDataInfo=function(_a){var _b=this.m2n_getBindItem(_a);if(_a.binddataset){return this.lookup(_a.binddataset);}if(_b==null){return null;}return this.lookup(_b.datasetid);};m2nForm.m2n_getBindDataset=function(_a){if(!this.m2n_isNull(_a.binddataset)){return _a.binddataset;}var _b=this.m2n_getBindItem(_a);if(_b==null){return "";}return _b.datasetid;};m2nForm.m2n_getBindColumn=function(_a){var _b=this.m2n_getBindItem(_a);if(_b==null){return "";}return _b.columnid;};m2nForm.m2n_getTokenToArgArr=function(_a){var _b=_a.length;var _c={};var _d;var _e="";var _f="";var _g=true;for(var _h=0;_h<_b;_h++ ){_d=_a[_h];switch(_d[0]){case 0:if(_g==true){_e=_d[1];_g=false;}else{_f+=_d[1];}trace(" 0 name : "+_e+"<> value : "+_f);break;case 1:_g=false;break;case 2:case 3:case 4:_f=_d[1];trace(" 4 name : "+_e+"<> value : "+_f);if(_e!=""){_c[_e]=nexacro.stripQuote(_f);_g=true;_e="";_f="";}break;case 6:_f+=_d[1];break;case 5:if(_f!=""&&_e!=""){trace("5 name : "+_e+"<> value : "+_f);_c[_e]=nexacro.stripQuote(_f);_e="";_f="";}_g=true;break;}}return _c;};m2nForm.m2n_getMatchToken=function(_a,_b,_c,_d){var _e="[\\S\\s]";var _f=0;var _g=0;var _h="";var _i="";var _j=false;var _k=new Array();var _l;while(_f<_a.length){_j=false;for(var _m=0;_m<_b.length;_m++ ){_h=_b[_m][0];_i=_b[_m][1];_g=this.m2n_matchTokenType(_a,_h,_i,_f,_c);if(_g>_f){_l=_a.substr(_f,_g-_f);_k.push([_m,_l]);_f=_g;_j=true;break;}}if(_j==true){continue;}_g=this.m2n_matchTokenType(_a,"",_e,_f,_c);if(_g>_f){if(_d!=-1){_l=_a.substr(_f,_g-_f);_k.push([_d,_l]);}_f=_g;}}return _k;};m2nForm.m2n_matchTokenType=function(_a,_b,_c,_d,_e){if(this.m2n_isNull(_b)==false&&this.m2n_matchTokenString(_a,_b,_d)==false){return -1;}var _f=_a.substr(_d);var _g=new RegExp(_c,_e);var _h=_g.exec(_f);if(_h!=null&&_h.index==0){return _d+_h[0].length;}return -1;};m2nForm.m2n_matchTokenString=function(_a,_b,_c){return (_a.substr(_c,_b.length)==_b);};m2nForm.m2n_execProc=function(_a,_b){if(nexacro.Browser!="Runtime"){var _c={"message":"현재 브라우저에서는 실행할수 없습니다."};this.m2n_log({name:"m2n_execProcEx",msg:_c});return;}this.ext_ExecuteProccess(_a,_b);};m2nForm.m2n_execProcEx=function(_a,_b){if(nexacro.Browser!="Runtime"){var _c={"message":"현재 브라우저에서는 실행할수 없습니다."};this.m2n_log({name:"m2n_execProcEx",msg:_c});return;}var _d;_d=this.ext_ExecuteProccess(_a,_b);if(!_d){_d=null;}return _d;};m2nForm.m2n_idle=function(){this.sleep(100);};m2nForm.m2n_log=function(){if(typeof arguments[0]!="object"){return;}var _a=arguments[0]||{};var _b=arguments[0].name||"";var _c=arguments[0].msg||"";var _d=arguments[0].info||"info";var _e=this.m2n_dateFormatString(new Date(),"%Y/%m/%d %H:%M:%S");var _f,_g;var _h="\n";_h+="========================= DEBUG MESSAGE("+_d+") ==============";_h+="\n  (TimeStamp : "+_e+")";_h+="\n==============================================================";_h+="\n  [Name]      : "+_b;_h+="\n  [Browser]   : "+nexacro.Browser;_h+="\n  [Form]      : "+this.name;_h+="\n  [Arguments] : "+[].join.call(arguments.callee.caller.arguments);if(!this.m2n_isNull(_c)){_h+="\n======================== USER LOG ===========================";if(typeof _c=="object"){for(key in _c){_h+="\n  ["+key+"] : "+_c[key]+" ";}}else{_h+="\n  "+_c+" ";}}_h+="\n===================== COMPLETE MESSAGE ======================\n";if(_d=="error"){var _i=new Error(_h);throw _i;}else{nexacro.getApplication().trace(_h);}};m2nForm.m2n_isNull=function(_a){var _b=new String(_a);if(_b.valueOf()=="undefined"||_b==null||_b=="null"||_b.trim().length<=0){return true;}return false;};m2nForm.m2n_nvl=function(_a,_b){var _a=_a||_b;return _a;};m2nForm.m2n_isFunction=function(_a){return this.m2n_isToStringCall(_a)==='[object Function]';};m2nForm.m2n_isXaComponent=function(_a){if(_a===null||_a===undefined){return false;}return _a instanceof nexacro.Component;};m2nForm.m2n_isNumber=function(_a){return typeof _a==='number'&&isFinite(_a);};m2nForm.m2n_makeComponent=function(_a,_b){var _c=this.m2n_getType(_a);_c=_c.toLowerCase();switch(_c){case "combo":case "radio":this.m2n_makeContents(_a,_b);break;case "grid":this.m2n_makeGrid(_a,_b);break;case "dataset":this.m2n_makeDataset(_a,_b);break;case "tab":this.m2n_makeTab(_a,_b);break;case "div":case "popupdiv":default:for(i=0;i<_b.childNodes.length;i++ ){childNode=_b.childNodes[i];this.m2n_makeXmlComponent(_a,childNode);}break;}return false;};m2nForm.m2n_makeXmlComponent=function(objParent,childNode){if(!this.m2n_isElementNodeType(childNode)){return;}var tagName=childNode.tagName;var strCompName=this.m2n_getAttrVal(childNode.attributes,"id");tagName=this.m2n_getObjName(tagName);if(tagName==""){return;}var newObj=eval("new "+tagName+"('"+strCompName+"')");newObj.init(strCompName,"absolute",0,0);objParent.addChild(strCompName,newObj);newObj.set_top(0);newObj.set_left(0);newObj.show();if(this.m2n_isNull(childNode.attributes)){return newObj;}var attributes=this.m2n_makeAttributeArray(childNode.attributes);this.m2n_setProperty(newObj,attributes);if(!childNode.hasChildNodes()){return;}var contentsNode=childNode.firstChild;switch(tagName.toLowerCase()){case "combo":case "radio":this.m2n_makeContents(newObj,contentsNode);break;case "grid":this.m2n_makeGrid(newObj,contentsNode);break;case "dataset":this.m2n_makeDataset(newObj,contentsNode);break;case "tab":this.m2n_makeTab(newObj,contentsNode);break;case "div":case "popupdiv":default:this.m2n_makeXmlComponent(newObj,contentsNode);break;}return false;};m2nForm.m2n_makeTab=function(_a,_b){var _c;if(!_b||!_b.hasChildNodes()){return;}var _d=_b.childNodes;for(var _e=0;_e<_d.length;_e++ ){_c=_d[_e];if(!this.m2n_isElementNodeType(_c)){continue;}this.m2n_makeTabpageComponent(_a,_c);}};m2nForm.m2n_makeTabpageComponent=function(_a,_b){var _c=_b.tagName;var _d=this.m2n_getAttrVal(_b.attributes,"id");var _e=this.m2n_getAttrVal(_b.attributes,"text");var _f=this.m2n_getAttrVal(_b.attributes,"url");_c=this.m2n_getObjName(_c);if(_c==""){return;}var _g=_a.insertTabpage(_d,-1,_f,_e);var _h=_a.components[_g];if(this.m2n_isNull(_b.attributes)){return _h;}var _i=this.m2n_makeAttributeArray(_b.attributes);this.m2n_setProperty(_h,_i);var _j;var _k=_b.childNodes;for(var _l=0;_l<_k.length;_l++ ){_j=_k[_l];if(!this.m2n_isElementNodeType(_j)){continue;}this.m2n_makeXmlComponent(_h,_j);}};m2nForm.m2n_makeDataset=function(_a,_b){if(!_b||!_b.hasChildNodes()){return;}var _c=_b.childNodes;for(var _k=0;_k<_c.length;_k++ ){var _d=_c[_k];if(!this.m2n_isElementNodeType(_d)){continue;}switch(_d.nodeName.toLowerCase()){case "column":var _e=this.m2n_getAttrVal(_d.attributes,"id");var _f=this.m2n_getAttrVal(_d.attributes,"type");var _g=_d.text||"";_a.addConstColumn(_e,_g);break;case "colinfo":var _e=this.m2n_getAttrVal(_d.attributes,"id");var _f=this.m2n_getAttrVal(_d.attributes,"type");var _h=this.m2n_getAttrVal(_d.attributes,"size")||"256";_a.addColumn(_e,_f,_h);break;case "record":var _i=_a.addRow();if(_d.hasChildNodes()){var _j=_d.childNodes;for(var _l=0;_l<_j.length;_l++ ){child=_j[_l];if(child.nodeType=="1"&&child.hasChildNodes()&&child.firstChild.nodeType=="3"){_a.setColumn(_i,child.nodeName,this.m2n_nvl(child.firstChild.nodeValue,""));}}}break;}}};m2nForm.m2n_makeContents=function(_a,_b){if(!_b||!_b.hasChildNodes()){return;}var _c;var _d;var _e=new Dataset("innerdataset");_e.addColumn("codecolumn","string",256);_e.addColumn("datacolumn","string",256);_a.setInnerDataset(_e);_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");var _f;var _g;var _h;var _i;var _j=_b.childNodes;for(var _k=0;_k<_j.length;_k++ ){_i=_j[_k];if(!this.m2n_isElementNodeType(_i)){continue;}switch(_i.nodeName.toLowerCase()){case "layout":_f=this.m2n_getAttrVal(_i.attributes,"code");_g=this.m2n_getAttrVal(_i.attributes,"text");break;case "record":_f=this.m2n_getAttrVal(_i.attributes,"Code");_g=this.m2n_getAttrVal(_i.attributes,"Data");break;}_h=_e.addRow();_e.setColumn(_h,"codecolumn",_f);_e.setColumn(_h,"datacolumn",_g);}};m2nForm.m2n_makeGrid=function(_a,_b){var _c;var _d;var _e;var _f;var _g;if(!_b||!_b.hasChildNodes()){return;}if(_b.tagName.toLowerCase()!="contents"){_a.set_formats(nexacro._documentToXml(_b));return;}var _h=new DomParser;var _i=_h.parseFromString("<Formats/>");var _j=_i.documentElement;var _k=this.m2n_getElementNodeType(_b.firstChild);if(_k==null){return;}var _l=_b.childNodes;if(_k.nodeName.toLowerCase()=="format"){for(var _n=0;_n<_l.length;_n++ ){_k=_l[_n];if(!this.m2n_isElementNodeType(_k)){continue;}var _m=this.m2n_getAttrVal(_k.attributes,"id");if(_m=="Default"){_f="default";}else{_f=_m;}_g=this.m2n_appendCreateChild('<Format id="'+_f+'"/>',_j,0);this.m2n_makeGridFormat(_a,_k,_g,_j);}}else{_g=this.m2n_appendCreateChild('<Format id="default"/>',_j,0);this.m2n_makeGridFormat(_a,_b,_g,_j);}_a.set_formats(nexacro._documentToXml(_j));};m2nForm.m2n_getElementNodeType=function(_a){while(_a.nodeType!="1"){_a=_a.nextSibling;if(!_a){return null;}}return _a;};m2nForm.m2n_isElementNodeType=function(_a){return (_a.nodeType=="1");};m2nForm.m2n_makeGridFormat=function(_a,_b,_c,_d){if(!_b.hasChildNodes()){return;}var _e;var _f;var _g=_b.childNodes;for(var _h=0;_h<_g.length;_h++ ){_e=_g[_h];if(!this.m2n_isElementNodeType(_e)){continue;}switch(_e.nodeName.toLowerCase()){case "columns":_f=this.m2n_appendCreateChild('Columns',_c,1);this.m2n_makeGridColumns(_a,_e,_f,_c);_f=this.m2n_appendCreateChild('Rows',_c,1);this.m2n_makeGridRows(_a,_e,_f,_c);break;case "head":_f=this.m2n_appendCreateChild('<Band id="head"/>',_c,0);this.m2n_makeGridCell(_a,_e,_f,_c);break;case "body":_f=this.m2n_appendCreateChild('<Band id="body"/>',_c,0);this.m2n_makeGridCell(_a,_e,_f,_c);break;case "summary":_f=this.m2n_appendCreateChild('<Band id="summary"/>',_c,0);this.m2n_makeGridCell(_a,_e,_f,_c);break;}}};m2nForm.m2n_makeGridColumns=function(_a,_b,_c,_d){if(!_b.hasChildNodes()){return;}var _e;var _f=_b.childNodes;var _g;for(var _h=0;_h<_f.length;_h++ ){_e=_f[_h];if(!this.m2n_isElementNodeType(_e)){continue;}_g=this.m2n_appendCreateChild('Column',_c,1,_b,_c);this.m2n_setAttributes(_e,_g,_d);}};m2nForm.m2n_makeGridRows=function(_a,_b,_c,_d){if(!_b.parentNode.hasChildNodes()){return;}var _e;var _f;var _g;var _h;var _i;var _j;var _k=_b.parentNode.childNodes;var _l=this.m2n_nvl(_a.rowheight,18);var _m=this.m2n_nvl(_a.headheight,18);for(var _s=0;_s<_k.length;_s++ ){bandNode=_k[_s];if(!this.m2n_isElementNodeType(bandNode)||!bandNode.hasChildNodes()){continue;}var _n=bandNode.nodeName.toLowerCase();var _o=bandNode.childNodes;_h=-1;switch(_n){case "columns":break;case "summary":_n="summ";case "head":case "body":_j=0;for(var _t=0;_t<_o.length;_t++ ){_g=_o[_t];if(!this.m2n_isElementNodeType(_g)){continue;}var _p=this.m2n_nvl(this.m2n_getAttrVal(_g.attributes,"row"),0);var _q=this.m2n_nvl(this.m2n_getAttrVal(_g.attributes,"rowspan"),0);if(_q>0){_q=nexacro.toNumber(_q)-1;}var _r=nexacro.toNumber(_p)+nexacro.toNumber(_q);if(_r>_j){_j=_r;}}for(var _u=0;_u<=_j;_u++ ){if(_n=="body"){_i=this.m2n_createXFDLElement('<Row size="'+_l+'"/>',0);}else{_i=this.m2n_createXFDLElement('<Row size="'+_m+'" band="'+_n+'"/>',0);}_c.appendChild(_i);}break;}}};m2nForm.m2n_makeGridCell=function(_a,_b,_c,_d){if(!_b.hasChildNodes()){return;}var _e=_b.nodeName.toLowerCase();var _f=_b.firstChild;var _g;var _h;var _f;var _i=_b.childNodes;for(var _m=0;_m<_i.length;_m++ ){_f=_i[_m];if(!this.m2n_isElementNodeType(_f)){continue;}switch(_e){case "head":break;case "body":case "summary":break;}var _j=this.m2n_appendCreateChild('Cell',_c,1);this.m2n_setAttributes(_f,_j,_c);if(!_f.hasChildNodes()){continue;}var _k=_f.childNodes;for(var _n=0;_n<_k.length;_n++ ){child=_k[_n];if(!this.m2n_isElementNodeType(child)){continue;}switch(_e){case "head":break;case "body":case "summary":break;}var _l=this.m2n_appendCreateChild('Cell',_j,1);this.m2n_setAttributes(child,_l,_j);}}};m2nForm.m2n_setAttributes=function(_a,_b,_c){var _d=_a.attributes;for(var _e=0;_e<_d.length;_e++ ){attrItem=_d[_e];switch(attrItem.nodeName.toLowerCase()){case "width":_b.setAttribute("size",attrItem.nodeValue);break;case "colid":_b.setAttribute("text","bind:"+attrItem.nodeValue);break;default:_b.setAttribute(attrItem.nodeName.toLowerCase(),attrItem.nodeValue);break;}}};m2nForm.m2n_makeAttributeArray=function(_a){var _b=[];var _c;for(var _d=0;_d<_a.length;_d++ ){_c=_a[_d];_b[_c.nodeName]=_c.nodeValue;}return _b;};m2nForm.m2n_getAttrName=function(_a,_b){if(!_a){return "";}var _c;for(var _d=0;_d<_a.length;_d++ ){_c=_a[_d];if(_b.toLowerCase()==_c.nodeName.toLowerCase()){return _c.nodeName;}}return "";};m2nForm.m2n_getAttrVal=function(_a,_b){if(!_a){return "";}var _c;for(var _d=0;_d<_a.length;_d++ ){_c=_a[_d];if(_b.toLowerCase()==_c.nodeName.toLowerCase()){return _c.nodeValue;}}return "";};m2nForm.m2n_createXFDLElement=function(_a,_b){if(_b==1){return this.lv_xmlDoc.createElement(_a);}var _c=new DomParser;var _d=_c.parseFromString(_a);return _d.documentElement;};m2nForm.m2n_appendCreateChild=function(_a,_b,_c){return _b.appendChild(this.m2n_createXFDLElement(_a,_c));};m2nForm.m2n_isCheckDs=function(_a){var _b=this;var _c=this.lookup(_a);if(this.m2n_isNull(_c)){_c=new Dataset;_c.name=_a;_b.addChild(_a,_c);}else{_c.clearData();}return _c;};m2nForm.m2n_decode=function(){var _a=(arguments[0]==undefined)?null:arguments[0];for(var _b=1;_b<arguments.length;_b+=2){if(_b+1==arguments.length){return arguments[_b];}if(_a==arguments[_b]){return arguments[_b+1];}}return arguments[_b -2];};m2nForm.m2n_iif=function(_a,_b,_c){return _a?_b:_c;};m2nForm.m2n_getUniqueId=function(_a,_b){if(this.m2n_isNull(_a)){_a="";}if(this.m2n_isNull(_b)){_b=45;}else{_b=_b.charCodeAt(0);}var _c=this,_d=_c.lv_ALPHA_CHAR_CODES,_e=Math;var _f=0;var _g;var _h=new Array(36);var _i=-1;while(_f<8){_h[ ++_i]=_d[_e.random()* 16|0];_f++ ;}_f=0;while(_f<3){_h[ ++_i]=_b;_g=0;while(_g<4){_h[ ++_i]=_d[_e.random()* 16|0];_g++ ;}_f++ ;}_h[ ++_i]=_b;var _j=(new Date()).getTime();_j=("0000000"+_j.toString(16)).substr(-8);_f=0;while(_f<8){_h[ ++_i]=_j.charCodeAt(_f);_f++ ;}_f=0;while(_f<4){_h[ ++_i]=_d[_e.random()* 16|0];_f++ ;}return _a+String.fromCharCode.apply(null,_h);};m2nForm.m2n_isValid=function(_a){return this.m2n_isValidObject(_a);};m2nForm.m2n_left=function(_a,_b){var _c="";if(this.m2n_isNull(_a)){return _a;}if(this.m2n_isNull(_b)){_c=_a;}else{_c=_a.toString().substring(0,_b);}return _c;};m2nForm.m2n_lengthb=function(_a){var _b=arguments;var _c;var _d;if(this.m2n_isNull(_b[0])){return 0;}if(_b[0].components){return _b[0].components.length;}if(_b[0].constructor==Array){return _b[0].length;}var _e=_a.toString();var _f=0;for(var _g=0;_g<_e.length;_g++ ){if(_e.charCodeAt(_g)>127){_f+=2;}else{_f+=1;}}return _f;};m2nForm.m2n_mid=function(_a,_b,_c){var _d=arguments;if(_d.length==3){return String(_a).substr(_b,_c);}else{return String(_a).substr(_b);}};m2nForm.m2n_midb=function(_a,_b,_c){var _d=this.m2n_midb.arguments;var _e=_a.length;var _f=[];for(var _h=0,_i=0;_h<_e;_h++ ,_i++ ){if(_i==_b){_f=this.m2n_string2Array(_a.substr(_h),_f);break;}else if(_i>_b){_f.push(this.m2n_get2ByteChar1CodeNo(_a.substr(_h -1,1),false));_f=this.m2n_string2Array(_a.substr(_h),_f);break;}else{if(_a.charCodeAt(_h)>127){ ++_i;}}}if(_d.length<=2){return this.array2String(_f);}var _g=[];for(var _h=0,_j=0;_h<_f.length;_h++ ,_j++ ){if(_j==_c){_g=_f.slice(0,_h);break;}else if(_j>_c){_f[_h -1]=this.m2n_get2ByteChar1CodeNo(String.fromCharCode(_f[_h -1]),true);_g=_f.slice(0,_h -1);break;}if(_f[_h]>127){ ++_j;}}return this.m2n_array2String(_g);};m2nForm.m2n_get2ByteChar1CodeNo=function(_a,_b){var _c=_a.charCodeAt(0).toString(2).padLeft(16,"0");if(_b==true){_c=_c.substr(0,8);return parseInt(_c,2);}_c=_c.substr(8);return parseInt(_c,2);};m2nForm.m2n_string2Array=function(_a,_b){for(var _c=0;_c<_a.length;_c++ ){_b.push(_a.charCodeAt(_c));}return _b;};m2nForm.m2n_array2String=function(_a){return String.fromCharCode.apply(String,_a);};m2nForm.m2n_ntoken=function(_a,_b,_c){var _d=_a.split(_b);return _d[_c];};m2nForm.m2n_numFormat=function(_a,_b){if(this.m2n_isNull(_b)){_b=0;}return nexacro.toNumber(_a).toFixed(_b).toLocaleString();};m2nForm.m2n_pos=function(_a,_b,_c){if(this.m2n_isNull(_a)){return -1;}if(this.m2n_pos.length>=3){return _a.indexOf(_b,_c);}else{return _a.indexOf(_b);}};m2nForm.m2n_right=function(_a,_b){if(this.m2n_isNull(_a)){return "";}if(this.m2n_isNull(_b)){return _a;}if(_a.length<_b){return _a;}else{return _a.substr(_a.length-_b,_b);}};m2nForm.m2n_getTextSize=function(_a,_b){var _c=nexacro.getTextSize(_a,_b);var _d=new Array();_d[0]=_c.nx;_d[1]=_c.ny;return _d;};m2nForm.m2n_getTextExtent=function(_a,_b,_c){if(_a==undefined){return this.m2n_getTextSize(_b,_a.style);}var _d;if(typeof _a=="string"){_d=this.m2n_getObject(_a);}else if(_d instanceof Object){_d=_a;}var _e=_d.style;return this.m2n_getTextSize(_b,_e);};m2nForm.m2n_stripNum=function(_a){var _b=typeof (_a);if(_b=="string"){_a=new String(_a);_a=nexacro.replaceAll(_a,",","");_a=nexacro.replaceAll(_a,"$","");_a=nexacro.replaceAll(_a,"W","");_a=parseFloat(_a);return _a;}else if(_b=="int"||_b=="double"||_b=="decimal"){_a=parseFloat(_a);return _a;}else{_a=null;return _a;}};m2nForm.m2n_toNumber=function(_a,_b){var _c=typeof (_a);switch(_c){case "object":var _d=_a.getFullYear();var _e=_a.getMonth();var _f=_a.getDate();var _g=_a.getHours();var _h=_a.getMinutes();var _i=_a.getSeconds();var _j=_a.getMilliseconds();var _k=719528;var _l=new Date(Number(1970),Number(01)-1,Number(01));var _m=new Date(_d,_e,_f,_g,_h,_i,_j);var _n=_m.valueOf()/(24* 60* 60* 1000)-_l.valueOf()/(24* 60* 60* 1000)+_k;return _n;break;case "string":if(_b){var _o="";var _p="";var _q="";var _r="";var _s="";var _t="";if(_a.length>=8){_o=_a.substr(0,4);_p=_a.substr(4,2);_q=_a.substr(6,2);if(_a.length>=10){_r=_a.substr(8,2);}else{_r="00";}if(_a.length>=12){_s=_a.substr(10,2);}else{_s="00";}if(_a.length>=14){_t=_a.substr(12,2);}else{_t="00";}var _k=719528;var _l=new Date(Number(1970),Number(01)-1,Number(01));var _m=new Date(_o,nexacro.toNumber(_p)-1,_q,_r,_s,_t);var _n=_m.valueOf()/(24* 60* 60* 1000)-_l.valueOf()/(24* 60* 60* 1000)+_k;return _n;}}else{return parseFloat(_a);}break;default:return parseFloat(_a);break;}};m2nForm.m2n_parseDateTime=function(_a){var _b=typeof (_a);var _c;switch(_b){case "object":_c=_a;break;case "string":var _d="";var _e="";var _f="";var _g="";var _h="";var _i="";if(_a.length>=8){_d=_a.substr(0,4);_e=_a.substr(4,2);_f=_a.substr(6,2);if(nexacro.toNumber(_e)>12){return "00000101";}if(nexacro.toNumber(_f)>31){return "00000101";}if(_a.length>=10){_g=_a.substr(8,2);}else{_g="00";}if(_a.length>=12){_h=_a.substr(10,2);}else{_h="00";}if(_a.length>=14){_i=_a.substr(12,2);}else{_i="00";}_c=new Date(_d,_e,_f,_g,_h,_i);}else{return "00000101";}break;case "number":var _j=719528;var _k=new Date(Number(1970),Number(01)-1,Number(01));var _l=_a-_j;if(_l.toString().indexOf(".")>-1){return "00000101";}_c=new Date(_k);_c.setDate(_c.getDate()+_l);break;default:return "00000101";break;}var _d=_c.getFullYear().toString();_d=_d.padLeft(4,"0");var _e=(_c.getMonth()+1).toString();var _f=_c.getDate().toString();return _d+(_e[1]?_e:"0"+_e[0])+(_f[1]?_f:"0"+_f[0]);};m2nForm.m2n_split=function(_a,_b){return String(_a).split(_b);};m2nForm.m2n_split2=function(_a,_b,_c){var _d=[];var _e=this.m2n_split(_a,_b);for(var _f=0;_f<_e.length;_f++ ){_d.push(this.m2n_split(_e[_f],_c));}return _d;};m2nForm.m2n_full2Half=function(_a){var _b,_c,_d="";if(this.m2n_isNull(_a)&&this.m2n_isNull(name)){return "";}for(_b=0;_b<_a.length;_b++ ){_c=_a.charCodeAt(_b);if(_c==12288){_d+=unescape("%20");}else if((_c>=65281)&&(_c<=65374)){_d+=unescape("%"+(_c -65248).toString(16));}else{_d+=_a.charAt(_b);}}return _d;};m2nForm.m2n_half2Full=function(_a){var _b="";var _c="";var _d;if(this.m2n_isNull(_a)){return "";}for(_d=0;_d<_a.length;_d++ ){if((_a.charCodeAt(_d)>=32)&&(_a.charCodeAt(_d)<=126)){if(_a.charCodeAt(_d)==32){_c=unescape("%u"+(12288).toString(16));}else{_c=_a.charCodeAt(_d)+65248;}}else{_c=_a.charCodeAt(_d);}if(_a.charCodeAt(_d)==32){_b=_b+(_c);}else{_b=_b+String.fromCharCode(_c);}}return _b;};m2nForm.m2n_makeArgumentArray=function(_a){if(typeof _a=="object"){return _a;}var _b=[["","[^-\\d\\s~!#^&*=+|\\)\\(\\]\\[\\}\\{%~:;?\\\"<,.>\|/\\'][^-\\s~!#^&*=+|\\)\\(\\]\\[\\}\\{%~:;?\\\"<,.>\|/\\']*"],["","="],["'","'[^'\\\\]*(\\\\[\\S\\s]|[^'\\\\]*)*'"],['"','"[^"\\\\]*(\\\\[\\S\\s]|[^"\\\\]*)*"'],["","[0-9]+(\\.[0-9]*)?"],["","[ \\t\\n\\r]+"],["","[\\S]+"]];var _c=this.m2n_getMatchToken(_a,_b,"m",-1);trace(" TokenArray : "+_c);return this.m2n_getTokenToArgArr(_c);};m2nForm.m2n_isValidObject=function(_a){if(typeof _a=="string"){if(this.m2n_getObject(_a)){return true;}}else if(_a instanceof Object){return (_a.toString().indexOf("object")>-1);}return false;};m2nForm.m2n_isToStringCall=function(_a){var _b=(Object.prototype.toString);return _b.call(_a);};m2nForm.m2n_setJSONToString=function(_a){var _b=(_a.join&&_a.pop&&_a.push&&_a.reverse&&_a.shift&&_a.slice&&_a.splice);var _c=[];for(var _e in _a){var _d=_a[_e];_c.push((_b?"":"\""+_e.toString()+"\" : ")+(typeof _d=="string"?"\""+_d+"\"":_d));}return (_b?"[":"{")+_c.join(", ")+(_b?"]":"}");};m2nForm.m2n_greatest=function(){var _a;var _b=this.m2n_greatest.arguments;_a=_b[0];for(i=0;i<_b.length;i++ ){if(_b[i]>_a){_a=_b[i];}}return _a;};m2nForm.m2n_least=function(){var _a;var _b=this.m2n_least.arguments;_a=_b[0];for(i=0;i<_b.length;i++ ){if(_b[i]<_a){_a=_b[i];}}return _a;};m2nForm.m2n_time=function(){var _a=new Date();var _b=Math.round(_a.getTime()/1000);return _b;};m2nForm.m2n_timen=function(){var _a=new Date();var _b=_a.getTime();return _b;};m2nForm.m2n_isInf=function(_a){if(_a<=Number.NEGATIVE_DECIMALMAX||_a>=Number.POSITIVE_DECIMALMAX){return true;}return false;};m2nForm.m2n_asc=function(_a){if(this.m2n_isNull(_a)){return 0;}return _a.charCodeAt(0);};m2nForm.m2n_bound=function(_a){if(this.m2n_isNull(_a)){return 0;}if(_a.components){return _a.components.length;}else{return _a.length;}};m2nForm.m2n_ltrim=function(_a){this.m2n_lTrimCase(_a,"");};m2nForm.m2n_length=function(_a){if(this.m2n_isNull(_a)){return 0;}if(_a.components){return _a.components.length;}else{if(this.m2n_getType(_a)=="Dataset"){return _a.rowcount;}return this.m2n_nvl(_a.length,0);}};m2nForm.m2n_rtrim=function(_a){this.m2n_rTrimCase(_a,"");};m2nForm.m2n_textToBin=function(_a){if(this.m2n_isNull(_a)){return "";}var _b=new Buffer(_a);return _b.data;};m2nForm.m2n_toLower=function(_a){if(this.m2n_isNull(_a)){return "";}return String(_a).toLowerCase();};m2nForm.m2n_toLowerCase=function(_a){if(this.m2n_isNull(_a)){return "";}return String(_a).toLowerCase();};m2nForm.m2n_toString=function(_a){if(this.m2n_isNull(_a)){return "";}return String(_a).toString();};m2nForm.m2n_toUpper=function(_a){if(this.m2n_isNull(_a)){return "";}return String(_a).toUpperCase();};m2nForm.m2n_toUpperCase=function(_a){if(this.m2n_isNull(_a)){return "";}return String(_a).toUpperCase();};m2nForm.m2n_trim=function(_a){if(this.m2n_isNull(_a)){return "";}return nexacro.trim(_a);};m2nForm.m2n_aliasToRealPath=function(_a){if(this.m2n_isNull(_a)){return "";}return system.convertRealPath(_a);};m2nForm.m2n_urlEncode=function(_a){return this.ext_setURLencode(_a);};m2nForm.m2n_urlDecode=function(_a){return this.ext_getURLdecode(_a);};m2nForm.m2n_getType=function(_a){if(!this.m2n_isNull(_a)){return _a.toString().replace("object","").replace("[","").replace("]","").trim();}};m2nForm.m2n_moveWindow=function(_a,_b,_c,_d,_e){var _f=_b+_d;var _g=_c+_e;_a.move(_b,_c,_d,_e,_f,_g);};m2nForm.m2n_setFont=function(_a,_b,_c,_d){return _a.style.set_font(_b+","+_c+","+strType);};m2nForm.m2n_isComposite=function(_a){if(_a.components){return true;}else{return false;}};m2nForm.m2n_appendDataset=function(_a,_b){var _c=_b.toString().valueOf().substr(1,6);if(_c.toLowerCase()=="object"){_a.appendData(_b);}else{_a.appendData(this.lookup(_b));}};m2nForm.m2n_caseAvgNF=function(_a,_b,_c,_d,_e){var _f;var _g=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");if(this.m2n_isNull(_d)){_d=0;}if(this.m2n_isNull(_e)){_e=-1;}else{_e=_e+1;}_f=_a.getCaseAvg(_b,_c,_d,_e);_a.filter(_g);_a.set_enableevent(true);return _f;};m2nForm.m2n_totalCaseCount=function(_a,_b,_c,_d){if(this.m2n_isNull(_c)){_c=0;}return _a.getCaseCount(_b,_c,-1);};m2nForm.m2n_onrowsetchanged=function(_a,_b){var _c;switch(_b.reason){case Dataset.REASON_APPEND:if(!this.m2n_isNull(_a.onrowinserted)){_c=this.lookup(_a.onrowinserted);if(_c!=null){nexacro._OnceCallbackTimer.callonce(this,function(){_c.call(this,_a,_b.row,_b.count);},10);}}break;case Dataset.REASON_DELETE:if(!this.m2n_isNull(_a.onrowdeleted)){_c=this.lookup(_a.onrowdeleted);if(_c!=null){nexacro._OnceCallbackTimer.callonce(this,function(){_c.call(this,_a,_b.row,_b.count);},10);}}break;}};m2nForm.m2n_dsSetInsertDeleteEvent=function(_a,_b,_c){_b=this.m2n_toLower(_b);_a[_b]=_c;_a.setEventHandler("onrowsetchanged",this.m2n_onrowsetchanged,this);};m2nForm.m2n_caseCountNF=function(_a,_b,_c,_d){var _e;var _f=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");if(this.m2n_isNull(_c)){_c=0;}if(this.m2n_isNull(_d)){_d=-1;}else{_d=_d+1;}_e=_a.getCaseCount(_b,_c,_d);_a.filter(_f);_a.set_enableevent(true);return _e;};m2nForm.m2n_totalAvg=function(_a,_b,_c,_d){var _e;var _f=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");if(this.m2n_isNull(_c)){_c=0;}if(this.m2n_isNull(_d)){_d=-1;}else{_d=_d+1;}_e=_a.getAvgNF(_b,_c,_d);_a.filter(_f);_a.set_enableevent(true);return _e;};m2nForm.m2n_setTotalColumn=function(_a,_b,_c,_d){var _e;var _f=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");_a.setColumn(_b,_c,_d);_a.filter(_f);_a.set_enableevent(true);};m2nForm.m2n_setUpdate=function(_a,_b){if(!_b){_a.set_updatecontrol(false);}else{_a.set_updatecontrol(true);}};m2nForm.m2n_copyColumn=function(_a,_b,_c,_d,_e,_f){var _g;if(_d instanceof Dataset){_g=_d;}else{_g=this.m2n_getLookupVar(this,_d);}if(this.m2n_isNull(_g)){trace("****** m2n_copyColumn에서 "+_d+" 데이타셋을 찾을 수 없어 copy할 수 없습니다. **********");return;}_a.copyRow(_b,_g,_e,_c+"="+_f);};m2nForm.m2n_copyToColumn=function(_a,_b,_c,_d,_e,_f){var _g;if(_d instanceof Dataset){_g=_d;}else{_g=this.m2n_getLookupVar(this,_d);}if(this.m2n_isNull(_g)){trace("****** m2n_copyToColumn에서 "+_d+" 데이타셋을 찾을 수 없어 copy할 수 없습니다. **********");return;}_g.copyRow(_e,_a,_b,_f+"="+_c);};m2nForm.m2n_copyToRow=function(_a,_b,_c,_d,_e){if(this.m2n_isNull(_e)){_e="";}var _f;if(_c instanceof Dataset){_f=_c;}else{_f=this.m2n_getLookupVar(this,_c);}if(this.m2n_isNull(_f)){trace("****** m2n_copyToRow에서 "+_c+" 데이타셋을 찾을 수 없어 copy할 수 없습니다. **********");return;}_f.copyRow(_d,_a,_b,_e);};m2nForm.m2n_countNF=function(_a,_b){if(this.m2n_isNull(_b)){return _a.getCountNF();}else{return _a.getCountNF(_b);}};m2nForm.m2n_getFirstRow=function(_a){var _b=_a.getRowCount();if(_b>0){return 0;}else{return -1;}};m2nForm.m2n_getLastRow=function(_a){var _b=_a.getRowCount();if(_b>0){return _b-1;}else{return -1;}};m2nForm.m2n_getNextRow=function(_a){var _b=_a.getRowCount();if(_b>0){if(_a.rowposition==_a.getRowCount()-1){return _a.rowposition;}else{return _a.rowposition+1;}}else{return -1;}};m2nForm.m2n_getPrevRow=function(_a){var _b=_a.getRowCount();if(_b>0){if(_a.rowposition==0){return _a.rowposition;}else{return _a.rowposition-1;}}else{return 0;}};m2nForm.m2n_getColIndex=function(_a,_b){var _c;for(var _d=0;_d<_a.getColCount();_d++ ){if(_a.getColID(_d).toLowerCase()==_b.toLowerCase()){_c=_d;break;}}return _c;};m2nForm.m2n_getUpdate=function(_a){this.m2n_applyData();if(_a.updatecontrol){if(_a.getDeletedRowCount()>0){return true;}}if(_a.findRowExpr("(dataset.getRowType(currow)==4)||(dataset.getRowType(currow)==2)")>-1){return true;}if(_a.getMaxNF("(dataset.getRowLevel(currow)==0 && dataset.getRowType(currow) > 1)")==true){return true;}return false;};m2nForm.m2n_getRowType=function(_a,_b){var _c;var _d=_a.getRowType(_b);if(_d==1){_c="normal";}else if(_d==2){_c="insert";}else if(_d==4){_c="update";}else if(_d==8){_c="delete";}else if(_d==16){_c="logical";}else if(_d==0){_c="normal";}return _c;};m2nForm.m2n_getRowTypeNF=function(_a,_b){var _c;var _d=_a.getRowTypeNF(_b);if(_d==1){_c="normal";}else if(_d==2){_c="insert";}else if(_d==4){_c="update";}else if(_d==8){_c="delete";}else if(_d==16){_c="logical";}else if(_d==0){_c="normal";}return _c;};m2nForm.m2n_setRowType=function(_a,_b,_c){var _d=_c.toLowerCase();if(_d=="update"){_d=Dataset.ROWTYPE_UPDATE;}else if(_d=="insert"){_d=Dataset.ROWTYPE_INSERT;}else if(_d=="delete"){_d=Dataset.ROWTYPE_DELETE;}else{_d=Dataset.ROWTYPE_NORMAL;}_a.setRowType(_b,_d);};m2nForm.m2n_setColumnNF=function(_a,_b,_c,_d){var _e;var _f=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");_e=_a.setColumn(_b,_c,_d);_a.filter(_f);_a.set_enableevent(true);return _e;};m2nForm.m2n_merge=function(_a,_b){var _c=_b.toString().valueOf().substr(1,6);if(_c.toLowerCase()=="object"){_a.mergeData(_b);}else{_a.mergeData(this.lookup(_b));}};m2nForm.m2n_copy=function(_a,_b){if(this.m2n_isNull(_a)){trace("****** m2n_copy에서 Copy 될 데이타셋이 존재하지 않습니다. **********");return null;}if(this.m2n_isNull(_b)){trace("****** m2n_copy에서 Copy 할 데이타셋이 존재하지 않습니다. **********");return null;}var _c;if(_b instanceof Dataset){_c=_b;}else{_c=this.m2n_getLookupVar(this,_b);}if(this.m2n_isNull(_c)){trace("****** m2n_copy에서 "+_b+" 데이타셋을 찾을 수 없어 copy할 수 없습니다. **********");return;}_a.copyData(_c);};m2nForm.m2n_copyF=function(_a,_b){if(this.m2n_isNull(_a)){trace("****** m2n_copyF에서 Copy 될 데이타셋이 존재하지 않습니다. **********");return null;}if(this.m2n_isNull(_b)){trace("****** m2n_copyF에서 Copy 할 데이타셋이 존재하지 않습니다. **********");return null;}var _c;if(_b instanceof Dataset){_c=_b;}else{_c=this.m2n_getLookupVar(this,_b);}if(this.m2n_isNull(_c)){trace("****** m2n_copyF에서 "+_b+" 데이타셋을 찾을 수 없어 copy할 수 없습니다. **********");return;}_a.copyData(_c,true);};m2nForm.m2n_searchRowNF=function(_a,_b,_c){var _d;var _e=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");if(this.m2n_isNull(_c)){_c=0;}_d=_a.findRowExpr(_b,_c);_a.filter(_e);_a.set_enableevent(true);return _d;};m2nForm.m2n_findRowNF=function(_a,_b,_c,_d,_e){var _f;var _g=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");if(this.m2n_isNull(_d)){_d=0;}if(this.m2n_isNull(_e)){_e=-1;}else{_e=_e+1;}_f=_a.findRow(_b,_c,_d,_e);_a.filter(_g);_a.set_enableevent(true);return _f;};m2nForm.m2n_totalSum=function(_a,_b,_c,_d){if(this.m2n_isNull(_c)){_c=0;}if(this.m2n_isNull(_d)){_d=-1;}else{_d=_d+1;}return _a.getSumNF(_b,_c,_d);};m2nForm.m2n_totalMin=function(_a,_b,_c,_d){if(this.m2n_isNull(_c)){_c=0;}if(this.m2n_isNull(_d)){_d=-1;}else{_d=_d+1;}return _a.getMinNF(_b,_c,_d);};m2nForm.m2n_caseMaxNF=function(_a,_b,_c,_d,_e){var _f;var _g=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");if(this.m2n_isNull(_d)){_d=0;}if(this.m2n_isNull(_e)){_e=-1;}else{_e=_e+1;}_f=_a.getCaseMax(_b,_c,_d,_e);_a.filter(_g);_a.set_enableevent(true);return _f;};m2nForm.m2n_caseMinNF=function(_a,_b,_c,_d,_e){var _f;var _g=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");if(this.m2n_isNull(_d)){_d=0;}if(this.m2n_isNull(_e)){_e=-1;}else{_e=_e+1;}_f=_a.getCaseMin(_b,_c,_d,_e);_a.filter(_g);_a.set_enableevent(true);return _f;};m2nForm.m2n_caseSumNF=function(_a,_b,_c,_d,_e){var _f;var _g=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");if(this.m2n_isNull(_d)){_d=0;}if(this.m2n_isNull(_e)){_e=-1;}else{_e=_e+1;}_f=_a.getCaseSum(_b,_c,_d,_e);_a.filter(_g);_a.set_enableevent(true);return _f;};m2nForm.m2n_totalMax=function(_a,_b,_c,_d){if(this.m2n_isNull(_c)){_c=0;}if(this.m2n_isNull(_d)){_d=-1;}else{_d=_d+1;}return _a.getMaxNF(_b,_c,_d);};m2nForm.m2n_loadDataset=function(_a,_b){if(!this.m2n_isNull(_b)){_a.set_url(_b);}_a.load();};m2nForm.m2n_getTotalRowType=function(_a,_b){var _c;var _d=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");var _e=_a.getRowType(_b);if(_e==1){_c="normal";}else if(_e==2){_c="insert";}else if(_e==4){_c="update";}else if(_e==8){_c="delete";}else if(_e==16){_c="logical";}else if(_e==0){_c="normal";}_a.filter(_d);_a.set_enableevent(true);return _c;};m2nForm.m2n_getColSize=function(_a,_b){if(_a==null){return 256;}var _c=_a.getColumnInfo(_b);if(this.m2n_isNull(_c)){return -1;}else{return _c.size;}};m2nForm.m2n_getColType=function(_a,_b){if(_a==null){return "STRING";}var _c=_a.getColumnInfo(_b);return _c.type;};m2nForm.m2n_getORgBuffCount=function(_a){return _a.getSumNF("(getRowType(currow)!=2)")+_a.getDeletedRowCount();};m2nForm.m2n_getOrgColumn=function(_a,_b,_c){var _d=_a.getOrgColumn(_b,_c);if(this.m2n_isNull(_d.valueOf())==true){_d="";}return _d;};m2nForm.m2n_getOrgColumnNF=function(_a,_b,_c){var _d;var _e=_a.filterstr.valueOf();_a.set_enableevent(false);_a.filter("");_d=_a.getOrgColumn(_b,_c);_a.filter(_e);_a.set_enableevent(true);if(this.m2n_isNull(_d.valueOf())==true){_d="";}return _d;};m2nForm.m2n_changeColWidth=function(_a,_b,_c,_d,_e){if(this.m2n_isNull(_a)){return;}if(this.m2n_isNull(_c)){return;}if(this.m2n_isNull(_d)){return;}_e=this.m2n_nvl(_e,"body");var _f=_a.getCellProperty(_e,_c,"col");_a.setFormatColProperty(_f,"size",_d);};m2nForm.m2n_changeRowHeight=function(_a,_b,_c,_d,_e){_a.setFormatRowProperty(_c,"size",_d);};m2nForm.m2n_doScroll=function(_a,_b){if(this.m2n_isNull(_b)){return;}strSrcoll=_b.toUpperCase();switch(strSrcoll){case "SCROLLBARDOWN":_a.vscrollbar.position=_a.vscrollbar.max;break;case "SCROLLBARUP":_a.vscrollbar.position=_a.vscrollbar.min;break;}};m2nForm.m2n_getItem=function(_a,_b){var _c=_a.components[_b];return _c;};m2nForm.m2n_getImageSize=function(_a){var _b=new Array(2);_b[0]=_a.imagewidth;_b[1]=_a.imageheight;return _b;};m2nForm.m2n_getCellText=function(_a,_b,_c,_d,_e,_f){var _g;_b=_b.toLowerCase();if(_b=="head"){_g=-1;}else if(_b=="summ"||_b=="summary"){_g=-2;}else{_g=_c;}return _a.getCellText(_g,_d,0);};m2nForm.m2n_getTreeRow=function(_a,_b){if(typeof (_b)=="number"){return _b;}return _a.getTreeRow(_b);};m2nForm.m2n_getTreePath=function(_a,_b,_c){return _a.getTreePath(_b,true);};m2nForm.m2n_childCount=function(_a,_b){var _c=_a.getTreeRow(_b);return _a.getTreeChildCount(_c,true);};m2nForm.m2n_getChildRow=function(_a,_b,_c){var _d=_a.getTreeRow(_b);return _a.getTreeChildRow(_d,_c,true);};m2nForm.m2n_expandItem=function(_a,_b,_c,_d){var _e=_a.getTreeRow(_b);return _a.setTreeStatus(_e,_c);};m2nForm.m2n_getParentRow=function(_a,_b){return _a.getTreeParentRow(_b,true);};m2nForm.m2n_getSiblingRow=function(_a,_b,_c){return _a.getTreeSiblingRow(_b,_c,false);};m2nForm.m2n_isLeaf=function(_a,_b){var _c=_a.isTreeLeafRow(_b,false);if(_c){return 1;}else{return 0;}};m2nForm.m2n_isExpanded=function(_a,_b){var _c=_a.getTreeStatus(_b,true);if(_c==3){return -1;}else{return _c;}};m2nForm.m2n_isRoot=function(_a,_b){var _c=_a.isTreeRootRow(_b,false);if(_c){return 1;}else{return 0;}};m2nForm.m2n_getItemRow=function(_a,_b){if(typeof (_b)=="number"){return _b;}return _a.getTreeRow(_b);};m2nForm.m2n_getItemPath=function(_a,_b,_c){return _a.getTreePath(_b,true);};m2nForm.m2n_getCellRect=function(_a,_b,_c){var _d,_e;_d=_a.getCellRect(_b,_c);_e=new Array(6);_e[0]=_d.left;_e[1]=_d.top;_e[2]=_d.right;_e[3]=_d.bottom;_e[4]=_d.width;_e[5]=_d.height;return _e;};m2nForm.m2n_getHandle=function(_a){if(this.m2n_isNull(_a)){_a=this;}return _a.getOwnerFrame().name;};m2nForm.m2n_getForm=function(_a){if(!_a){_a=this;}return _a.parent;};m2nForm.m2n_getTypeOf=function(_a){return (Object.prototype.toString).call(_a);};m2nForm.m2n_exprRowPosition=function(_a){var _b=_a.rowposition;return _b;};m2nForm.m2n_exprGetPrevRow=function(_a){var _b;if(_a==0){_b=_a;}else{_b=_a-1;}return _b;};m2nForm.m2n_exprGetNextRow=function(_a,_b){var _c;if(_b==_a.rowcount-1){_c=_b;}else{_c=_b+1;}return _c;};m2nForm.m2n_exprGetFirstRow=function(_a){var _b=_a.rowcount;if(_b>0){return 0;}else{return -1;}};m2nForm.m2n_exprGetLastRow=function(_a){var _b=_a.rowcount;if(_b>0){return _b-1;}else{return -1;}};m2nForm.m2n_exprGetRowType=function(_a,_b){var _c=_b;var _d;var _e=_a.getRowType(_c);if(_e==1){_d="normal";}else if(_e==2){_d="insert";}else if(_e==4){_d="update";}else if(_e==8){_d="delete";}else if(_e==16){_d="logical";}else if(_e==0){_d="normal";}return _d;};m2nForm.m2n_exprRowLevel=function(_a,_b){var _c=_b;var _d=_a.getRowLevel(_c);return _d;};m2nForm.m2n_exprRowCountNF=function(_a){var _b=_a.getCountNF();return _b;};m2nForm.m2n_exprRangeCount=function(_a,_b){var _c=_b;var _d=_a.getGroupRangeCount(_c);return _d;};m2nForm.m2n_exprRangeStart=function(_a,_b){var _c=_b;var _d=_a.getGroupRangeStart(_c);return _d;};m2nForm.m2n_exprRowCount=function(_a){var _b=_a.getRowCount();return _b;};m2nForm.m2n_getCSVData=function(_a,_b){var _c=_b;if(_c==null||_c==""){_c=false;}var _d=_a._curFormat;var _e=_a._curFormat._bodycells;var _f=_d._bodycells.length;var _g=_a._getGridRowCount(true);var _h,_i;var _j=[];var _k="";if(_c){for(var _m=0;_m<_g;_m++ ){for(var _n=0;_n<_f;_n++ ){if(_a.isSelectedCell(_n,"Body",_m)){_k=_a.getCellValue(_m,_n);if(_h){if(_h.indexOf(",")){_k+="\""+_h+"\"";}}if(_a.isSelectedCell(_n+1,"Body",_m)){_k+=",";}else{_k+="\n";}_j[_j.length]=_k;}}}}else{for(var _m=0;_m<_g;_m++ ){for(var _n=0;_n<_f;_n++ ){_k=_a.getCellValue(_m,_n);if(_h){if(_h.indexOf(",")){_k+="\""+_h+"\"";}}if(_n==(_f -1)){_k+="\n";}else{_k+=",";}_j[_j.length]=_k;}}}var _l=_j.join("");return _l;};m2nForm.m2n_redraw=function(_a,_b){if(typeof (_a)!="object"){return -1;}if(typeof (_b)!="boolean"){return -1;}_a.set_enableredraw(_b);};m2nForm.m2n_getRowHeight=function(_a){if(this.m2n_isNull(_a)){return;}return _a.getFormatRowProperty(0,"size");};m2nForm.m2n_setRowHeight=function(_a,_b){if(this.m2n_isNull(_a)){return;}var _c=_a.getFormatRowCount();for(var _d=0;_d<_c;_d++ ){_a.setFormatRowProperty(_d,"size",_b);}};m2nForm.m2n_getHeadHeight=function(_a){if(this.m2n_isNull(_a)){return;}return _a.getFormatRowProperty(0,"size");};m2nForm.m2n_setHeadHeight=function(_a,_b){if(this.m2n_isNull(_a)){return;}var _c;var _d=_a.getFormatRowCount();for(var _e=0;_e<_d;_e++ ){_c=_a.getFormatRowProperty(_e,"band");_c=_c.toLowerCase();if(_c=="head"||_c=="summ"||_c=="summary"){_a.setFormatRowProperty(_e,"size",_b);}}};m2nForm.m2n_GetColMapValue=function(_a,_b){var _c=_a.getColumnInfo(_b);if(_c==null){return "";}return _c.name;};m2nForm.m2n_isAboveSel=function(_a){if(_a._status&&_a._status=="focus"){return true;}else{return false;}};m2nForm.m2n_setContents=function(_a,_b){var _c=new DomParser;var _d=this.m2n_getType(_a);_d=_d.toLowerCase();if(_d=="tabpage"){_b="<Contents>"+_b+"</Contents>";}this.lv_xmlDoc=_c.parseFromString(_b);var _e=this.lv_xmlDoc.documentElement;if(!_e.hasChildNodes()){return;}this.m2n_makeComponent(_a,_e);};m2nForm.m2n_getObjName=function(_a){var _b=_a.toLowerCase();switch(_b){case "button":return "Button";break;case "calendar2":case "calendar":return "Calendar";break;case "checkbox":return "CheckBox";break;case "combo":return "Combo";break;case "dataset":return "Dataset";break;case "div":return "Div";break;case "edit":return "Edit";break;case "file":return "MPFile";break;case "filedialog":return "MPFileDialog";break;case "grid":return "Grid";break;case "image":return "ImageViewer";break;case "list":return "ListBox";break;case "maskedit":return "MaskEdit";break;case "menubar":return "Menu";break;case "popupdiv":return "PopupDiv";break;case "radio":return "Radio";break;case "shape":case "static":return "Static";break;case "spin":return "Spin";break;case "tab":return "Tab";break;case "tabpage":return "Tabpage";break;case "textarea":return "TextArea";break;default:trace("[m2n_getObjName] 등록되지 않은 컴포넌트입니다. 확인해서 등록해 주세요.");return "";break;}};m2nForm.m2n_getColidProperty=function(_a){if(this.m2n_isNull(_a)){return "";}arrText=_a.split(":");if(arrText.length==2){return arrText[1];}return _a;};m2nForm.m2n_getExpandCellValue=function(_a,_b){var _c;var _d=this.all[_a.binddataset];if(this.m2n_isNull(_d)){return null;}var _e=this.m2n_getColidProperty(_a.getCellProperty("Body",_b.cell,"text"));return _d.getColumn(_b.row,_e);};m2nForm.m2n_setGridCellCheckFlag=function(_a,_b,_c,_d){_a.setCellProperty(_b,_c,this.lv_checkProp,this.lv_checkPrefix+this.m2n_nvl(_d,""));};m2nForm.m2n_getGridCellCheckFlag=function(_a,_b,_c){var _d=_a.getCellProperty(_b,_c,this.lv_checkProp);_d=this.m2n_lTrimCase(_d,this.lv_checkPrefix);return _d;};m2nForm.m2n_sort=function(_a,_b,_c){if(!_a||!(_a instanceof Dataset)){return;}var _d;var _e;var _f=_a._keycols?_a._keycols.slice(0):[],_g,_h,_i=0,_j=(_f&&_f.length);if(_j){for(var _m=0,_n=_f.length;_m<_n;_m++ ){if(_f[_m].level>0){_i=_m;break;}}}function find_sortcolumn(_o){for(var _m=0,_n=_f.length;_m<_n;_m++ ){if(_f[_m].colid==_o){return _m;}}return -1;}if(_b.indexOf(":")>0){_e=_b.split(",");for(var _m=0;_m<_e.length;_m++ ){if(_e[_m].indexOf(":D")>0){_g=this.m2n_rTrimCase(_e[_m],":D");if((_h=find_sortcolumn(_g))>-1){_f[_h].descending=true;}else{_f.splice(_i,0,{level:0,colid:_g,descending:true});_i++ ;}}else if(_e[_m].indexOf(":A")>0){_g=this.m2n_rTrimCase(_e[_m],":A");if((_h=find_sortcolumn(_g))>-1){_f[_h].descending=false;}else{_f.splice(_i,0,{level:0,colid:_g,descending:false});_i++ ;}}else if(_e[_m].indexOf(":")==-1){_g=this.m2n_rTrimCase(_e[_m],":A");if((_h=find_sortcolumn(_g))>-1){_f[_h].descending=false;}else{_f.splice(_i,0,{level:0,colid:_g,descending:false});_i++ ;}}}}else{if(this.m2n_isNull(_c)){_c=true;}if(_c){_e=_b.split(",");for(var _m=0;_m<_e.length;_m++ ){_g=_e[_m];if((_h=find_sortcolumn(_g))>-1){_f[_h].descending=false;}else{_f.splice(_i,0,{level:0,colid:_g,descending:false});_i++ ;}}}else{_e=_b.split(",");for(var _m=0;_m<_e.length;_m++ ){_g=_e[_m];if((_h=find_sortcolumn(_g))>-1){_f[_h].descending=true;}else{_f.splice(_i,0,{level:0,colid:_g,descending:true});_i++ ;}}}}_d="";var _k=false,_l=false;for(var _m=0,_n=_f.length;_m<_n;_m++ ){if(_f[_m].level>0){if(!_k){if(_d&&_d.length){_d+=",G:";}else{_d+="G:";}_k=true;}_d+=(_f[_m].descending?"-":"+")+_f[_m].colid;}else{if(!_l){_d+="S:";_l=true;}_d+=(_f[_m].descending?"-":"+")+_f[_m].colid;}}_a.set_keystring(_d);};m2nForm.DataObject=function(){};m2nForm.DataObject.prototype.getData=function(_a){return this[_a];};m2nForm.DataObject.prototype.setData=function(_a,_b){return this[_a]=_b;};m2nForm.m2n_CreateDataObject=function(){return new this.DataObject;};
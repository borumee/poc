var pForm=nexacro.Form.prototype;pForm.GridConfig={"popmenulist":["sort","colfix","rowfix","filter","find","colhide","scroll","select","cellcopypaste","initial"],"defaultmenulist":["sort","cellcopypaste"],"filter":{expandsize:20},"sort":{sortTogleCancel:true,ascText:"▲",descText:"▼",cellInfo:[]}};pForm.gfnGridOnload=function(_a){this.gfnSetGrid(_a);};pForm.gfnGridOnUnload=function(_a){if(_a.popupMenu){var _b=_a.popupMenu.getInnerDataset();if(_b){try{this.removeChilde(_b.name);_b.destroy();_b=null;}catch(e){}}_a.popupMenu.grid=null;try{this.removeChilde(_a.popupMenu.id);_a.popupMenu.destroy();}catch(e){}_a.popupMenu=null;}if(_a.arrprop){_a.arrprop=null;}if(_a.orgformat2){_a.orgformat2=null;}};pForm._getGridUserProperty=function(_a){var _b=_a.uFunction;var _c=this.GridConfig.defaultmenulist.slice();var _d=[];if(!this.gfnIsNull(_b)){_d=_b.split(",");for(var _f=0;_f<_d.length;_f++ ){if(_d[_f].indexOf("!")==0){for(var _g=0;_g<_c.length;_g++ ){if(_c[_g]==_d[_f].substr(1)){_c[_g]="";}}_d[_f]="";}}}var _e=[];for(var _f=0;_f<_c.length;_f++ ){if(!this.gfnIsNull(_c[_f])){_e.push(_c[_f]);}}for(var _f=0;_f<_d.length;_f++ ){if(!this.gfnIsNull(_d[_f])){_e.push(_d[_f]);}}return _e;};pForm.gfnGrid_onheadclick=function(_a,_b){if(this.gfnGridSelectAllCheckbox(_a,_b)){return;}if(_a.uFun_sort===true){if(_a._appendHeadRowIndex==_b.subrow){return;}var _c=false;if(_b.ctrlkey){_c=true;}var _d=this._gfnGridSetSortStatus(_a,_b.cell,_c);if(_d){this._gfnGridExecuteSort(_a);}}};pForm._gfnGridSetSortStatus=function(_a,_b,_c,_d,_e){if(this.gfnIsNull(_e)){_e=this._gfnGridGetBodyCellIndex(_a,_b);}if(_e<0){return false;}var _f=this.gfnGetBindColName(_a,_e);if(this.gfnIsNull(_f)){trace("bind가 되지 않은 cell은 sort가 되지 않습니다.");return false;}if(this.gfnIsNull(_c)){_c=false;}if(this.gfnIsNull(_d)){_d=-1;}if(this.gfnIsNull(_a.sortInfos)){_a.sortInfos={};}if(this.gfnIsNull(_a.sortItems)){_a.sortItems=[];}var _g=_a.sortInfos,_h=_a.sortItems,_i=_g[_f],_j,_k;if(this.gfnIsNull(_i)){var _l=_a.getCellText(-1,_b);var _m=this._gfnGridGetGridCellObject(_a,"head",_b);_i=_g[_f]={status:0,text:_l,refCell:_m};}if(_c){_k=_i.status;if(_d==-1){if(_k==0){_i.status=1;}else if(_k==1){_i.status=2;}else if(_k==2){_i.status=(this.GridConfig.sort.sortTogleCancel?0:1);}}else{_i.status=_d;}}else{for(var _o in _g){if(_g.hasOwnProperty(_o)){_i=_g[_o];if(_o==_f){_k=_i.status;if(_d==-1){if(_k==0){_i.status=1;}else if(_k==1){_i.status=2;}else if(_k==2){_i.status=(this.GridConfig.sort.sortTogleCancel?0:1);}}else{_i.status=_d;}}else{_i.status=0;}if(_i.status==0){for(var _p=0,_q=_h.length;_p<_q;_p++ ){if(_h[_p]!==_f){_h.splice(_p,1);break;}}}}}}var _n=false;for(var _r=0,_s=_h.length;_r<_s;_r++ ){if(_h[_r]==_f){_n=true;break;}}if(!_n){_h.push(_f);}return true;};pForm._gfnGridExecuteSort=function(_a){var _b,_c,_d=_a.sortInfos,_e=_a.sortItems,_f,_g,_h,_i="";if(this.gfnIsNull(_d)||this.gfnIsNull(_e)){return;}for(var _t=0;_t<_e.length;_t++ ){_f=_e[_t];_b=_d[_f];_g=_b.status;_h=_b.refCell;if(this.gfnIsNull(_h)||_a.getBindCellIndex("body",_f)<0){_e.splice(_t,1);_d[_f]=null;delete _d[_f];_t-- ;}else if(_g>0){_i+=(_g==1?"+":"-")+_f;}}var _j=_a.getBindDataset();var _k=_j.keystring;var _l="";if(_k.length>0&&_k.indexOf(",")<0){var _m=_k.indexOf("S:");var _n=_k.indexOf("G:");if(_m>-1){_l="";}else{if(_n<0){_l="G:"+_k;}else{_l=_k;}}}else{var _o=_k.split(",");var _p;for(var _t=0,_u=_o.length;_t<_u;_t++ ){_p=_o[_t];if(_p.length>0&&_p.indexOf("S:")<0){if(_p.indexOf("G:")<0){_l="G:"+_p;}else{_l=_p;}}}}_a.set_enableevent(false);_a.set_enableredraw(false);if(_i.length>0){var _q="S:"+_i;if(_l.length>0){_j.set_keystring(_l+","+_q);}else{_j.set_keystring(_q);}_a.sortKeyString=_q;}else{_j.set_keystring(_l);_a.sortKeyString="";}var _r,_s;for(var _v in _d){if(_d.hasOwnProperty(_v)){_b=_d[_v];_h=_b.refCell;if(_h){_r=_h._cellidx;_s=this.gfnDecode(_b.status,1,this.GridConfig.sort.ascText,2,this.GridConfig.sort.descText,"");_a.setCellProperty("head",_r,"text",_b.text+_s);}}}_j.set_rowposition(0);_a.set_enableevent(true);_a.set_enableredraw(true);};pForm.gfnGrid_onrbuttondown=function(_a,_b){var _c=nexacro.getApplication();if(!_a.popupMenu){return;}_a.popupMenu.cellindex=_b.cell;_a.popupMenu.rowindex=_b.row;var _d=_a.popupMenu.getInnerDataset();if(_b.row<0){_d.filter("enable=='true' && bandtype=='head'");}else{_d.filter("enable=='true' && bandtype!='head'");}if(_d.rowcount==0){return;}var _e=nexacro.toNumber(system.getCursorX())-nexacro.toNumber(system.clientToScreenX(_a,0));var _f=nexacro.toNumber(system.getCursorY())-nexacro.toNumber(system.clientToScreenY(_a,0));var _g=_c.gvRunMode;if(_g=="S"||this.gfnIsNull(_g)){_f+=83;}_a.popupMenu.trackPopupByComponent(_a,_e,_f,null,false);};pForm._gfnGrid_onexpanddown=function(_a,_b){if(_b.row>=0){return;}if(_a._appendHeadRowIndex<0){return;}nexacro._OnceCallbackTimer.callonce(this,function(){this._gfnHeadFindExecute(_a);},50);};pForm._gfnHeadFindExecute=function(_a){var _b=_a._headFilterInfo;var _c,_d;var _e="";for(var _g=0;_g<_b.length;_g++ ){if(!_b[_g]){continue;}_c=_a.getCellProperty("head",_g,"text");if(_b[_g].col&&(_c&&_c!="")){if(_e!=""){_e+="&&";}_e+="("+_b[_g].col+".indexOf('"+_c+"')>-1)";}}var _f=_a.getBindDataset();_f.filter(_e);};pForm._gfnMakeGridPopupMenu=function(_a,_b){var _c=nexacro.getApplication();var _d=_c.gdsGridPopupMenu;var _e=_a.parent;_a.orgformat2=_a.getFormatString();var _f="dsPopupMenu_"+_a.name+"_"+this.name;var _g=this[_f];if(!_g){_g=new Dataset(_f);this.addChild(_f,_g);}_g.set_updatecontrol(false);_g.set_enableevent(false);_g.filter("");_g.copyData(_c.gdsGridPopupMenu);var _h;for(var _n=0;_n<_b.length;_n++ ){if(_b[_n]=="colfix"&&_a.autofittype=="col"){continue;}for(var _o=0;_o<_g.rowcount;_o++ ){_h=_g.getColumn(_o,"grp");if(_h==_b[_n]){_g.setColumn(_o,"enable","true");}}}_g.filter("enable=='true'");var _i="popMenu_"+_a.name+"_"+this.name;var _j=this[_i];if(!_j){_j=new PopupMenu(_i,0,0,100,100);this.addChild(_i,_j);_j.set_innerdataset(_f);_j.set_captioncolumn("caption");_j.set_enablecolumn("enable");_j.set_idcolumn("id");_j.set_levelcolumn("level");_j.addEventHandler("onmenuclick",this.gfnPopupmenu_onmenuclick,this);_j.show();_j.set_itemheight(29);}_j.grid=_a;_a.popupMenu=_j;_g.set_enableevent(true);if(_g.findRow("bandtype","head")>=0){_a.addEventHandler("onheadclick",this.gfnGrid_onheadclick,this);}_a.addEventHandler("onrbuttondown",this.gfnGrid_onrbuttondown,this);var _k=_g.findRow("id","filterhead");if(_k>=0){var _l=_a.getFormatRowCount();var _m=0;for(var _n=0;_n<_l;_n++ ){if(_a.getFormatRowProperty(_n,"band")=="body"){_m++ ;_a._bodyrowsize=_a.getFormatRowProperty(_n,"size");}}_a._bodyrowcnt=_m;if(_m==1){_a.addEventHandler("onexpanddown",this._gfnGrid_onexpanddown,this);}else{_g.setColumn(_k,"enable","false");}}};pForm.gfnSetGrid=function(_a){var _b=nexacro.getApplication();if(_b.gvUseGridContextMenu!=true){return;}var _c=this._getGridUserProperty(_a);if(this.gfnIsNull(_c)){return;}_a.arrprop=_c;if(_c.indexOf("sort")>=0){_a.uFun_sort=true;}if(_c.indexOf("cellcopypaste")>=0){this.gfnSetGridCopyPaste(this,_a);}nexacro._OnceCallbackTimer.callonce(this,function(){this._gfnMakeGridPopupMenu(_a,_c);},10);};pForm.gfnClearSortMark=function(_a,_b){var _c=_a.getCellCount("head");var _d,_e;if(_b===null||_b===undefined){this._issortmark=false;}for(var _f=0;_f<_c;_f++ ){if(_a.getCellProperty("head",_f,"displaytype")=="checkboxcontrol"||_a.getCellProperty("head",_f,"edittype")=="checkbox"){continue;}if(this._filtershowrow&&this._filtershowrow==this.getCellProperty("head",_f,"row")){continue;}_d=_a.getCellProperty("head",_f,"text");if(_d){_e=_a.getCellProperty("head",_f,"text").replace(this.GridConfig.sort.ascText,"").replace(this.GridConfig.sort.descText,"");_a.setCellProperty("head",_f,"text",_e);}}};pForm.gfnGridSelectAllCheckbox=function(_a,_b){if(_a.readonly==true){return true;}var _c=_b.cell;var _d=_b.col;if(_a.getCellProperty("head",_c,"edittype")!="checkbox"){return false;}if(_a.getCellProperty("body",_d,"edittype")!="checkbox"){return false;}var _e=_a.getBindDataset();var _f=_a.getCellProperty("body",_d,"text");if(!_f||_f==""||(_f.indexOf("bind:")<0)){return false;}_f=_f.split("bind:").join("");var _g;var _h=_a.getCellProperty("head",_c,"text");if(!_h||_h==""||_h=="0"){_g="1";}else{_g="0";}_a.setCellProperty("head",_c,"text",_g);_e.set_enableevent(false);for(var _i=0;_i<_e.getRowCount();_i++ ){_e.setColumn(_i,_f,_g);}_e.set_enableevent(true);_e=null;return true;};pForm.gfnPopupmenu_onmenuclick=function(_a,_b){var _c=_b.id;var _d=_a.grid;var _e=_a.cellindex;var _f=_a.rowindex;switch(_c){case "sort":_d.uFun_sort=true;break;case "colfix":this._gfnGridcellFix(_d,_e,_f);break;case "colfixfree":this._gfnGridCellFree(_d);break;case "rowfix":if(_f>=0){_d.setFixedRow(_f);}break;case "rowfixfree":_d.setFixedRow(-1);break;case "filter":this._gfnGridFilter(_d);break;case "filterhead":this._gfnGridFilterHeader(_d);break;case "filterfree":this._gfnGridCellFilterFree(_d);break;case "find":this._gfnGridDataFind(_d,_e,_f);break;case "colhide":this._gfnGridColHideShow(_d,_f);break;case "scrolldefault":_d.set_fastvscrolltype("default");break;case "scrollmiddle":_d.set_fastvscrolltype("centerdisplay");break;case "scrollall":_d.set_fastvscrolltype("topcenterbottomdisplay");break;case "scrollpos":_d.set_fastvscrolltype("trackbarfollow");break;case "sortfree":_d.uFun_sort=false;this.gfnClearSortMark(_d,_e);break;case "selectrow":_d.set_selecttype("row");break;case "selectcell":_d.set_selecttype("cell");break;case "selectmultirow":_d.set_selecttype("multirow");break;case "selectarea":_d.set_selecttype("area");break;case "initial":_d.set_formats("<Formats>"+_d.orgformat2+"</Formats>");this.gfnSetGrid(_d);break;default:break;}};pForm.gfnGetBindColName=function(_a,_b){var _c="";var _d="";var _e=_a.getCellProperty("body",_b,"subcell");if(_e>0){_c=_a.getSubCellProperty("body",_b,0,"text");}else{_c=_a.getCellProperty("body",_b,"text");}if(!this.gfnIsNull(_c)){if(_c.search(/^BIND\(/)>-1){_d=_c.replace(/^BIND\(/,"");_d=_d.substr(0,_d.length-1);}else if(_c.search(/^bind:/)>-1){_d=_c.replace(/^bind:/,"");}}return _d;};pForm._gfnGridUserHeaderFlg=function(_a){var _b=_a.arrprop;var _c=false;for(var _d=0;_d<_b.length;_d++ ){if(_b[_d]=="userheader"){_c=true;}}return _c;};pForm._gfnGridcellFix=function(_a,_b,_c){var _d;if(_c==-1){_d="Head";}else if(_c==-2){_d="Summary";}else{_d="Body";}var _e=nexacro.toNumber(_a.getCellProperty(_d,_b,"col"));var _f=nexacro.toNumber(_a.getCellProperty(_d,_b,"colspan"));var _g=nexacro.toNumber(_a.getCellProperty(_d,_b,"rowspan"));var _h=0;var _i;var _j;var _k;var _l;_a.set_enableredraw(false);_a.setFormatColProperty(0,"band","body");for(_i=0;_i<_a.getCellCount("Head");_i++ ){_j=nexacro.toNumber(_a.getCellProperty("Head",_i,"col"));_k=nexacro.toNumber(_a.getCellProperty("Head",_i,"colspan"));_l=_j+_k -1;if(_j==_e||_l==_e){if(_k>1){_e=_l;}else{_e=_l;}}else{_a.setCellProperty("Head",_i,"line","");}}for(_i=0;_i<_a.getCellCount("Body");_i++ ){if(_a.getCellProperty("Body",_i,"col")==_e){_a.setCellProperty("Body",_i,"border","1px solid #dbdee2 , 2px solid aqua , 1px solid #dbdee2 , 1px solid #dbdee2");}else{_a.setCellProperty("Body",_i,"border","");}}_a.setFormatColProperty(_e,"band","left");_a.set_enableredraw(true);};pForm._gfnGridCellFree=function(_a){for(i=0;i<_a.getFormatColCount();i++ ){_a.setFormatColProperty(i,"band","body");}for(i=0;i<_a.getCellCount("Body");i++ ){_a.setCellProperty("Body",i,"border","");}};pForm._gfnGridFilter=function(_a){var _b="그리드 필터 설정 팝업";var _c={pvGrid:_a};var _d={title:_b,titlebar:true};var _e="gfnGridFilterCallback";this.gfnOpenPopup("cmmGridFilter","common::cmmGridFilter.xfdl",_c,_e,_d);};pForm._gfnGridFilterHeader=function(_a){_a.set_enableredraw(false);var _b=_a.appendContentsRow("head");_a.setFormatRowProperty(_b,"size",(_a._bodyrowsize?_a._bodyrowsize:30));_a._appendHeadRowIndex=_b;_a._headFilterInfo=[];var _c=_a.getCellCount("head");var _d,_e,_f,_g;for(var _h=0;_h<_c;_h++ ){if(_a.getCellProperty("head",_h,"row")==_b){_d=_a.getCellProperty("head",_h,"col");_e=_a.getCellProperty("body",_d,"displaytype");switch(_e){case "progressbarcontrol":case "buttoncontrol":case "imagecontrol":case "treeitemcontrol":break;default:_a.setCellProperty("head",_h,"displaytype","editcontrol");_a.setCellProperty("head",_h,"edittype","text");_a.setCellProperty("head",_h,"expandshow","show");_a.setCellProperty("head",_h,"expandsize",this.GridConfig.filter.expandsize);if(!_a._headFilterInfo[_h]){_a._headFilterInfo[_h]={};}_f=_a._headFilterInfo[_h];_g=_a.getCellProperty("body",_d,"text");if(_g&&_g.indexOf("bind:")>=0){_g=_g.split("bind:").join("");_f.col=_g;}break;}}}_a.set_enableredraw(true);};pForm._gfnGridCellFilterFree=function(_a){if(_a._appendHeadRowIndex>=0){_a.deleteContentsRow("head",_a._appendHeadRowIndex);_a._appendHeadRowIndex=null;}var _b=_a.getBindDataset();_b.set_filterstr("");};pForm._gfnGridColHideShow=function(_a){var _b="그리드 컬럼 숨기기/보이기";var _c={pvGrid:_a};var _d={title:_b,titlebar:true};var _e="gfnColumnHidCallback";this.gfnOpenPopup("cmmColumnHide","common::cmmColumnHide.xfdl",_c,_e,_d);};pForm._gfnGridDataFind=function(_a,_b,_c){var _d="그리드 데이터 찾기";var _e=_a.selecttype;var _f={pvGrid:_a,pvStrartRow:_c,pvSelectCell:_b,pvSelectType:_e};var _g={title:_d,titlebar:true};var _h="gfnDataFindCallback";this.gfnOpenPopup("cmmFindData","common::cmmFindData.xfdl",_f,_h,_g);};pForm.gfnGridFilterCallback=function(_a,_b){};pForm.gfnColumnHidCallback=function(_a,_b){};pForm.gfnDataFindCallback=function(_a,_b){};pForm._gfnGridGetBodyCellIndex=function(_a,_b,_c){if(this.gfnIsNull(_c)){_c=false;}var _d=0;for(var _p=0,_q=_a.getCellCount("head");_p<_q;_p++ ){var _e=_a.getCellProperty("head",_p,"row");if(_d<_e){_d=_e;}}var _f=0;for(var _p=0,_q=_a.getCellCount("body");_p<_q;_p++ ){var _e=_a.getCellProperty("body",_p,"row");if(_f<_e){_f=_e;}}if(_d==0&&_f==0){_c=true;}var _g=-1;var _h=-1;var _i=parseInt(_a.getCellProperty("head",_b,"row"));var _j=parseInt(_a.getCellProperty("head",_b,"col"));var _k=parseInt(_a.getCellProperty("head",_b,"colspan"));if(_d>_f){_h=_i-(_d-_f);_h=(_h<0?0:_h);}else{_h=_i;}var _l,_m,_n,_o;for(var _p=0,_q=_a.getCellCount("body");_p<_q;_p++ ){_l=parseInt(_a.getCellProperty("body",_p,"row"));_m=parseInt(_a.getCellProperty("body",_p,"col"));_n=parseInt(_a.getCellProperty("body",_p,"colspan"));_o=parseInt(_a.getCellProperty("body",_p,"rowspan"));if(_o>1){if(_c){if(_h>=_l&&_j<=_m&&_m<(_j+_k)){_g=_p;break;}}else{if(_h>=_l&&_j==_m&&_k==_n){_g=_p;break;}}}else{if(_c){if(_h==_l&&_j<=_m&&_m<(_j+_k)){_g=_p;break;}}else{if(_h==_l&&_j==_m&&_k==_n){_g=_p;break;}}}}return _g;};pForm._gfnGridGetGridCellObject=function(_a,_b,_c){var _d;var _e=_a._curFormat;if(_e){if(_b=="head"){_d=_e._headcells[_c];}else if(_b=="body"){_d=_e._bodycells[_c];}else if(_b=="summ"||_b=="summary"){_d=_e._summcells[_c];}}return _d;};pForm.gfnSetGridCopyPaste=function(_a,_b){var _c={objGrid:_b};_a.config=_c;if(system.navigatorname=="nexacro"||system.navigatorname=="IE"&&system.navigatorversion<12){_a.config.colSeperator="\t";_a.config.objGrid.addEventHandler("onkeydown",this._gfnGrdCopyPasteStateChk,_a);_a.config.objGrid.addEventHandler("onkeyup",this._gfnGrdCopyPaste,_a);}else{_a.config.colSeperator="\t";_a.config.targetGrid=undefined;_a.config.targetEvent=undefined;_a.addEventHandler("ontimer",this._gfnBlinkTimerHandler,_a);_a.config.objGrid.addEventHandler("onkeydown",this._gfnGrdCopyPasteEtc,_a);}};pForm.gfnSetPasteData=function(_a,_b){var _c=_a.config.targetGrid;var _d=_a.config.targetEvent;_c.set_enableevent(false);_c.set_enableredraw(false);var _e=_c.getBindDataset();_e.set_enableevent(false);var _f=_c.getCellCount("body");var _g=_e.getRowCount();var _h=this.gfnGetGridSelRowCol(_c);var _i=_h.selectstartrow;var _j=_h.selectendrow;var _k=_h.selectstartcol;var _l=_h.selectendcol;var _m=_i;var _n=_k;copyData=_b;var _o=_a.config.colSeperator;var _p=copyData.split(/[\n\f\r]/);var _q=_p.length-1;var _r={};for(var _x=0;_x<_q;_x++ ){if(_g<=_m){_e.addRow();}var _s=_p[_x].split(_o);var _t=_n+_s.length;if(_t>_f){_t=_f;}var _u=0;for(var _y=_n;_y<_t;_y++ ){var _v=_c.getCellProperty("body",_y,"text").substr(5);var _w=_s[_u];if(!this.gfnIsNull(_w)){_e.setColumn(_m,_v,_w);}_u++ ;}_m++ ;}_e.rowposition=_m;_j=_j+_q-1;_l=_t-1;_c.set_enableredraw(true);_c.set_enableevent(true);_e.set_enableevent(true);_c.selectArea(_i,_k,_j,_l);_a.config.targetEvent=undefined;};pForm.gfnCreateElementTextarea=function(_a){var _b=document.createElement('textarea');_b.style.position='absolute';_b.style.left='-1000px';_b.style.top=document.body.scrollTop+'px';_b.value=_a;document.body.appendChild(_b);_b.select();return _b;};pForm.gfnInitBlinkData=function(_a){var _b=_a.config.targetGrid;_b.targetGrid=null;};pForm.gfnFindGridText=function(_a,_b,_c){_a.lastFindText=_b;_a.lastFindOption=_c;var _d=_c.direction;var _e=_c.position;var _f=_c.scope;var _g=_c.condition;var _h=_c.strict;var _i=_a.getBindDataset();if(this.gfnIsNull(_a.lastFindRow)){_a.lastFindRow=0;}if(this.gfnIsNull(_a.lastFindCell)){_a.lastFindCell=_c.cell;}var _j=(_e=="current"?_a.currentcell:_a.lastFindCell);var _k=(_e=="current"?_a.currentrow:_a.lastFindRow);if(_f=="col"&&!this.gfnIsNull(_c.cell)){_j=_c.cell;}var _l=findCell=-1;var _m=_i.rowcount;var _n=_a.getCellCount("body");if(!_h){_b=_b.toUpperCase();}if(_d=="prev"){_k-=1;if(_k<0){_k=_m -1;}}else{_k+=1;if(_k>=_m){_k=0;}}var _o=_m;while(_o>0){if(this._compareFindText(_a,_k,_j,_b,_g,_h)){_l=_k;findCell=_j;break;}if(_d=="prev"){_k-=1;if(_k<0){_k=_m -1;}}else{_k+=1;if(_k>(_m -1)){_k=0;}}_o-- ;}if(_l>-1&&findCell>-1){_a.lastFindRow=_l;_a.lastFindCell=findCell;}return [_l,findCell];};pForm._compareFindText=function(_a,_b,_c,_d,_e,_f){var _g=_a.getCellText(_b,_c);if(this.gfnIsNull(_g)){return;}var _h=_a.getCellProperty("body",_c,"displaytype");if(this.gfnIsNull(_h)||_h=="normal"){var _i=this.gfnGetBindColumnType(_a,_c);switch(_i){case 'INT':case 'FLOAT':case 'BIGDECIMAL':_h="number";break;case 'DATE':case 'DATETIME':case 'TIME':_h="date";break;default:_h="string";}}if(_h=="currency"){var _j=_g.charCodeAt(0);if(_j==65510||_j==92){_g=_g.substr(1);}_j=_d.charCodeAt(0);if(_j==65510||_j==92){_d=_d.substr(1);}}if(!_f){_g=_g.toUpperCase();}if(_e=="equal"){if(_d==_g){return true;}}else{if(_g.indexOf(_d)>-1){return true;}}return false;};pForm.gfnGetBindColumnType=function(_a,_b){var _c=null;var _d=_a.getBindDataset();var _e=_a.getCellProperty("body",_b,"text");_e=_e.replace("bind:","");if(!this.gfnIsNull(_e)){var _f=_d.getColumnInfo(_e);if(!this.gfnIsNull(_f)){_c=_f.type;}}return _c;};pForm._gfnGrdCopyPasteStateChk=function(_a,_b){var _c=_b.keycode;var _d=system.osversion.indexOf("Mac")>-1?_b.metakey:_b.ctrlkey;if(_d&&!_b.shiftkey&&!_b.altkey){if(_c==67){_a.bGridCopy=true;}else if(_c==86){_a.bGridPaste=true;}}};pForm._gfnGrdCopyPaste=function(_a,_b){var _c=_a.parent;var _d=_b.keycode;if(_a.bGridCopy==true){_a.bGridCopy=false;var _e=this.gfnGetGridSelRowCol(_a);var _f=_e.selectstartrow;var _g=_e.selectendrow;var _h=_e.selectstartcol;var _i=_e.selectendcol;var _j="";var _k=_c.config.colSeperator;_c.config.targetGrid=null;for(var _z=_f;_z<=_g;_z++ ){for(var _aa=_h;_aa<=_i;_aa++ ){var _l=_a.getCellValue(_z,_aa);if(!this.gfnIsNull(_l)){if(_aa<_i){_j+=_a.getCellValue(_z,_aa)+_k;}else{_j+=_a.getCellValue(_z,_aa);}}}if(_z<_a.selectendrow){_j+="\r\n";}}_j+="\r\n";system.clearClipboard();system.setClipboard("CF_TEXT",_j);_c.config.targetGrid=_a;}else if(_a.bGridPaste==true){_a.bGridPaste=false;var _j=system.getClipboard("CF_TEXT");_j=new String(_j);var _k=_c.config.colSeperator;var _m=_j.split("\r\n");var _n=_m.length-1;if(_n<1){_b.stopPropagation();return;}_a.set_enableevent(false);_a.set_enableredraw(false);var _o=_a.getBindDataset();_o.set_enableevent(false);var _p=_a.getCellCount("body");var _q=_o.getRowCount();var _e=this.gfnGetGridSelRowCol(_a);var _f=_e.selectstartrow;var _g=_e.selectendrow;var _h=_e.selectstartcol;var _i=0;var _r=_f;var _s=_h;var _t=0;for(var _z=0;_z<_n;_z++ ){if(_q<=_r){_o.addRow();}var _u=_m[_z].split(_k);var _v=_s+_u.length;if(_v>_p){_v=_p;}if(_t<_v){_t=_v;}var _w=0;for(var _aa=_s;_aa<_v;_aa++ ){var _x=_a.getCellProperty("body",_aa,"text").substr(5);var _y=_u[_w];if(!this.gfnIsNull(_y)){_o.setColumn(_r,_x,_y);}_w++ ;}_r++ ;}_o.rowposition=_r;_g=_g+_n-1;_i=_t-1;_a.set_enableredraw(true);_a.set_enableevent(true);_o.set_enableevent(true);_a.selectArea(_f,_h,_g,_i);_c.config.targetGrid=_a;_b.stopPropagation();}};pForm._gfnGrdCopyPasteEtc=function(_a,_b){var _c=_a.parent;var _d=_b.keycode;var _e=system.osversion.indexOf("Mac")>-1?_b.metakey:_b.ctrlkey;if(_e&&!_b.shiftkey&&!_b.altkey){if(_d==67){var _f=this.gfnGetGridSelRowCol(_a);var _g=_f.selectstartrow;var _h=_f.selectendrow;var _i=_f.selectstartcol;var _j=_f.selectendcol;_c.config.targetGrid=undefined;var _k="";var _l=_c.config.colSeperator;for(var _q=_g;_q<=_h;_q++ ){var _m=[];var _n=[];for(var _r=_i;_r<=_j;_r++ ){var _o=_a.getCellValue(_q,_r);_m.push(_o);if(_r<_j){_k+=_o+_l;}else{_k+=_o;}}_k+="\r\n";}_c.config.targetGrid=_a;var _p=this.gfnCreateElementTextarea(_k);_c.config.targetGrid["ta"]=_p;_c.setTimer(777,100);if(!this.gfnIsNull(_k)){_c.setTimer(1000,110);}_b.stopPropagation();}else if(_d==86){_c.config.targetGrid=_a;_c.config.targetEvent=_b;var _p=this.gfnCreateElementTextarea('');_c.config.targetGrid["ta"]=_p;_c.setTimer(888,100);_b.stopPropagation();}}};pForm._gfnBlinkTimerHandler=function(_a,_b){var _c=_b.timerid;_a.killTimer(_c);if(_c>=1000){var _d=_c%1000;if(_d>8){this.gfnInitBlinkData(_a);}}else{if(_c==777){var _e=_a.config.targetGrid["ta"];if(!_e){return;}document.body.removeChild(_e);_a.config.targetGrid["ta"]=undefined;}else if(_c==888){var _e=_a.config.targetGrid["ta"];if(!_e){return;}var _f=_e.value;document.body.removeChild(_e);this.gfnSetPasteData(_a,_f);_a.config.targetGrid["ta"]=undefined;}}};pForm.gfnGetGridSelRowCol=function(_a){var _b=_a.selecttype;var _c={};if(_b=="row"){_c.selectstartrow=nexacro.toNumber(_a.currentrow);_c.selectendrow=nexacro.toNumber(_a.currentrow);_c.selectstartcol=0;_c.selectendcol=nexacro.toNumber(_a.getCellCount("body")-1);}else if(_b=="multirow"){_c.selectstartrow=nexacro.toNumber(_a.selectstartrow);_c.selectendrow=nexacro.toNumber(_a.selectendrow);_c.selectstartcol=0;_c.selectendcol=nexacro.toNumber(_a.getCellCount("body")-1);}else if(_b=="cell"){_c.selectstartrow=nexacro.toNumber(_a.currentrow);_c.selectendrow=nexacro.toNumber(_a.currentrow);_c.selectstartcol=nexacro.toNumber(_a.currentcol);_c.selectendcol=nexacro.toNumber(_a.currentcol);}else if(_b=="area"){_c.selectstartrow=nexacro.toNumber(_a.selectstartrow);_c.selectendrow=nexacro.toNumber(_a.selectendrow);_c.selectstartcol=nexacro.toNumber(_a.selectstartcol);_c.selectendcol=nexacro.toNumber(_a.selectendcol);}else if(_b=="multiarea"){trace("grid.selecttype=multiarea 기능에서는 copy & paste를 사용할 수 없습니다");_c.selectstartrow=-1;_c.selectendrow=-1;_c.selectstartcol=-1;_c.selectendcol=-1;}return _c;};pForm=null;
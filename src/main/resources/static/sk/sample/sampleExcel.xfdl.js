(function(){return function(){if(!this._is_form){return;}var _a=null;this.on_create=function(){this.set_name("sampleExcel");this.set_titletext("엑셀  EXPORT/IMPORT");if(Form==this.constructor){this._setFormPosition(1050,736);}_a=new Dataset("dsSearch",this);_a._setContents("<ColumnInfo><Column id=\"srchCond1\" type=\"STRING\" size=\"256\"/><Column id=\"srchCond2\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row/></Rows>");this.addChild(_a.name,_a);_a=new Dataset("dsList",this);_a._setContents("<ColumnInfo><Column id=\"ID\" type=\"STRING\" size=\"256\"/><Column id=\"NAME\" type=\"STRING\" size=\"256\"/><Column id=\"DEPARTMENT\" type=\"STRING\" size=\"256\"/><Column id=\"DESCRIPTION\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Div("divSearch","0","0",null,"54","20",null,null,null,null,null,this);_a.set_taborder("0");_a.set_cssclass("div_WF_Search");_a.set_text("");this.addChild(_a.name,_a);_a=new Combo("Combo01","56","-158","185","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("0");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");_a.set_readonly("false");var _b=new nexacro.NormalDataset("divSearch_form_Combo01_innerdataset",_a);_b._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\">1</Col><Col id=\"datacolumn\">전체</Col></Row><Row><Col id=\"codecolumn\">2</Col><Col id=\"datacolumn\">사용</Col></Row><Row><Col id=\"codecolumn\">3</Col><Col id=\"datacolumn\">미사용</Col></Row></Rows>");_a.set_innerdataset(_b);_a.set_text("전체");_a.set_value("1");_a.set_index("0");this.divSearch.addChild(_a.name,_a);_a=new Combo("Combo02","282","-158","185","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("1");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");_a.set_readonly("false");var _c=new nexacro.NormalDataset("divSearch_form_Combo02_innerdataset",_a);_c._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\">1</Col><Col id=\"datacolumn\">전체</Col></Row><Row><Col id=\"codecolumn\">2</Col><Col id=\"datacolumn\">사용</Col></Row><Row><Col id=\"codecolumn\">3</Col><Col id=\"datacolumn\">미사용</Col></Row></Rows>");_a.set_innerdataset(_c);_a.set_text("전체");_a.set_value("1");_a.set_index("0");this.divSearch.addChild(_a.name,_a);_a=new Combo("Combo03","521","-158","184","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("2");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");_a.set_readonly("false");var _d=new nexacro.NormalDataset("divSearch_form_Combo03_innerdataset",_a);_d._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\">1</Col><Col id=\"datacolumn\">전체</Col></Row><Row><Col id=\"codecolumn\">2</Col><Col id=\"datacolumn\">사용</Col></Row><Row><Col id=\"codecolumn\">3</Col><Col id=\"datacolumn\">미사용</Col></Row></Rows>");_a.set_innerdataset(_d);_a.set_text("전체");_a.set_value("1");_a.set_index("0");this.divSearch.addChild(_a.name,_a);_a=new Calendar("Calendar00","785","-158","184","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("3");_a.set_value("20190308");_a.set_dateformat("yyyy-MM-dd ddd");_a.set_readonly("false");this.divSearch.addChild(_a.name,_a);_a=new Button("btnSearch",null,"12","48","28","25",null,null,null,null,null,this.divSearch.form);_a.set_taborder("4");_a.set_text("조회");_a.set_cssclass("btn_WF_Search");_a.set_visible("true");this.divSearch.addChild(_a.name,_a);_a=new Static("staSearchTitle00","0","12","74","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("5");_a.set_text("아이디");_a.set_cssclass("sta_WF_SchLabel");_a.set_fittocontents("width");this.divSearch.addChild(_a.name,_a);_a=new Edit("edtId","staSearchTitle00:0","12","140","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("6");this.divSearch.addChild(_a.name,_a);_a=new Static("staSearchTitle01","edtId:0","12","62","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("7");_a.set_text("성명");_a.set_cssclass("sta_WF_SchLabel");this.divSearch.addChild(_a.name,_a);_a=new Edit("edtName","staSearchTitle01:0","12","140","28",null,null,null,null,null,null,this.divSearch.form);_a.set_taborder("8");this.divSearch.addChild(_a.name,_a);_a=new Static("Static04_00",null,"0","20",null,"0","20",null,null,null,null,this);_a.set_taborder("1");_a.set_cssclass("sta_WF_GSize");_a.set_visible("false");_a.set_text("W20");this.addChild(_a.name,_a);_a=new Grid("grdList","0","97",null,null,"20","0",null,null,null,null,this);_a.set_taborder("2");_a.set_binddataset("dsList");_a.set_autofittype("col");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/><Column size=\"80\"/></Columns><Rows><Row size=\"37\" band=\"head\"/><Row size=\"37\"/></Rows><Band id=\"head\"><Cell text=\"아이디\"/><Cell col=\"1\" text=\"성명\"/><Cell col=\"2\" text=\"부서\"/><Cell col=\"3\" text=\"비고\"/></Band><Band id=\"body\"><Cell text=\"bind:ID\" displaytype=\"expr:dataset.getRowType(currow)==&apos;2&apos;?&apos;editcontrol&apos;:&apos;normal&apos;\" edittype=\"expr:dataset.getRowType(currow)==&apos;2&apos;?&apos;text&apos;:&apos;none&apos;\"/><Cell col=\"1\" text=\"bind:NAME\" edittype=\"text\" displaytype=\"editcontrol\"/><Cell col=\"2\" text=\"bind:DEPARTMENT\" edittype=\"text\" displaytype=\"editcontrol\"/><Cell col=\"3\" text=\"bind:DESCRIPTION\" edittype=\"text\" displaytype=\"editcontrol\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Static("staTitle","0","54","342","43",null,null,null,null,null,null,this);_a.set_taborder("3");_a.set_text("사용자 정보 조회");_a.set_cssclass("sta_WF_Title");this.addChild(_a.name,_a);_a=new Static("Static04","140","54","30","43",null,null,null,null,null,null,this);_a.set_taborder("4");_a.set_cssclass("sta_WF_GSize");_a.set_visible("false");_a.set_text("H43");this.addChild(_a.name,_a);_a=new Div("divCmmnBtn",null,"61","572","28","20",null,null,null,null,null,this);_a.set_taborder("5");_a.set_text("");this.addChild(_a.name,_a);_a=new Button("btnExcelDown",null,"0","119","28","0",null,null,null,null,null,this.divCmmnBtn.form);_a.set_taborder("0");_a.set_text("엑셀다운로드");_a.set_fittocontents("width");_a.set_cssclass("btn_WF_ExcelSave");this.divCmmnBtn.addChild(_a.name,_a);_a=new Button("btnExcelUp",null,"0","107","28","btnExcelDown:5",null,null,null,null,null,this.divCmmnBtn.form);_a.set_taborder("1");_a.set_text("엑셀업로드");_a.set_fittocontents("width");_a.set_cssclass("btn_WF_ExcelUp");this.divCmmnBtn.addChild(_a.name,_a);_a=new Layout("default","",0,0,this.divSearch.form,function(_e){});this.divSearch.form.addLayout(_a.name,_a);_a=new Layout("default","",0,0,this.divCmmnBtn.form,function(_e){});this.divCmmnBtn.form.addLayout(_a.name,_a);_a=new Layout("default","",1050,736,this,function(_e){});_a.set_mobileorientation("landscape");this.addLayout(_a.name,_a);_a=new BindItem("item0","divSearch.form.edtId","value","dsSearch","srchCond1");this.addChild(_a.name,_a);_a.bind();_a=new BindItem("item1","divSearch.form.edtName","value","dsSearch","srchCond2");this.addChild(_a.name,_a);_a.bind();};this.loadPreloadList=function(){};this.registerScript("sampleExcel.xfdl",function(){this.form_onload=function(_a,_b){this.gfnFormOnload(_a,_b);this.gfnSetCommBtn(this.divCmmnBtn);};this.cfnAdd=function(){this.dsList.addRow();};this.cfnDel=function(){var _b=this.dsList.rowposition;var _c=this.dsList.getRowType(_b);if(_c==2){this.dsList.deleteRow(_b);}else{this.gfnAlert("confirm.before.delete");}};this.cfnSave=function(){if(!this.gfnDsIsUpdated(this.dsList)){this.gfnAlert("msg.save.nochange");return;}var _b=this.fnValidation(this.dsList);if(_b){this.gfnAlert("confirm.before.save");}};this.cfnSearch=function(){this.fnSearch();};this.cfnRefresh=function(){this.fnSearchCondInit();this.fnInit();};this.cfnExcelDown=function(){var _b="아이디 : ";if(this.gfnIsNull(this.divSearch.form.edtId.value)){_b+="전체 ";}else{_b+=this.divSearch.form.edtId.value+" ";}_b+=" 이름 : ";if(this.gfnIsNull(this.divSearch.form.edtName.value)){_b+="전체 ";}else{_b+=this.divSearch.form.edtName.value+" ";}this.gfnExcelExport(this.grdList,"sampleExcel","sampleExcelExportImport","EXCEL2007","",_b,true,"");};this.cfnExcelUp=function(){this.gfnExcelImport("dsList","sampleExcel","A4","fnExcelImportCallback","sampleExcel","EXCEL2007","A3:D3",this.grdList);};this.fnSearch=function(){var _b="searchSampleList";var _c="searchSampleList.do";var _d="inDs=dsSearch";var _e="dsList=outDs";var _f="";this.gfnTransaction(_b,_c,_d,_e,_f);};this.fnSave=function(){var _b="saveSampleList";var _c="saveSampleList.do";var _d="inDs=dsList:U";var _e="";var _f="";this.gfnTransaction(_b,_c,_d,_e,_f);};this.fnCallback=function(_b,_c,_d){switch(_b){case "searchSampleList":break;case "saveSampleList":this.fnSearch();break;default:break;}};this.fnMsgCallback=function(_b,_c){if(_b=="confirm.before.save"){if(_c){this.fnSave();}else{return;}}else if(_b=="confirm.before.delete"){if(_c){this.dsList.deleteRow(this.dsList.rowposition);}else{return;}}};this.fnExcelImportCallback=function(_b,_c){if(_b=="sampleExcel"){this.dsList.addColumn("_STATUS_","STRING");for(var _d=0;_d<this.dsList.getRowCount();_d++ ){this.dsList.setColumn(_d,"_STATUS_","EXCEL");}this.cfnSave();}};this.fnInit=function(){this.dsList.clearData();};this.fnSearchCondInit=function(){this.dsSearch.clearData();this.dsSearch.addRow();};this.fnValidation=function(){return true;};this.divSearch_btnSearch_onclick=function(_a,_b){this.cfnSearch();};this.divCmmnBtn_btnExcelUp_onclick=function(_a,_b){this.gfnExcelImport("dsList","sampleExcel","A4","fnExcelImportCallback","sampleExcel","EXCEL2007","A3:D3",this.grdList);};this.divCmmnBtn_btnExcelDown_onclick=function(_a,_b){var _c=this.staTitle.text+" 리스트";this.gfnExcelExport(this.grdList,"sampleExcel","sampleExcelExportImport","EXCEL2007","",_c,true,"");};});this.on_initEvent=function(){this.addEventHandler("onload",this.form_onload,this);this.divSearch.form.btnSearch.addEventHandler("onclick",this.divSearch_btnSearch_onclick,this);this.divCmmnBtn.form.btnExcelDown.addEventHandler("onclick",this.divCmmnBtn_btnExcelDown_onclick,this);this.divCmmnBtn.form.btnExcelUp.addEventHandler("onclick",this.divCmmnBtn_btnExcelUp_onclick,this);};this.loadIncludeScript("sampleExcel.xfdl");this.loadPreloadList();_a=null;};})();